/* CindyJS - (C) 2014-2015  J. Richter-Gebert
 *
 */
'use strict';var numeric="undefined"===typeof exports?function(){}:exports;"undefined"!==typeof global&&(global.numeric=numeric);numeric.version="1.2.6";numeric.bench=function(a,b){var d,c,g;"undefined"===typeof b&&(b=15);g=.5;for(d=new Date;;){for(c=g*=2;3<c;c-=4)a(),a(),a(),a();for(;0<c;)a(),c--;c=new Date;if(c-d>b)break}for(c=g;3<c;c-=4)a(),a(),a(),a();for(;0<c;)a(),c--;c=new Date;return 1E3*(3*g-1)/(c-d)};
numeric._myIndexOf=function(a){var b=this.length,d;for(d=0;d<b;++d)if(this[d]===a)return d;return-1};numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf;numeric.Function=Function;numeric.precision=4;numeric.largeArray=50;
numeric.prettyPrint=function(a){function b(a){if(0===a)return"0";if(isNaN(a))return"NaN";if(0>a)return"-"+b(-a);if(isFinite(a)){var d=Math.floor(Math.log(a)/Math.log(10));a/=Math.pow(10,d);a=a.toPrecision(numeric.precision);10===parseFloat(a)&&(d++,a=(1).toPrecision(numeric.precision));return parseFloat(a).toString()+"e"+d.toString()}return"Infinity"}function d(a){var e;if("undefined"===typeof a)return c.push(Array(numeric.precision+8).join(" ")),!1;if("string"===typeof a)return c.push('"'+a+'"'),
!1;if("boolean"===typeof a)return c.push(a.toString()),!1;if("number"===typeof a){var k=b(a);e=a.toPrecision(numeric.precision);a=parseFloat(a.toString()).toString();a=[k,e,a,parseFloat(e).toString(),parseFloat(a).toString()];for(e=1;e<a.length;e++)a[e].length<k.length&&(k=a[e]);c.push(Array(numeric.precision+8-k.length).join(" ")+k);return!1}if(null===a)return c.push("null"),!1;if("function"===typeof a){c.push(a.toString());k=!1;for(e in a)a.hasOwnProperty(e)&&(k?c.push(",\n"):c.push("\n{"),k=!0,
c.push(e),c.push(": \n"),d(a[e]));k&&c.push("}\n");return!0}if(a instanceof Array){if(a.length>numeric.largeArray)return c.push("...Large Array..."),!0;k=!1;c.push("[");for(e=0;e<a.length;e++)0<e&&(c.push(","),k&&c.push("\n ")),k=d(a[e]);c.push("]");return!0}c.push("{");k=!1;for(e in a)a.hasOwnProperty(e)&&(k&&c.push(",\n"),k=!0,c.push(e),c.push(": \n"),d(a[e]));c.push("}");return!0}var c=[];d(a);return c.join("")};
numeric.parseDate=function(a){function b(a){if("string"===typeof a)return Date.parse(a.replace(/-/g,"/"));if(!(a instanceof Array))throw Error("parseDate: parameter must be arrays of strings");var c=[],g;for(g=0;g<a.length;g++)c[g]=b(a[g]);return c}return b(a)};numeric.parseFloat=function(a){function b(a){if("string"===typeof a)return parseFloat(a);if(!(a instanceof Array))throw Error("parseFloat: parameter must be arrays of strings");var c=[],g;for(g=0;g<a.length;g++)c[g]=b(a[g]);return c}return b(a)};
numeric.parseCSV=function(a){a=a.split("\n");var b,d,c=[],g=/(([^'",]*)|('[^']*')|("[^"]*")),/g,e=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,k=0;for(d=0;d<a.length;d++){var q=(a[d]+",").match(g),m;if(0<q.length){c[k]=[];for(b=0;b<q.length;b++)m=q[b],m=m.substr(0,m.length-1),e.test(m)?c[k][b]=parseFloat(m):c[k][b]=m;k++}}return c};
numeric.toCSV=function(a){var b,d,c,g,e;c=numeric.dim(a)[0];e=[];for(b=0;b<c;b++){g=[];for(d=0;d<c;d++)g[d]=a[b][d].toString();e[b]=g.join(", ")}return e.join("\n")+"\n"};numeric.getURL=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.send();return b};
numeric.imageURL=function(a){function b(a,b,d){"undefined"===typeof b&&(b=0);"undefined"===typeof d&&(d=a.length);for(var c=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,
1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,
4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,
62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,
3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,
2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],e=-1,k=0;b<d;b++)k=(e^a[b])&255,e=e>>>8^c[k];return e^-1}var d=a[0].length,c=a[0][0].length,g,e,k,q,m,u,v=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,c>>
24&255,c>>16&255,c>>8&255,c&255,d>>24&255,d>>16&255,d>>8&255,d&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];g=b(v,12,29);v[29]=g>>24&255;v[30]=g>>16&255;v[31]=g>>8&255;v[32]=g&255;g=1;for(m=e=0;m<d;m++){m<d-1?v.push(0):v.push(1);q=3*c+1+(0===m)&255;k=3*c+1+(0===m)>>8&255;v.push(q);v.push(k);v.push(~q&255);v.push(~k&255);0===m&&v.push(0);for(u=0;u<c;u++)for(k=0;3>k;k++)q=a[k][m][u],q=255<q?255:0>q?0:Math.round(q),g=(g+q)%65521,e=(e+g)%65521,v.push(q);v.push(0)}a=(e<<16)+g;v.push(a>>24&255);
v.push(a>>16&255);v.push(a>>8&255);v.push(a&255);a=v.length-41;v[33]=a>>24&255;v[34]=a>>16&255;v[35]=a>>8&255;v[36]=a&255;g=b(v,37);v.push(g>>24&255);v.push(g>>16&255);v.push(g>>8&255);v.push(g&255);v.push(0);v.push(0);v.push(0);v.push(0);v.push(73);v.push(69);v.push(78);v.push(68);v.push(174);v.push(66);v.push(96);v.push(130);return"data:image/png;base64,"+function(a){var b=a.length,d,c,e,k,l,g="";for(d=0;d<b;d+=3)c=a[d],e=a[d+1],k=a[d+2],l=c>>2,c=((c&3)<<4)+(e>>4),e=((e&15)<<2)+(k>>6),k&=63,d+1>=
b?e=k=64:d+2>=b&&(k=64),g+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k);return g}(v)};numeric._dim=function(a){for(var b=[];"object"===typeof a;)b.push(a.length),a=a[0];return b};
numeric.dim=function(a){var b,d;return"object"===typeof a?(b=a[0],"object"===typeof b?(d=b[0],"object"===typeof d?numeric._dim(a):[a.length,b.length]):[a.length]):[]};
numeric.mapreduce=function(a,b){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+b+';\nif(typeof x === "number") { var xi = x; '+a+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+a+";\n    xi = x[i-1];\n    "+
a+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+a+"\n}\nreturn accum;")};numeric.mapreduce2=function(a,b){return Function("x","var n = x.length;\nvar i,xi;\n"+b+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+a+";\n}\nreturn accum;")};numeric.same=function same(b,d){var c,g;if(!(b instanceof Array&&d instanceof Array))return!1;g=b.length;if(g!==d.length)return!1;for(c=0;c<g;c++)if(b[c]!==d[c])if("object"===typeof b[c]){if(!same(b[c],d[c]))return!1}else return!1;return!0};
numeric.rep=function(a,b,d){"undefined"===typeof d&&(d=0);var c=a[d],g=Array(c);if(d===a.length-1){for(c-=2;0<=c;c-=2)g[c+1]=b,g[c]=b;-1===c&&(g[0]=b);return g}for(--c;0<=c;c--)g[c]=numeric.rep(a,b,d+1);return g};numeric.dotMMsmall=function(a,b){var d,c,g,e,k,q,m,u,v,w;d=a.length;e=b.length;k=b[0].length;q=Array(d);for(--d;0<=d;d--){m=Array(k);u=a[d];for(g=k-1;0<=g;g--){v=u[e-1]*b[e-1][g];for(c=e-2;1<=c;c-=2)w=c-1,v+=u[c]*b[c][g]+u[w]*b[w][g];0===c&&(v+=u[0]*b[0][g]);m[g]=v}q[d]=m}return q};
numeric._getCol=function(a,b,d){var c;for(c=a.length-1;0<c;--c)d[c]=a[c][b],--c,d[c]=a[c][b];0===c&&(d[0]=a[0][b])};numeric.dotMMbig=function(a,b){var d=numeric._getCol,c=Array(b.length),g=a.length,e=b[0].length,k=Array(g),q=numeric.dotVV,m,u;--g;for(m=g;-1!==m;--m)k[m]=Array(e);--e;for(m=e;-1!==m;--m)for(d(b,m,c),u=g;-1!==u;--u)e=a[u],k[u][m]=q(e,c);return k};numeric.dotMV=function(a,b){for(var d=a.length,c=Array(d),g=numeric.dotVV,d=d-1;0<=d;d--)c[d]=g(a[d],b);return c};
numeric.dotVM=function(a,b){var d,c,g,e,k,q;g=a.length;d=b[0].length;e=Array(d);for(c=d-1;0<=c;c--){k=a[g-1]*b[g-1][c];for(d=g-2;1<=d;d-=2)q=d-1,k+=a[d]*b[d][c]+a[q]*b[q][c];0===d&&(k+=a[0]*b[0][c]);e[c]=k}return e};numeric.dotVV=function(a,b){var d;d=a.length;var c,g=a[d-1]*b[d-1];for(d-=2;1<=d;d-=2)c=d-1,g+=a[d]*b[d]+a[c]*b[c];0===d&&(g+=a[0]*b[0]);return g};
numeric.dot=function(a,b){var d=numeric.dim;switch(1E3*d(a).length+d(b).length){case 2002:return 10>b.length?numeric.dotMMsmall(a,b):numeric.dotMMbig(a,b);case 2001:return numeric.dotMV(a,b);case 1002:return numeric.dotVM(a,b);case 1001:return numeric.dotVV(a,b);case 1E3:return numeric.mulVS(a,b);case 1:return numeric.mulSV(a,b);case 0:return a*b;default:throw Error("numeric.dot only works on vectors and matrices");}};
numeric.diag=function(a){var b,d,c,g=a.length,e=Array(g),k;for(b=g-1;0<=b;b--){k=Array(g);d=b+2;for(c=g-1;c>=d;c-=2)k[c]=0,k[c-1]=0;c>b&&(k[c]=0);k[b]=a[b];for(c=b-1;1<=c;c-=2)k[c]=0,k[c-1]=0;0===c&&(k[0]=0);e[b]=k}return e};numeric.getDiag=function(a){for(var b=Math.min(a.length,a[0].length),d=Array(b),b=b-1;1<=b;--b)d[b]=a[b][b],--b,d[b]=a[b][b];0===b&&(d[0]=a[0][0]);return d};numeric.identity=function(a){return numeric.diag(numeric.rep([a],1))};
numeric.pointwise=function(a,b,d){"undefined"===typeof d&&(d="");var c=[],g,e=/\[i\]$/,k,q="",m=!1;for(g=0;g<a.length;g++)e.test(a[g])?q=k=a[g].substring(0,a[g].length-3):k=a[g],"ret"===k&&(m=!0),c.push(k);c[a.length]="_s";c[a.length+1]="_k";c[a.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+q+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(m?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+a.join(",")+",_s,_k+1);\n    return ret;\n}\n"+
d+"\nfor(i=_n-1;i!==-1;--i) {\n    "+b+"\n}\nreturn ret;";return Function.apply(null,c)};numeric.pointwise2=function(a,b,d){"undefined"===typeof d&&(d="");var c=[],g,e=/\[i\]$/,k,q="",m=!1;for(g=0;g<a.length;g++)e.test(a[g])?q=k=a[g].substring(0,a[g].length-3):k=a[g],"ret"===k&&(m=!0),c.push(k);c[a.length]="var _n = "+q+".length;\nvar i"+(m?"":", ret = Array(_n)")+";\n"+d+"\nfor(i=_n-1;i!==-1;--i) {\n"+b+"\n}\nreturn ret;";return Function.apply(null,c)};
numeric._biforeach=function _biforeach(b,d,c,g,e){if(g===c.length-1)e(b,d);else{var k;for(k=c[g]-1;0<=k;k--)_biforeach("object"===typeof b?b[k]:b,"object"===typeof d?d[k]:d,c,g+1,e)}};numeric._biforeach2=function _biforeach2(b,d,c,g,e){if(g===c.length-1)return e(b,d);var k;k=c[g];var q=Array(k);for(--k;0<=k;--k)q[k]=_biforeach2("object"===typeof b?b[k]:b,"object"===typeof d?d[k]:d,c,g+1,e);return q};
numeric._foreach=function _foreach(b,d,c,g){if(c===d.length-1)g(b);else{var e;for(e=d[c]-1;0<=e;e--)_foreach(b[e],d,c+1,g)}};numeric._foreach2=function _foreach2(b,d,c,g){if(c===d.length-1)return g(b);var e;e=d[c];var k=Array(e);for(--e;0<=e;e--)k[e]=_foreach2(b[e],d,c+1,g);return k};numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};
numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="};numeric.mathfuns="abs acos asin atan ceil cos exp floor log round sin sqrt tan isNaN isFinite".split(" ");numeric.mathfuns2=["atan2","pow","max","min"];numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""};
numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]};
(function(){var a,b;for(a=0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],numeric.ops2[b]=b;for(a in numeric.ops2)if(numeric.ops2.hasOwnProperty(a)){b=numeric.ops2[a];var d,c,g="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,a)?(g="var "+b+" = Math."+b+";\n",d=function(a,d,c){return a+" = "+b+"("+d+","+c+")"},c=function(a,d){return a+" = "+b+"("+a+","+d+")"}):(d=function(a,d,c){return a+" = "+d+" "+b+" "+c},c=numeric.opseq.hasOwnProperty(a+"eq")?function(a,d){return a+" "+b+"= "+d}:function(a,
d){return a+" = "+a+" "+b+" "+d});numeric[a+"VV"]=numeric.pointwise2(["x[i]","y[i]"],d("ret[i]","x[i]","y[i]"),g);numeric[a+"SV"]=numeric.pointwise2(["x","y[i]"],d("ret[i]","x","y[i]"),g);numeric[a+"VS"]=numeric.pointwise2(["x[i]","y"],d("ret[i]","x[i]","y"),g);numeric[a]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+
c("x","y")+"\n}\nreturn x;\n");numeric[b]=numeric[a];numeric[a+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],c("ret[i]","x[i]"),g);numeric[a+"eqS"]=numeric.pointwise2(["ret[i]","x"],c("ret[i]","x"),g);numeric[a+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+a+"eqV, S = numeric."+a+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(a=
0;a<numeric.mathfuns2.length;++a)b=numeric.mathfuns2[a],delete numeric.ops2[b];for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],numeric.ops1[b]=b;for(a in numeric.ops1)numeric.ops1.hasOwnProperty(a)&&(g="",b=numeric.ops1[a],-1!==numeric.myIndexOf.call(numeric.mathfuns,a)&&Math.hasOwnProperty(b)&&(g="var "+b+" = Math."+b+";\n"),numeric[a+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+b+"(ret[i]);",g),numeric[a+"eq"]=Function("x",'if(typeof x !== "object") return '+b+"x\nvar i;\nvar V = numeric."+
a+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[a+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+b+"(x[i]);",g),numeric[a]=Function("x",'if(typeof x !== "object") return '+b+"(x)\nvar i;\nvar V = numeric."+a+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(a=0;a<numeric.mathfuns.length;++a)b=numeric.mathfuns[a],delete numeric.ops1[b];for(a in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(a)&&(b=numeric.mapreducers[a],numeric[a+"V"]=
numeric.mapreduce2(b[0],b[1]),numeric[a]=Function("x","s","k",b[1]+'if(typeof x !== "object") {    xi = x;\n'+b[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+a+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+b[0]+";\n}\nreturn accum;\n"))})();numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;");
numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;");numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;");numeric.trunc=function(a,b){return"object"===typeof a?"object"===typeof b?numeric.truncVV(a,b):numeric.truncVS(a,b):"object"===typeof b?numeric.truncSV(a,b):Math.round(a/b)*b};
numeric.inv=function(a){var b=numeric.dim(a),d=Math.abs,c=b[0],b=b[1],g=numeric.clone(a),e,k,q=numeric.identity(c),m,u,v,w,x;for(w=0;w<b;++w){k=a=-1;for(v=w;v!==c;++v)x=d(g[v][w]),x>k&&(a=v,k=x);k=g[a];g[a]=g[w];g[w]=k;u=q[a];q[a]=q[w];q[w]=u;a=k[w];for(x=w;x!==b;++x)k[x]/=a;for(x=b-1;-1!==x;--x)u[x]/=a;for(v=c-1;-1!==v;--v)if(v!==w){e=g[v];m=q[v];a=e[w];for(x=w+1;x!==b;++x)e[x]-=k[x]*a;for(x=b-1;0<x;--x)m[x]-=u[x]*a,--x,m[x]-=u[x]*a;0===x&&(m[0]-=u[0]*a)}}return q};
numeric.det=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw Error("numeric: det() only works on square matrices");var b=b[0],d=1,c,g,e=numeric.clone(a),k,q,m,u;for(a=0;a<b-1;a++){g=a;for(c=a+1;c<b;c++)Math.abs(e[c][a])>Math.abs(e[g][a])&&(g=c);g!==a&&(c=e[g],e[g]=e[a],e[a]=c,d*=-1);k=e[a];for(c=a+1;c<b;c++){q=e[c];m=q[a]/k[a];for(g=a+1;g<b-1;g+=2)u=g+1,q[g]-=k[g]*m,q[u]-=k[u]*m;g!==b&&(q[g]-=k[g]*m)}if(0===k[a])return 0;d*=k[a]}return d*e[a][a]};
numeric.transpose=function(a){var b,d;b=a.length;var c=a[0].length,g=Array(c),e,k,q;for(d=0;d<c;d++)g[d]=Array(b);for(--b;1<=b;b-=2){k=a[b];e=a[b-1];for(d=c-1;1<=d;--d)q=g[d],q[b]=k[d],q[b-1]=e[d],--d,q=g[d],q[b]=k[d],q[b-1]=e[d];0===d&&(q=g[0],q[b]=k[0],q[b-1]=e[0])}if(0===b){e=a[0];for(d=c-1;1<=d;--d)g[d][0]=e[d],--d,g[d][0]=e[d];0===d&&(g[0][0]=e[0])}return g};
numeric.negtranspose=function(a){var b,d;b=a.length;var c=a[0].length,g=Array(c),e,k,q;for(d=0;d<c;d++)g[d]=Array(b);for(--b;1<=b;b-=2){k=a[b];e=a[b-1];for(d=c-1;1<=d;--d)q=g[d],q[b]=-k[d],q[b-1]=-e[d],--d,q=g[d],q[b]=-k[d],q[b-1]=-e[d];0===d&&(q=g[0],q[b]=-k[0],q[b-1]=-e[0])}if(0===b){e=a[0];for(d=c-1;1<=d;--d)g[d][0]=-e[d],--d,g[d][0]=-e[d];0===d&&(g[0][0]=-e[0])}return g};
numeric._random=function _random(b,d){var c;c=b[d];var g=Array(c),e;if(d===b.length-1){e=Math.random;for(--c;1<=c;c-=2)g[c]=e(),g[c-1]=e();0===c&&(g[0]=e());return g}for(--c;0<=c;c--)g[c]=_random(b,d+1);return g};numeric.random=function(a){return numeric._random(a,0)};numeric.norm2=function(a){return Math.sqrt(numeric.norm2Squared(a))};
numeric.linspace=function(a,b,d){"undefined"===typeof d&&(d=Math.max(Math.round(b-a)+1,1));if(2>d)return 1===d?[a]:[];var c,g=Array(d);d--;for(c=d;0<=c;c--)g[c]=(c*b+(d-c)*a)/d;return g};numeric.getBlock=function(a,b,d){function c(a,k){var q,m=b[k];q=d[k]-m;var u=Array(q);if(k===g.length-1){for(;0<=q;q--)u[q]=a[q+m];return u}for(;0<=q;q--)u[q]=c(a[q+m],k+1);return u}var g=numeric.dim(a);return c(a,0)};
numeric.setBlock=function(a,b,d,c){function g(a,c,m){var u,v=b[m],w=d[m]-v;if(m===e.length-1)for(u=w;0<=u;u--)a[u+v]=c[u];for(u=w;0<=u;u--)g(a[u+v],c[u],m+1)}var e=numeric.dim(a);g(a,c,0);return a};numeric.getRange=function(a,b,d){for(var c=b.length,g=d.length,e,k=Array(c),q,m,c=c-1;-1!==c;--c)for(k[c]=Array(g),q=k[c],m=a[b[c]],e=g-1;-1!==e;--e)q[e]=m[d[e]];return k};
numeric.blockMatrix=function(a){var b=numeric.dim(a);if(4>b.length)return numeric.blockMatrix([a]);var d=b[0],b=b[1],c,g,e,k;for(e=g=c=0;e<d;++e)c+=a[e][0].length;for(k=0;k<b;++k)g+=a[0][k][0].length;var q=Array(c);for(e=0;e<c;++e)q[e]=Array(g);var m=0,u,v,w,x,C;for(e=0;e<d;++e){u=g;for(k=b-1;-1!==k;--k)for(c=a[e][k],u-=c[0].length,w=c.length-1;-1!==w;--w)for(C=c[w],v=q[m+w],x=C.length-1;-1!==x;--x)v[u+x]=C[x];m+=a[e][0].length}return q};
numeric.tensor=function(a,b){if("number"===typeof a||"number"===typeof b)return numeric.mul(a,b);var d=numeric.dim(a),c=numeric.dim(b);if(1!==d.length||1!==c.length)throw Error("numeric: tensor product is only defined for vectors");var g=d[0],c=c[0],d=Array(g),e,k,q;for(e=g-1;0<=e;e--){g=Array(c);q=a[e];for(k=c-1;3<=k;--k)g[k]=q*b[k],--k,g[k]=q*b[k],--k,g[k]=q*b[k],--k,g[k]=q*b[k];for(;0<=k;)g[k]=q*b[k],--k;d[e]=g}return d};numeric.T=function(a,b){this.x=a;this.y=b};
numeric.t=function(a,b){return new numeric.T(a,b)};
numeric.Tbinop=function(a,b,d,c,g){if("string"!==typeof g){var e;g="";for(e in numeric)numeric.hasOwnProperty(e)&&(0<=a.indexOf(e)||0<=b.indexOf(e)||0<=d.indexOf(e)||0<=c.indexOf(e))&&1<e.length&&(g+="var "+e+" = numeric."+e+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+g+"\nif(x.y) {  if(y.y) {    return new numeric.T("+c+");\n  }\n  return new numeric.T("+d+");\n}\nif(y.y) {\n  return new numeric.T("+b+");\n}\nreturn new numeric.T("+a+");\n")};
numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)");numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)");numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))");
numeric.T.prototype.reciprocal=function(){var a=numeric.mul,b=numeric.div;return this.y?(a=numeric.add(a(this.x,this.x),a(this.y,this.y)),new numeric.T(b(this.x,a),b(numeric.neg(this.y),a))):new numeric.T(b(1,this.x),0)};numeric.T.prototype.div=function(a){a instanceof numeric.T||(a=new numeric.T(a));if(a.y)return this.mul(a.reciprocal());var b=numeric.div;return this.y?new numeric.T(b(this.x,a.x),b(this.y,a.x)):new numeric.T(b(this.x,a.x))};
numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))");numeric.T.prototype.transpose=function(){var a=numeric.transpose,b=this.x,d=this.y;return d?new numeric.T(a(b),a(d)):new numeric.T(a(b))};numeric.T.prototype.transjugate=function(){var a=numeric.transpose,b=this.x,d=this.y;return d?new numeric.T(a(b),numeric.negtranspose(d)):new numeric.T(a(b))};
numeric.Tunop=function(a,b,d){"string"!==typeof d&&(d="");return Function("var x = this;\n"+d+"\nif(x.y) {  "+b+";\n}\n"+a+";\n")};numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;");numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));");
numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;");numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));");numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);");
numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;");numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);");numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));");
numeric.T.prototype.inv=function(){if("undefined"===typeof this.y)return new numeric.T(numeric.inv(this.x));var a=this.x.length,b,d,c,g=numeric.identity(a),e=numeric.rep([a,a],0),k=numeric.clone(this.x),q=numeric.clone(this.y),m,u,v,w,x,C,D,G,E,l,L,H;for(b=0;b<a;b++){E=k[b][b];l=q[b][b];v=E*E+l*l;c=b;for(d=b+1;d<a;d++)E=k[d][b],l=q[d][b],m=E*E+l*l,m>v&&(c=d,v=m);c!==b&&(d=k[b],k[b]=k[c],k[c]=d,d=q[b],q[b]=q[c],q[c]=d,d=g[b],g[b]=g[c],g[c]=d,d=e[b],e[b]=e[c],e[c]=d);m=k[b];u=q[b];x=g[b];C=e[b];E=m[b];
l=u[b];for(d=b+1;d<a;d++)L=m[d],H=u[d],m[d]=(L*E+H*l)/v,u[d]=(H*E-L*l)/v;for(d=0;d<a;d++)L=x[d],H=C[d],x[d]=(L*E+H*l)/v,C[d]=(H*E-L*l)/v;for(d=b+1;d<a;d++){v=k[d];w=q[d];D=g[d];G=e[d];E=v[b];l=w[b];for(c=b+1;c<a;c++)L=m[c],H=u[c],v[c]-=L*E-H*l,w[c]-=H*E+L*l;for(c=0;c<a;c++)L=x[c],H=C[c],D[c]-=L*E-H*l,G[c]-=H*E+L*l}}for(b=a-1;0<b;b--)for(x=g[b],C=e[b],d=b-1;0<=d;d--)for(D=g[d],G=e[d],E=k[d][b],l=q[d][b],c=a-1;0<=c;c--)L=x[c],H=C[c],D[c]-=E*L-l*H,G[c]-=E*H+l*L;return new numeric.T(g,e)};
numeric.T.prototype.get=function(a){var b=this.x,d=this.y,c=0,g,e=a.length;if(d){for(;c<e;)g=a[c],b=b[g],d=d[g],c++;return new numeric.T(b,d)}for(;c<e;)g=a[c],b=b[g],c++;return new numeric.T(b)};
numeric.T.prototype.set=function(a,b){var d=this.x,c=this.y,g=0,e,k=a.length,q=b.x,m=b.y;if(0===k)return m?this.y=m:c&&(this.y=void 0),this.x=d,this;if(m){c||(this.y=c=numeric.rep(numeric.dim(d),0));for(;g<k-1;)e=a[g],d=d[e],c=c[e],g++;e=a[g];d[e]=q;c[e]=m;return this}if(c){for(;g<k-1;)e=a[g],d=d[e],c=c[e],g++;e=a[g];d[e]=q;c[e]=q instanceof Array?numeric.rep(numeric.dim(q),0):0;return this}for(;g<k-1;)e=a[g],d=d[e],g++;e=a[g];d[e]=q;return this};
numeric.T.prototype.getRows=function(a,b){var d=b-a+1,c,g=Array(d),e=this.x,k=this.y;for(c=a;c<=b;c++)g[c-a]=e[c];if(k){d=Array(d);for(c=a;c<=b;c++)d[c-a]=k[c];return new numeric.T(g,d)}return new numeric.T(g)};numeric.T.prototype.setRows=function(a,b,d){var c=this.x,g=this.y,e=d.x,k=d.y;for(d=a;d<=b;d++)c[d]=e[d-a];if(k)for(g||(this.y=g=numeric.rep(numeric.dim(c),0)),d=a;d<=b;d++)g[d]=k[d-a];else if(g)for(d=a;d<=b;d++)g[d]=numeric.rep([e[d-a].length],0);return this};
numeric.T.prototype.getRow=function(a){var b=this.x,d=this.y;return d?new numeric.T(b[a],d[a]):new numeric.T(b[a])};numeric.T.prototype.setRow=function(a,b){var d=this.x,c=this.y,g=b.x,e=b.y;d[a]=g;e?(c||(this.y=c=numeric.rep(numeric.dim(d),0)),c[a]=e):c&&numeric.rep([g.length],0);return this};numeric.T.prototype.getBlock=function(a,b){var d=this.x,c=this.y,g=numeric.getBlock;return c?new numeric.T(g(d,a,b),g(c,a,b)):new numeric.T(g(d,a,b))};
numeric.T.prototype.setBlock=function(a,b,d){d instanceof numeric.T||(d=new numeric.T(d));var c=this.x,g=this.y,e=numeric.setBlock,k=d.x;if(d=d.y)return g||(g=this.y=numeric.rep(numeric.dim(this),0)),e(c,a,b,k),e(g,a,b,d),this;e(c,a,b,k);g&&e(g,a,b,numeric.rep(numeric.dim(k),0))};numeric.T.rep=function(a,b){var d=numeric.T;b instanceof d||(b=new d(b));var c=b.x,g=b.y,e=numeric.rep;return g?new d(e(a,c),e(a,g)):new d(e(a,c))};
numeric.T.diag=function(a){a instanceof numeric.T||(a=new numeric.T(a));var b=a.x;a=a.y;var d=numeric.diag;return a?new numeric.T(d(b),d(a)):new numeric.T(d(b))};numeric.T.identity=function(a){return new numeric.T(numeric.identity(a))};numeric.T.prototype.getDiag=function(){var a=numeric,b=this.x,d=this.y;return d?new a.T(a.getDiag(b),a.getDiag(d)):new a.T(a.getDiag(b))};
numeric.house=function(a){var b=numeric.clone(a);a=(0<=a[0]?1:-1)*numeric.norm2(a);b[0]+=a;a=numeric.norm2(b);if(0===a)throw Error("eig: internal error");return numeric.div(b,a)};
numeric.toUpperHessenberg=function(a){var b=numeric.dim(a);if(2!==b.length||b[0]!==b[1])throw Error("numeric: toUpperHessenberg() only works on square matrices");var b=b[0],d,c,g,e=numeric.clone(a),k,q,m,u=numeric.identity(b);for(d=0;d<b-2;d++){c=Array(b-d-1);for(a=d+1;a<b;a++)c[a-d-1]=e[a][d];if(0<numeric.norm2(c)){g=numeric.house(c);c=numeric.getBlock(e,[d+1,d],[b-1,b-1]);k=numeric.tensor(g,numeric.dot(g,c));for(a=d+1;a<b;a++)for(q=e[a],m=k[a-d-1],c=d;c<b;c++)q[c]-=2*m[c-d];c=numeric.getBlock(e,
[0,d+1],[b-1,b-1]);k=numeric.tensor(numeric.dot(c,g),g);for(a=0;a<b;a++)for(q=e[a],m=k[a],c=d+1;c<b;c++)q[c]-=2*m[c-d-1];c=Array(b-d-1);for(a=d+1;a<b;a++)c[a-d-1]=u[a];k=numeric.tensor(g,numeric.dot(g,c));for(a=d+1;a<b;a++)for(g=u[a],m=k[a-d-1],c=0;c<b;c++)g[c]-=2*m[c]}}return{H:e,Q:u}};numeric.epsilon=2.220446049250313E-16;
numeric.QRFrancis=function(a,b){"undefined"===typeof b&&(b=1E4);a=numeric.clone(a);numeric.clone(a);var d=numeric.dim(a)[0],c,g,e,k,q,m,u=numeric.identity(d),v,w,x;if(3>d)return{Q:u,B:[[0,d-1]]};var C=numeric.epsilon;for(x=0;x<b;x++){for(e=0;e<d-1;e++)if(Math.abs(a[e+1][e])<C*(Math.abs(a[e][e])+Math.abs(a[e+1][e+1]))){x=numeric.QRFrancis(numeric.getBlock(a,[0,0],[e,e]),b);C=numeric.QRFrancis(numeric.getBlock(a,[e+1,e+1],[d-1,d-1]),b);k=Array(e+1);for(m=0;m<=e;m++)k[m]=u[m];k=numeric.dot(x.Q,k);for(m=
0;m<=e;m++)u[m]=k[m];k=Array(d-e-1);for(m=e+1;m<d;m++)k[m-e-1]=u[m];k=numeric.dot(C.Q,k);for(m=e+1;m<d;m++)u[m]=k[m-e-1];return{Q:u,B:x.B.concat(numeric.add(C.B,e+1))}}e=a[d-2][d-2];c=a[d-2][d-1];k=a[d-1][d-2];q=a[d-1][d-1];m=e+q;k=e*q-c*k;e=numeric.getBlock(a,[0,0],[2,2]);m*m>=4*k?(c=.5*(m+Math.sqrt(m*m-4*k)),m=.5*(m-Math.sqrt(m*m-4*k)),e=numeric.add(numeric.sub(numeric.dot(e,e),numeric.mul(e,c+m)),numeric.diag(numeric.rep([3],c*m)))):e=numeric.add(numeric.sub(numeric.dot(e,e),numeric.mul(e,m)),
numeric.diag(numeric.rep([3],k)));c=[e[0][0],e[1][0],e[2][0]];g=numeric.house(c);k=[a[0],a[1],a[2]];k=numeric.tensor(g,numeric.dot(g,k));for(m=0;3>m;m++)for(v=a[m],w=k[m],c=0;c<d;c++)v[c]-=2*w[c];k=numeric.getBlock(a,[0,0],[d-1,2]);k=numeric.tensor(numeric.dot(k,g),g);for(m=0;m<d;m++)for(v=a[m],w=k[m],c=0;3>c;c++)v[c]-=2*w[c];k=[u[0],u[1],u[2]];k=numeric.tensor(g,numeric.dot(g,k));for(m=0;3>m;m++)for(g=u[m],w=k[m],c=0;c<d;c++)g[c]-=2*w[c];for(e=0;e<d-2;e++){for(c=e;c<=e+1;c++)if(Math.abs(a[c+1][c])<
C*(Math.abs(a[c][c])+Math.abs(a[c+1][c+1]))){x=numeric.QRFrancis(numeric.getBlock(a,[0,0],[c,c]),b);C=numeric.QRFrancis(numeric.getBlock(a,[c+1,c+1],[d-1,d-1]),b);k=Array(c+1);for(m=0;m<=c;m++)k[m]=u[m];k=numeric.dot(x.Q,k);for(m=0;m<=c;m++)u[m]=k[m];k=Array(d-c-1);for(m=c+1;m<d;m++)k[m-c-1]=u[m];k=numeric.dot(C.Q,k);for(m=c+1;m<d;m++)u[m]=k[m-c-1];return{Q:u,B:x.B.concat(numeric.add(C.B,c+1))}}q=Math.min(d-1,e+3);c=Array(q-e);for(m=e+1;m<=q;m++)c[m-e-1]=a[m][e];g=numeric.house(c);k=numeric.getBlock(a,
[e+1,e],[q,d-1]);k=numeric.tensor(g,numeric.dot(g,k));for(m=e+1;m<=q;m++)for(v=a[m],w=k[m-e-1],c=e;c<d;c++)v[c]-=2*w[c-e];k=numeric.getBlock(a,[0,e+1],[d-1,q]);k=numeric.tensor(numeric.dot(k,g),g);for(m=0;m<d;m++)for(v=a[m],w=k[m],c=e+1;c<=q;c++)v[c]-=2*w[c-e-1];k=Array(q-e);for(m=e+1;m<=q;m++)k[m-e-1]=u[m];k=numeric.tensor(g,numeric.dot(g,k));for(m=e+1;m<=q;m++)for(g=u[m],w=k[m-e-1],c=0;c<d;c++)g[c]-=2*w[c]}}throw Error("numeric: eigenvalue iteration does not converge -- increase maxiter?");};
numeric.eig=function(a,b){for(var d=numeric.toUpperHessenberg(a),c=numeric.QRFrancis(d.H,b),g=numeric.T,e=a.length,k,e=c.B,q=numeric.dot(c.Q,numeric.dot(d.H,numeric.transpose(c.Q))),c=new g(numeric.dot(c.Q,d.Q)),m,u=e.length,v,w,x,C,D,G,E,l,L=Math.sqrt,d=0;d<u;d++)if(k=e[d][0],k!==e[d][1]&&(v=k+1,w=q[k][k],x=q[k][v],C=q[v][k],D=q[v][v],0!==x||0!==C))m=-w-D,G=w*D-x*C,G=m*m-4*G,0<=G?(m=0>m?-.5*(m-L(G)):-.5*(m+L(G)),E=(w-m)*(w-m)+x*x,l=C*C+(D-m)*(D-m),E>l?(E=L(E),w=(w-m)/E,x/=E):(l=L(l),w=C/l,x=(D-m)/
l),m=new g([[x,-w],[w,x]])):(m*=-.5,G=.5*L(-G),E=(w-m)*(w-m)+x*x,l=C*C+(D-m)*(D-m),E>l?(E=L(E+G*G),w=(w-m)/E,x/=E,m=0,G/=E):(l=L(l+G*G),w=C/l,x=(D-m)/l,m=G/l,G=0),m=new g([[x,-w],[w,x]],[[m,G],[G,-m]])),c.setRows(k,v,m.dot(c.getRows(k,v)));g=c.dot(a).dot(c.transjugate());e=a.length;q=numeric.T.identity(e);for(v=0;v<e;v++)if(0<v)for(d=v-1;0<=d;d--)k=g.get([d,d]),u=g.get([v,v]),numeric.neq(k.x,u.x)||numeric.neq(k.y,u.y)?(m=g.getRow(d).getBlock([d],[v-1]),G=q.getRow(v).getBlock([d],[v-1]),q.set([v,d],
g.get([d,v]).neg().sub(m.dot(G)).div(k.sub(u)))):q.setRow(v,q.getRow(d));for(v=0;v<e;v++)m=q.getRow(v),q.setRow(v,m.div(m.norm2()));q=q.transpose();q=c.transjugate().dot(q);return{lambda:g.getDiag(),E:q}};
numeric.ccsSparse=function(a){var b=a.length,d,c,g,e=[];for(c=b-1;-1!==c;--c)for(g in d=a[c],d){for(g=parseInt(g);g>=e.length;)e[e.length]=0;0!==d[g]&&e[g]++}d=e.length;var k=Array(d+1);for(c=k[0]=0;c<d;++c)k[c+1]=k[c]+e[c];var q=Array(k[d]),m=Array(k[d]);for(c=b-1;-1!==c;--c)for(g in d=a[c],d)0!==d[g]&&(e[g]--,q[k[g]+e[g]]=c,m[k[g]+e[g]]=d[g]);return[k,q,m]};
numeric.ccsFull=function(a){var b=a[0],d=a[1],c=a[2],g=numeric.ccsDim(a);a=g[1];for(var e,k,q=numeric.rep([g[0],a],0),g=0;g<a;g++)for(e=b[g],k=b[g+1];e<k;++e)q[d[e]][g]=c[e];return q};
numeric.ccsTSolve=function(a,b,d,c,g){function e(a){var b;if(0===d[a]){d[a]=1;for(b=k[a];b<k[a+1];++b)e(q[b]);g[v]=a;++v}}var k=a[0],q=a[1];a=a[2];var m=k.length-1,u=Math.max,v=0;"undefined"===typeof c&&(d=numeric.rep([m],0));"undefined"===typeof c&&(c=numeric.linspace(0,d.length-1));"undefined"===typeof g&&(g=[]);for(var w,x,C,m=c.length-1;-1!==m;--m)e(c[m]);g.length=v;for(m=g.length-1;-1!==m;--m)d[g[m]]=0;for(m=c.length-1;-1!==m;--m)w=c[m],d[w]=b[w];for(m=g.length-1;-1!==m;--m){w=g[m];x=k[w];b=
u(k[w+1],x);for(c=x;c!==b;++c)if(q[c]===w){d[w]/=a[c];break}C=d[w];for(c=x;c!==b;++c)x=q[c],x!==w&&(d[x]-=C*a[c])}return d};numeric.ccsDFS=function(a){this.k=Array(a);this.k1=Array(a);this.j=Array(a)};numeric.ccsDFS.prototype.dfs=function(a,b,d,c,g,e){var k=0,q=g.length,m=this.k,u=this.k1,v=this.j,w,x;if(0===c[a])for(c[a]=1,v[0]=a,m[0]=w=b[a],u[0]=x=b[a+1];;)if(w>=x){g[q]=v[k];if(0===k)break;++q;--k;w=m[k];x=u[k]}else a=e[d[w]],0===c[a]?(c[a]=1,m[k]=w,++k,v[k]=a,w=b[a],u[k]=x=b[a+1]):++w};
numeric.ccsLPSolve=function(a,b,d,c,g,e,k){var q=a[0],m=a[1];a=a[2];var u=b[0],v=b[1];b=b[2];var w;w=u[g];u=u[g+1];c.length=0;for(g=w;g<u;++g)k.dfs(e[v[g]],q,m,d,c,e);for(g=c.length-1;-1!==g;--g)d[c[g]]=0;for(g=w;g!==u;++g)k=e[v[g]],d[k]=b[g];for(g=c.length-1;-1!==g;--g){k=c[g];u=q[k];v=q[k+1];for(b=u;b<v;++b)if(e[m[b]]===k){d[k]/=a[b];break}w=d[k];for(b=u;b<v;++b)u=e[m[b]],u!==k&&(d[u]-=w*a[b])}return d};
numeric.ccsLUP1=function(a,b){var d=a[0].length-1,c=[numeric.rep([d+1],0),[],[]],g=[numeric.rep([d+1],0),[],[]],e=c[0],k=c[1],q=c[2],m=g[0],u=g[1],v=g[2],w=numeric.rep([d],0),x=numeric.rep([d],0),C,D,G,E,l,L,H,S=numeric.ccsLPSolve,O=Math.abs,Y=numeric.linspace(0,d-1),ea=numeric.linspace(0,d-1),fa=new numeric.ccsDFS(d);"undefined"===typeof b&&(b=1);for(C=0;C<d;++C){S(c,a,w,x,C,ea,fa);l=E=-1;for(D=x.length-1;-1!==D;--D)G=x[D],G<=C||(L=O(w[G]),L>E&&(l=G,E=L));O(w[C])<b*E&&(D=Y[C],E=Y[l],Y[C]=E,ea[E]=
C,Y[l]=D,ea[D]=l,E=w[C],w[C]=w[l],w[l]=E);E=e[C];l=m[C];H=w[C];k[E]=Y[C];q[E]=1;++E;for(D=x.length-1;-1!==D;--D)G=x[D],L=w[G],x[D]=0,w[G]=0,G<=C?(u[l]=G,v[l]=L,++l):(k[E]=Y[G],q[E]=L/H,++E);e[C+1]=E;m[C+1]=l}for(D=k.length-1;-1!==D;--D)k[D]=ea[k[D]];return{L:c,U:g,P:Y,Pinv:ea}};numeric.ccsDFS0=function(a){this.k=Array(a);this.k1=Array(a);this.j=Array(a)};
numeric.ccsDFS0.prototype.dfs=function(a,b,d,c,g,e,k){k=0;var q=g.length,m=this.k,u=this.k1,v=this.j,w,x;if(0===c[a])for(c[a]=1,v[0]=a,m[0]=w=b[e[a]],u[0]=x=b[e[a]+1];;){if(isNaN(w))throw Error("Ow!");if(w>=x){g[q]=e[v[k]];if(0===k)break;++q;--k;w=m[k];x=u[k]}else a=d[w],0===c[a]?(c[a]=1,m[k]=w,++k,v[k]=a,a=e[a],w=b[a],u[k]=x=b[a+1]):++w}};
numeric.ccsLPSolve0=function(a,b,d,c,g,e,k,q){var m=a[0],u=a[1];a=a[2];var v=b[0],w=b[1];b=b[2];var x;x=v[g];v=v[g+1];c.length=0;for(g=x;g<v;++g)q.dfs(w[g],m,u,d,c,e,k);for(g=c.length-1;-1!==g;--g)e=c[g],d[k[e]]=0;for(g=x;g!==v;++g)e=w[g],d[e]=b[g];for(g=c.length-1;-1!==g;--g){e=c[g];w=k[e];q=m[e];e=m[e+1];for(b=q;b<e;++b)if(u[b]===w){d[w]/=a[b];break}x=d[w];for(b=q;b<e;++b)d[u[b]]-=x*a[b];d[w]=x}};
numeric.ccsLUP0=function(a,b){var d=a[0].length-1,c=[numeric.rep([d+1],0),[],[]],g=[numeric.rep([d+1],0),[],[]],e=c[0],k=c[1],q=c[2],m=g[0],u=g[1],v=g[2],w=numeric.rep([d],0),x=numeric.rep([d],0),C,D,G,E,l,L,H,S=numeric.ccsLPSolve0,O=Math.abs,Y=numeric.linspace(0,d-1),ea=numeric.linspace(0,d-1),fa=new numeric.ccsDFS0(d);"undefined"===typeof b&&(b=1);for(C=0;C<d;++C){S(c,a,w,x,C,ea,Y,fa);l=E=-1;for(D=x.length-1;-1!==D;--D)G=x[D],G<=C||(L=O(w[Y[G]]),L>E&&(l=G,E=L));O(w[Y[C]])<b*E&&(D=Y[C],E=Y[l],Y[C]=
E,ea[E]=C,Y[l]=D,ea[D]=l);E=e[C];l=m[C];H=w[Y[C]];k[E]=Y[C];q[E]=1;++E;for(D=x.length-1;-1!==D;--D)G=x[D],L=w[Y[G]],x[D]=0,w[Y[G]]=0,G<=C?(u[l]=G,v[l]=L,++l):(k[E]=Y[G],q[E]=L/H,++E);e[C+1]=E;m[C+1]=l}for(D=k.length-1;-1!==D;--D)k[D]=ea[k[D]];return{L:c,U:g,P:Y,Pinv:ea}};numeric.ccsLUP=numeric.ccsLUP0;numeric.ccsDim=function(a){return[numeric.sup(a[1])+1,a[0].length-1]};
numeric.ccsGetBlock=function(a,b,d){var c=numeric.ccsDim(a),g=c[0],e=c[1];"undefined"===typeof b?b=numeric.linspace(0,g-1):"number"===typeof b&&(b=[b]);"undefined"===typeof d?d=numeric.linspace(0,e-1):"number"===typeof d&&(d=[d]);var k,c=b.length,q=d.length,m,e=numeric.rep([e],0),u=[],v=[],w=[e,u,v],x=a[0],C=a[1];a=a[2];for(var D=numeric.rep([g],0),G=0,E=numeric.rep([g],0),g=0;g<q;++g){k=d[g];var l=x[k],L=x[k+1];for(k=l;k<L;++k)m=C[k],E[m]=1,D[m]=a[k];for(k=0;k<c;++k)m=b[k],E[m]&&(u[G]=k,v[G]=D[b[k]],
++G);for(k=l;k<L;++k)m=C[k],E[m]=0;e[g+1]=G}return w};
numeric.ccsDot=function(a,b){var d=a[0],c=a[1],g=a[2],e=b[0],k=b[1],q=b[2],m=numeric.ccsDim(a),u=numeric.ccsDim(b),v=m[0],u=u[1],m=numeric.rep([v],0),w=numeric.rep([v],0),v=Array(v),x=numeric.rep([u],0),C=[],D=[],G=[x,C,D],E,l,L,H,S,O,Y,ea;for(L=0;L!==u;++L){H=e[L];S=e[L+1];Y=0;for(l=H;l<S;++l)for(H=k[l],ea=q[l],E=d[H],H=d[H+1];E<H;++E)O=c[E],0===w[O]&&(v[Y]=O,w[O]=1,Y+=1),m[O]+=g[E]*ea;H=x[L];S=H+Y;x[L+1]=S;for(l=Y-1;-1!==l;--l)ea=H+l,E=v[l],C[ea]=E,D[ea]=m[E],w[E]=0,m[E]=0;x[L+1]=x[L]+Y}return G};
numeric.ccsLUPSolve=function(a,b){var d=a.L,c=a.U,g=b[0],e=!1;"object"!==typeof g&&(b=[[0,b.length],numeric.linspace(0,b.length-1),b],g=b[0],e=!0);var k=b[1],q=b[2],m=d[0].length-1,u=g.length-1,v=numeric.rep([m],0),w=Array(m),x=numeric.rep([m],0),m=Array(m),C=numeric.rep([u+1],0),D=[],G=[],E=numeric.ccsTSolve,l,L,H,S,O,Y=0;for(l=0;l<u;++l){S=0;L=g[l];for(H=g[l+1];L<H;++L)O=a.Pinv[k[L]],m[S]=O,x[O]=q[L],++S;m.length=S;E(d,x,v,m,w);for(L=m.length-1;-1!==L;--L)x[m[L]]=0;E(c,v,x,w,m);if(e)return x;for(L=
w.length-1;-1!==L;--L)v[w[L]]=0;for(L=m.length-1;-1!==L;--L)O=m[L],D[Y]=O,G[Y]=x[O],x[O]=0,++Y;C[l+1]=Y}return[C,D,G]};
numeric.ccsbinop=function(a,b){"undefined"===typeof b&&(b="");return Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+b+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+a+
"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")};
(function(){var a,b,d,c;for(a in numeric.ops2)b=isFinite(eval("1"+numeric.ops2[a]+"0"))?"[Y[0],Y[1],numeric."+a+"(X,Y[2])]":"NaN",d=isFinite(eval("0"+numeric.ops2[a]+"1"))?"[X[0],X[1],numeric."+a+"(X[2],Y)]":"NaN",c=isFinite(eval("1"+numeric.ops2[a]+"0"))&&isFinite(eval("0"+numeric.ops2[a]+"1"))?"numeric.ccs"+a+"MM(X,Y)":"NaN",numeric["ccs"+a+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[a]+"yk;"),numeric["ccs"+a]=Function("X","Y",'if(typeof X === "number") return '+b+';\nif(typeof Y === "number") return '+
d+";\nreturn "+c+";\n")})();numeric.ccsScatter=function(a){var b=a[0],d=a[1];a=a[2];var c=numeric.sup(d)+1,g=b.length,e=numeric.rep([c],0),k=Array(g),q=Array(g),m=numeric.rep([c],0),u;for(u=0;u<g;++u)m[d[u]]++;for(u=0;u<c;++u)e[u+1]=e[u]+m[u];var c=e.slice(0),v;for(u=0;u<g;++u)v=d[u],m=c[v],k[m]=b[u],q[m]=a[u],c[v]+=1;return[e,k,q]};
numeric.ccsGather=function(a){var b=a[0],d=a[1];a=a[2];var c=b.length-1,g=d.length,e=Array(g),k=Array(g),g=Array(g),q,m,u,v;for(q=v=0;q<c;++q)for(m=b[q],u=b[q+1];m!==u;++m)k[v]=q,e[v]=d[m],g[v]=a[m],++v;return[e,k,g]};numeric.sdim=function dim(b,d,c){"undefined"===typeof d&&(d=[]);if("object"!==typeof b)return d;"undefined"===typeof c&&(c=0);c in d||(d[c]=0);b.length>d[c]&&(d[c]=b.length);for(var g in b)b.hasOwnProperty(g)&&dim(b[g],d,c+1);return d};
numeric.sclone=function clone(b,d,c){"undefined"===typeof d&&(d=0);"undefined"===typeof c&&(c=numeric.sdim(b).length);var g,e=Array(b.length);if(d===c-1){for(g in b)b.hasOwnProperty(g)&&(e[g]=b[g]);return e}for(g in b)b.hasOwnProperty(g)&&(e[g]=clone(b[g],d+1,c));return e};numeric.sdiag=function(a){for(var b=a.length,d=Array(b),c,b=b-1;1<=b;b-=2)c=b-1,d[b]=[],d[b][b]=a[b],d[c]=[],d[c][c]=a[c];0===b&&(d[0]=[],d[0][0]=a[b]);return d};
numeric.sidentity=function(a){return numeric.sdiag(numeric.rep([a],1))};numeric.stranspose=function(a){var b=[],d,c,g;for(d in a)if(a.hasOwnProperty(d))for(c in g=a[d],g)g.hasOwnProperty(c)&&("object"!==typeof b[c]&&(b[c]=[]),b[c][d]=g[c]);return b};numeric.sLUP=function(a,b){throw Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.");};
numeric.sdotMM=function(a,b){var d=a.length,c=numeric.stranspose(b),g=c.length,e,k,q,m,u,v=Array(d),w;for(k=d-1;0<=k;k--){w=[];d=a[k];for(m=g-1;0<=m;m--){u=0;e=c[m];for(q in d)d.hasOwnProperty(q)&&q in e&&(u+=d[q]*e[q]);u&&(w[m]=u)}v[k]=w}return v};numeric.sdotMV=function(a,b){var d=a.length,c,g,e=Array(d),k;for(c=d-1;0<=c;c--){d=a[c];k=0;for(g in d)d.hasOwnProperty(g)&&b[g]&&(k+=d[g]*b[g]);k&&(e[c]=k)}return e};
numeric.sdotVM=function(a,b){var d,c,g,e,k=[];for(d in a)if(a.hasOwnProperty(d))for(c in g=b[d],e=a[d],g)g.hasOwnProperty(c)&&(k[c]||(k[c]=0),k[c]+=e*g[c]);return k};numeric.sdotVV=function(a,b){var d,c=0;for(d in a)a[d]&&b[d]&&(c+=a[d]*b[d]);return c};
numeric.sdot=function(a,b){var d=numeric.sdim(a).length,c=numeric.sdim(b).length;switch(1E3*d+c){case 0:return a*b;case 1001:return numeric.sdotVV(a,b);case 2001:return numeric.sdotMV(a,b);case 1002:return numeric.sdotVM(a,b);case 2002:return numeric.sdotMM(a,b);default:throw Error("numeric.sdot not implemented for tensors of order "+d+" and "+c);}};
numeric.sscatter=function(a){var b,d,c,g=a.length,e=[],k;for(d=a[0].length-1;0<=d;--d)if(a[g-1][d]){k=e;for(c=0;c<g-2;c++)b=a[c][d],k[b]||(k[b]=[]),k=k[b];k[a[c][d]]=a[c+1][d]}return e};
numeric.sgather=function gather(b,d,c){"undefined"===typeof d&&(d=[]);"undefined"===typeof c&&(c=[]);var g,e,k;g=c.length;for(e in b)if(b.hasOwnProperty(e))if(c[g]=parseInt(e),k=b[e],"number"===typeof k){if(k){if(0===d.length)for(e=g+1;0<=e;--e)d[e]=[];for(e=g;0<=e;--e)d[e].push(c[e]);d[g+1].push(k)}}else gather(k,d,c);c.length>g&&c.pop();return d};
numeric.cLU=function(a){var b=a[0],d=a[1],c=a[2],g=b.length;a=0;var e,k,q;for(e=0;e<g;e++)b[e]>a&&(a=b[e]);a++;var m=Array(a),u=Array(a),v=numeric.rep([a],Infinity),w=numeric.rep([a],-Infinity),x,C;for(q=0;q<g;q++)e=b[q],k=d[q],k<v[e]&&(v[e]=k),k>w[e]&&(w[e]=k);for(e=0;e<a-1;e++)w[e]>w[e+1]&&(w[e+1]=w[e]);for(e=a-1;1<=e;e--)v[e]<v[e-1]&&(v[e-1]=v[e]);for(e=0;e<a;e++)u[e]=numeric.rep([w[e]-v[e]+1],0),m[e]=numeric.rep([e-v[e]],0);for(q=0;q<g;q++)e=b[q],u[e][d[q]-v[e]]=c[q];for(e=0;e<a-1;e++)for(b=e-
v[e],c=u[e],k=e+1;v[k]<=e&&k<a;k++)if(d=e-v[k],g=w[e]-e,x=u[k],C=x[d]/c[b]){for(q=1;q<=g;q++)x[q+d]-=C*c[q+b];m[k][e-v[k]]=C}c=[];x=[];q=[];C=[];var D=[],G=[],E,l;for(e=E=g=0;e<a;e++){b=v[e];d=w[e];l=u[e];for(k=e;k<=d;k++)l[k-b]&&(c[g]=e,x[g]=k,q[g]=l[k-b],g++);l=m[e];for(k=b;k<e;k++)l[k-b]&&(C[E]=e,D[E]=k,G[E]=l[k-b],E++);C[E]=e;D[E]=e;G[E]=1;E++}return{U:[c,x,q],L:[C,D,G]}};
numeric.cLUsolve=function(a,b){var d=a.L,c=a.U,g=numeric.clone(b),e=d[1],d=d[2],k=c[1],q=c[2],c=c[0].length,m=g.length,u,v;for(u=v=0;u<m;u++){for(;e[v]<u;)g[u]-=d[v]*g[e[v]],v++;v++}v=c-1;for(u=m-1;0<=u;u--){for(;k[v]>u;)g[u]-=q[v]*g[k[v]],v--;g[u]/=q[v];v--}return g};
numeric.cgrid=function(a,b){"number"===typeof a&&(a=[a,a]);var d=numeric.rep(a,-1),c,g,e;if("function"!==typeof b)switch(b){case "L":b=function(d,b){return d>=a[0]/2||b<a[1]/2};break;default:b=function(a,d){return!0}}e=0;for(c=1;c<a[0]-1;c++)for(g=1;g<a[1]-1;g++)b(c,g)&&(d[c][g]=e,e++);return d};
numeric.cdelsq=function(a){var b=[[-1,0],[0,-1],[0,1],[1,0]],d=numeric.dim(a),c=d[0],d=d[1],g,e,k,q,m,u=[],v=[],w=[];for(g=1;g<c-1;g++)for(e=1;e<d-1;e++)if(!(0>a[g][e])){for(k=0;4>k;k++)q=g+b[k][0],m=e+b[k][1],0>a[q][m]||(u.push(a[g][e]),v.push(a[q][m]),w.push(-1));u.push(a[g][e]);v.push(a[g][e]);w.push(4)}return[u,v,w]};numeric.cdotMV=function(a,b){var d,c=a[0],g=a[1],e=a[2],k,q=c.length;for(k=d=0;k<q;k++)c[k]>d&&(d=c[k]);d++;d=numeric.rep([d],0);for(k=0;k<q;k++)d[c[k]]+=e[k]*b[g[k]];return d};
numeric.Spline=function(a,b,d,c,g){this.x=a;this.yl=b;this.yr=d;this.kl=c;this.kr=g};numeric.Spline.prototype._at=function(a,b){var d=this.x,c=this.yl,g=this.yr,e=this.kr,k,q=numeric.add,m=numeric.sub,u=numeric.mul;k=m(u(this.kl[b],d[b+1]-d[b]),m(g[b+1],c[b]));e=q(u(e[b+1],d[b]-d[b+1]),m(g[b+1],c[b]));d=(a-d[b])/(d[b+1]-d[b]);m=d*(1-d);return q(q(q(u(1-d,c[b]),u(d,g[b+1])),u(k,m*(1-d))),u(e,m*d))};
numeric.Spline.prototype.at=function(a){if("number"===typeof a){var b=this.x,d=b.length,c,g,e=Math.floor;c=0;for(--d;1<d-c;)g=e((c+d)/2),b[g]<=a?c=g:d=g;return this._at(a,c)}d=a.length;b=Array(d);for(c=d-1;-1!==c;--c)b[c]=this.at(a[c]);return b};
numeric.Spline.prototype.diff=function(){for(var a=this.x,b=this.yl,d=this.yr,c=this.kl,g=this.kr,e=b.length,k,q,m=Array(e),u=Array(e),v=numeric.add,w=numeric.mul,x=numeric.div,C=numeric.sub,e=e-1;-1!==e;--e)k=a[e+1]-a[e],q=C(d[e+1],b[e]),m[e]=x(v(w(q,6),w(c[e],-4*k),w(g[e+1],-2*k)),k*k),u[e+1]=x(v(w(q,-6),w(c[e],2*k),w(g[e+1],4*k)),k*k);return new numeric.Spline(a,c,g,m,u)};
numeric.Spline.prototype.roots=function(){var a=[],b=this.x,d=this.yl,c=this.yr,g=this.kl,e=this.kr;"number"===typeof d[0]&&(d=[d],c=[c],g=[g],e=[e]);var k=d.length,q=b.length-1,m,u,v,w,x,C,D,a=Array(k),G,E,l,L,H,S,O,Y,ea=Math.sqrt;for(m=0;m!==k;++m){w=d[m];x=c[m];C=g[m];D=e[m];G=[];for(u=0;u!==q;u++){0<u&&0>x[u]*w[u]&&G.push(b[u]);H=b[u+1]-b[u];v=w[u];L=x[u+1];E=C[u]/H;l=D[u+1]/H;H=E-l+3*(v-L);S=H*H+12*l*v;H=l+3*v+2*E-3*L;v=3*(l+E+2*(v-L));0>=S?(E=H/v,L=E>b[u]&&E<b[u+1]?[b[u],E,b[u+1]]:[b[u],b[u+
1]]):(E=(H-ea(S))/v,O=(H+ea(S))/v,L=[b[u]],E>b[u]&&E<b[u+1]&&L.push(E),O>b[u]&&O<b[u+1]&&L.push(O),L.push(b[u+1]));S=L[0];E=this._at(S,u);for(v=0;v<L.length-1;v++)if(Y=L[v+1],O=this._at(Y,u),0===E)G.push(S),S=Y,E=O;else if(0===O||0<E*O)S=Y,E=O;else{for(var fa=0;;){l=(E*Y-O*S)/(E-O);if(l<=S||l>=Y)break;H=this._at(l,u);if(0<H*O)Y=l,O=H,-1===fa&&(E*=.5),fa=-1;else if(0<H*E)S=l,E=H,1===fa&&(O*=.5),fa=1;else break}G.push(l);S=L[v+1];E=this._at(S,u)}0===O&&G.push(Y)}a[m]=G}return"number"===typeof this.yl[0]?
a[0]:a};
numeric.spline=function(a,b,d,c){var g=a.length,e=[],k=[],q=[],m,u=numeric.sub,v=numeric.mul,w=numeric.add;for(m=g-2;0<=m;m--)k[m]=a[m+1]-a[m],q[m]=u(b[m+1],b[m]);if("string"===typeof d||"string"===typeof c)d=c="periodic";u=[[],[],[]];switch(typeof d){case "undefined":e[0]=v(3/(k[0]*k[0]),q[0]);u[0].push(0,0);u[1].push(0,1);u[2].push(2/k[0],1/k[0]);break;case "string":e[0]=w(v(3/(k[g-2]*k[g-2]),q[g-2]),v(3/(k[0]*k[0]),q[0]));u[0].push(0,0,0);u[1].push(g-2,0,1);u[2].push(1/k[g-2],2/k[g-2]+2/k[0],1/
k[0]);break;default:e[0]=d,u[0].push(0),u[1].push(0),u[2].push(1)}for(m=1;m<g-1;m++)e[m]=w(v(3/(k[m-1]*k[m-1]),q[m-1]),v(3/(k[m]*k[m]),q[m])),u[0].push(m,m,m),u[1].push(m-1,m,m+1),u[2].push(1/k[m-1],2/k[m-1]+2/k[m],1/k[m]);switch(typeof c){case "undefined":e[g-1]=v(3/(k[g-2]*k[g-2]),q[g-2]);u[0].push(g-1,g-1);u[1].push(g-2,g-1);u[2].push(1/k[g-2],2/k[g-2]);break;case "string":u[1][u[1].length-1]=0;break;default:e[g-1]=c,u[0].push(g-1),u[1].push(g-1),u[2].push(1)}e="number"!==typeof e[0]?numeric.transpose(e):
[e];c=Array(e.length);if("string"===typeof d)for(m=c.length-1;-1!==m;--m)c[m]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(u)),e[m]),c[m][g-1]=c[m][0];else for(m=c.length-1;-1!==m;--m)c[m]=numeric.cLUsolve(numeric.cLU(u),e[m]);c="number"===typeof b[0]?c[0]:numeric.transpose(c);return new numeric.Spline(a,b,b,c,c)};
numeric.fftpow2=function fftpow2(b,d){var c=b.length;if(1!==c){var g=Math.cos,e=Math.sin,k,q,m=Array(c/2),u=Array(c/2),v=Array(c/2),w=Array(c/2);q=c/2;for(k=c-1;-1!==k;--k)--q,v[q]=b[k],w[q]=d[k],--k,m[q]=b[k],u[q]=d[k];fftpow2(m,u);fftpow2(v,w);q=c/2;var x,C=-6.283185307179586/c,D;for(k=c-1;-1!==k;--k)--q,-1===q&&(q=c/2-1),x=C*k,D=g(x),x=e(x),b[k]=m[q]+D*v[q]-x*w[q],d[k]=u[q]+D*w[q]+x*v[q]}};
numeric._ifftpow2=function _ifftpow2(b,d){var c=b.length;if(1!==c){var g=Math.cos,e=Math.sin,k,q,m=Array(c/2),u=Array(c/2),v=Array(c/2),w=Array(c/2);q=c/2;for(k=c-1;-1!==k;--k)--q,v[q]=b[k],w[q]=d[k],--k,m[q]=b[k],u[q]=d[k];_ifftpow2(m,u);_ifftpow2(v,w);q=c/2;var x,C=6.283185307179586/c,D;for(k=c-1;-1!==k;--k)--q,-1===q&&(q=c/2-1),x=C*k,D=g(x),x=e(x),b[k]=m[q]+D*v[q]-x*w[q],d[k]=u[q]+D*w[q]+x*v[q]}};numeric.ifftpow2=function(a,b){numeric._ifftpow2(a,b);numeric.diveq(a,a.length);numeric.diveq(b,b.length)};
numeric.convpow2=function(a,b,d,c){numeric.fftpow2(a,b);numeric.fftpow2(d,c);var g,e,k,q,m;for(g=a.length-1;-1!==g;--g)e=a[g],q=b[g],k=d[g],m=c[g],a[g]=e*k-q*m,b[g]=e*m+q*k;numeric.ifftpow2(a,b)};
numeric.T.prototype.fft=function(){var a=this.x,b=this.y,d=a.length,c=Math.log,g=c(2),c=Math.ceil(c(2*d-1)/g),e=Math.pow(2,c),c=numeric.rep([e],0),g=numeric.rep([e],0),k=Math.cos,q=Math.sin,m,u=-3.141592653589793/d,v=numeric.rep([e],0),w=numeric.rep([e],0);for(m=0;m<d;m++)v[m]=a[m];if("undefined"!==typeof b)for(m=0;m<d;m++)w[m]=b[m];for(m=c[0]=1;m<=e/2;m++)a=u*m*m,c[m]=k(a),g[m]=q(a),c[e-m]=k(a),g[e-m]=q(a);a=new numeric.T(v,w);b=new numeric.T(c,g);a=a.mul(b);numeric.convpow2(a.x,a.y,numeric.clone(b.x),
numeric.neg(b.y));a=a.mul(b);a.x.length=d;a.y.length=d;return a};
numeric.T.prototype.ifft=function(){var a=this.x,b=this.y,d=a.length,c=Math.log,g=c(2),c=Math.ceil(c(2*d-1)/g),e=Math.pow(2,c),c=numeric.rep([e],0),g=numeric.rep([e],0),k=Math.cos,q=Math.sin,m,u=3.141592653589793/d,v=numeric.rep([e],0),w=numeric.rep([e],0);for(m=0;m<d;m++)v[m]=a[m];if("undefined"!==typeof b)for(m=0;m<d;m++)w[m]=b[m];for(m=c[0]=1;m<=e/2;m++)a=u*m*m,c[m]=k(a),g[m]=q(a),c[e-m]=k(a),g[e-m]=q(a);a=new numeric.T(v,w);b=new numeric.T(c,g);a=a.mul(b);numeric.convpow2(a.x,a.y,numeric.clone(b.x),
numeric.neg(b.y));a=a.mul(b);a.x.length=d;a.y.length=d;return a.div(d)};
numeric.gradient=function(a,b){var d=b.length,c=a(b);if(isNaN(c))throw Error("gradient: f(x) is a NaN!");var g=Math.max,e,k=numeric.clone(b),q,m,u=Array(d),v,g=Math.max,w=Math.abs,x=Math.min,C,D,G,E=0,l;for(e=0;e<d;e++)for(var L=g(1E-6*c,1E-8);;){++E;if(20<E)throw Error("Numerical gradient fails");k[e]=b[e]+L;q=a(k);k[e]=b[e]-L;m=a(k);k[e]=b[e];if(isNaN(q)||isNaN(m))L/=16;else if(u[e]=(q-m)/(2*L),C=b[e]-L,D=b[e],G=b[e]+L,v=(q-c)/L,l=(c-m)/L,q=g(w(u[e]),w(c),w(q),w(m),w(C),w(D),w(G),1E-8),v=x(g(w(v-
u[e]),w(l-u[e]),w(v-l))/q,L/q),.001<v)L/=16;else break}return u};
numeric.uncmin=function(a,b,d,c,g,e,k){var q=numeric.gradient;"undefined"===typeof k&&(k={});"undefined"===typeof d&&(d=1E-8);"undefined"===typeof c&&(c=function(l){return q(a,l)});"undefined"===typeof g&&(g=1E3);b=numeric.clone(b);var m=b.length,u=a(b),v,w;if(isNaN(u))throw Error("uncmin: f(x0) is a NaN!");var x=Math.max,C=numeric.norm2;d=x(d,numeric.epsilon);var D,G;k=k.Hinv||numeric.identity(m);var m=numeric.dot,x=numeric.sub,E=numeric.add,l=numeric.tensor,L=numeric.div,H=numeric.mul,S=numeric.all,
O=numeric.isFinite,Y=numeric.neg,ea=0,fa,z,Q,U,W="";for(G=c(b);ea<g;){if("function"===typeof e&&e(ea,b,u,G,k)){W="Callback returned true";break}if(!S(O(G))){W="Gradient has Infinity or NaN";break}D=Y(m(k,G));if(!S(O(D))){W="Search direction has Infinity or NaN";break}U=C(D);if(U<d){W="Newton step smaller than tol";break}Q=1;w=m(G,D);for(z=b;ea<g&&!(Q*U<d);)if(fa=H(D,Q),z=E(b,fa),v=a(z),v-u>=.1*Q*w||isNaN(v))Q*=.5,++ea;else break;if(Q*U<d){W="Line search step size smaller than tol";break}if(ea===g){W=
"maxit reached during line search";break}w=c(z);b=x(w,G);G=m(b,fa);u=m(k,b);k=x(E(k,H((G+m(b,u))/(G*G),l(fa,fa))),L(E(l(u,fa),l(fa,u)),G));b=z;u=v;G=w;++ea}return{solution:b,f:u,gradient:G,invHessian:k,iterations:ea,message:W}};numeric.Dopri=function(a,b,d,c,g,e,k){this.x=a;this.y=b;this.f=d;this.ymid=c;this.iterations=g;this.events=k;this.message=e};
numeric.Dopri.prototype._at=function(a,b){function d(a){return a*a}var c=this.x,g=this.y,e=this.f,k=this.ymid,q,m,u,v=numeric.add,w=numeric.mul,x=numeric.sub,C;q=c[b];m=c[b+1];c=g[b];g=g[b+1];u=q+.5*(m-q);k=k[b];C=x(e[b],w(c,1/(q-u)+2/(q-m)));e=x(e[b+1],w(g,1/(m-u)+2/(m-q)));q=[d(a-m)*(a-u)/d(q-m)/(q-u),d(a-q)*d(a-m)/d(q-u)/d(m-u),d(a-q)*(a-u)/d(m-q)/(m-u),(a-q)*d(a-m)*(a-u)/d(q-m)/(q-u),(a-m)*d(a-q)*(a-u)/d(q-m)/(m-u)];return v(v(v(v(w(c,q[0]),w(k,q[1])),w(g,q[2])),w(C,q[3])),w(e,q[4]))};
numeric.Dopri.prototype.at=function(a){var b,d,c,g=Math.floor;if("number"!==typeof a){b=a.length;d=Array(b);for(--b;-1!==b;--b)d[b]=this.at(a[b]);return d}var e=this.x;b=0;for(d=e.length-1;1<d-b;)c=g(.5*(b+d)),e[c]<=a?b=c:d=c;return this._at(a,b)};
numeric.dopri=function(a,b,d,c,g,e,k){"undefined"===typeof g&&(g=1E-6);"undefined"===typeof e&&(e=1E3);var q=[a],m=[d],u=[c(a,d)],v,w,x,C,D,G,E=[],l=[.075,.225],L=[44/45,-56/15,32/9],H=[19372/6561,-25360/2187,64448/6561,-212/729],S=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],O=[35/384,0,500/1113,125/192,-2187/6784,11/84],Y=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],ea=[.2,.3,.8,8/9,1,1],fa=[-71/57600,0,71/16695,-71/
1920,17253/339200,-22/525,.025],z=0,Q,U=(b-a)/10,W=0,Z=numeric.add,T=numeric.mul,sa=Math.min,f=Math.abs,t=numeric.norminf,V=Math.pow,na=numeric.any,ma=numeric.lt,ha=numeric.and,aa,ta,pa=new numeric.Dopri(q,m,u,E,-1,"");for("function"===typeof k&&(aa=k(a,d));a<b&&W<e;)if(++W,a+U>b&&(U=b-a),v=c(a+ea[0]*U,Z(d,T(.2*U,u[z]))),w=c(a+ea[1]*U,Z(Z(d,T(l[0]*U,u[z])),T(l[1]*U,v))),x=c(a+ea[2]*U,Z(Z(Z(d,T(L[0]*U,u[z])),T(L[1]*U,v)),T(L[2]*U,w))),C=c(a+ea[3]*U,Z(Z(Z(Z(d,T(H[0]*U,u[z])),T(H[1]*U,v)),T(H[2]*U,w)),
T(H[3]*U,x))),D=c(a+ea[4]*U,Z(Z(Z(Z(Z(d,T(S[0]*U,u[z])),T(S[1]*U,v)),T(S[2]*U,w)),T(S[3]*U,x)),T(S[4]*U,C))),v=Z(Z(Z(Z(Z(d,T(u[z],U*O[0])),T(w,U*O[2])),T(x,U*O[3])),T(C,U*O[4])),T(D,U*O[5])),G=c(a+U,v),Q=Z(Z(Z(Z(Z(T(u[z],U*fa[0]),T(w,U*fa[2])),T(x,U*fa[3])),T(C,U*fa[4])),T(D,U*fa[5])),T(G,U*fa[6])),Q="number"===typeof Q?f(Q):t(Q),Q>g){if(U=.2*U*V(g/Q,.25),a+U===a){pa.msg="Step size became too small";break}}else{E[z]=Z(Z(Z(Z(Z(Z(d,T(u[z],U*Y[0])),T(w,U*Y[2])),T(x,U*Y[3])),T(C,U*Y[4])),T(D,U*Y[5])),
T(G,U*Y[6]));++z;q[z]=a+U;m[z]=v;u[z]=G;if("function"===typeof k){var ja;w=a;x=a+.5*U;ta=k(x,E[z-1]);d=ha(ma(aa,0),ma(0,ta));na(d)||(w=x,x=a+U,aa=ta,ta=k(x,v),d=ha(ma(aa,0),ma(0,ta)));if(na(d)){g=0;for(q=e=1;;){if("number"===typeof aa)b=(q*ta*w-e*aa*x)/(q*ta-e*aa);else for(b=x,m=aa.length-1;-1!==m;--m)0>aa[m]&&0<ta[m]&&(b=sa(b,(q*ta[m]*w-e*aa[m]*x)/(q*ta[m]-e*aa[m])));if(b<=w||b>=x)break;ja=pa._at(b,z-1);u=k(b,ja);m=ha(ma(aa,0),ma(0,u));na(m)?(x=b,ta=u,d=m,q=1,e=-1===g?.5*e:1,g=-1):(w=b,aa=u,e=1,
q=1===g?.5*q:1,g=1)}v=pa._at(.5*(a+b),z-1);pa.f[z]=c(b,ja);pa.x[z]=b;pa.y[z]=ja;pa.ymid[z-1]=v;pa.events=d;pa.iterations=W;return pa}}a+=U;d=v;aa=ta;U=sa(.8*U*V(g/Q,.25),4*U)}pa.iterations=W;return pa};
numeric.LU=function(a,b){var d=Math.abs,c,g,e,k,q,m,u=a.length,v=u-1,w=Array(u);b||(a=numeric.clone(a));for(e=0;e<u;++e){q=e;k=a[e];m=d(k[e]);for(g=e+1;g<u;++g)c=d(a[g][e]),m<c&&(m=c,q=g);w[e]=q;q!=e&&(a[e]=a[q],a[q]=k,k=a[e]);g=k[e];for(c=e+1;c<u;++c)a[c][e]/=g;for(c=e+1;c<u;++c){q=a[c];for(g=e+1;g<v;++g)q[g]-=q[e]*k[g],++g,q[g]-=q[e]*k[g];g===v&&(q[g]-=q[e]*k[g])}}return{LU:a,P:w}};
numeric.LUsolve=function(a,b){var d,c,g=a.LU,e=g.length,k=numeric.clone(b),q=a.P,m;for(d=e-1;-1!==d;--d)k[d]=b[d];for(d=0;d<e;++d)for(c=q[d],q[d]!==d&&(m=k[d],k[d]=k[c],k[c]=m),m=g[d],c=0;c<d;++c)k[d]-=k[c]*m[c];for(d=e-1;0<=d;--d){m=g[d];for(c=d+1;c<e;++c)k[d]-=k[c]*m[c];k[d]/=m[d]}return k};numeric.solve=function(a,b,d){return numeric.LUsolve(numeric.LU(a,d),b)};
numeric.echelonize=function(a){var b=numeric.dim(a),d=b[0],b=b[1],c=numeric.identity(d),g=Array(d),e,k,q,m,u,v,w,x,C=Math.abs,D=numeric.diveq;a=numeric.clone(a);for(e=0;e<d;++e){q=0;u=a[e];v=c[e];for(k=1;k<b;++k)C(u[q])<C(u[k])&&(q=k);g[e]=q;D(v,u[q]);D(u,u[q]);for(k=0;k<d;++k)if(k!==e){w=a[k];x=w[q];for(m=b-1;-1!==m;--m)w[m]-=u[m]*x;w=c[k];for(m=d-1;-1!==m;--m)w[m]-=v[m]*x}}return{I:c,A:a,P:g}};
numeric.__solveLP=function(a,b,d,c,g,e,k){var q=numeric.sum,m=numeric.mul,u=numeric.sub,v=numeric.dot,w=numeric.div,x=numeric.add,C=a.length,D=d.length,G,E=!1,l=1;numeric.transpose(b);var L=numeric.transpose,H=Math.sqrt,S=Math.abs,O=Math.min,Y=numeric.all,ea=numeric.gt,fa=Array(C),z=Array(D);numeric.rep([D],1);var Q=numeric.solve,U=u(d,v(b,e)),W,Z=v(a,a);for(W=0;W<g;++W){var T;for(T=D-1;-1!==T;--T)z[T]=w(b[T],U[T]);G=L(z);for(T=C-1;-1!==T;--T)fa[T]=q(G[T]);l=.25*S(Z/v(a,fa));T=100*H(Z/v(fa,fa));if(!isFinite(l)||
l>T)l=T;E=x(a,m(l,fa));G=v(G,z);for(T=C-1;-1!==T;--T)G[T][T]+=1;G=Q(G,w(E,l),!0);var U=w(U,v(b,G)),sa=1;for(T=D-1;-1!==T;--T)0>U[T]&&(sa=O(sa,-.999*U[T]));G=u(e,m(G,sa));U=u(d,v(b,G));if(!Y(ea(U,0)))return{solution:e,message:"",iterations:W};e=G;if(l<c)return{solution:G,message:"",iterations:W};if(k)for(l=v(a,E),sa=v(b,E),E=!0,T=D-1;-1!==T;--T){if(0>l*sa[T]){E=!1;break}}else E=0<=e[C-1]?!1:!0;if(E)return{solution:G,message:"Unbounded",iterations:W}}return{solution:e,message:"maximum iteration count exceeded",
iterations:W}};
numeric._solveLP=function(a,b,d,c,g){var e=a.length,k=d.length,q=numeric.sub,m=numeric.dot,u=numeric.rep([e],0).concat([1]),k=numeric.rep([k,1],-1),v=numeric.blockMatrix([[b,k]]),k=numeric.rep([e],0).concat(Math.max(0,numeric.sup(numeric.neg(d)))+1),u=numeric.__solveLP(u,v,d,c,g,k,!1),k=numeric.clone(u.solution);k.length=e;if(0>numeric.inf(q(d,m(b,k))))return{solution:NaN,message:"Infeasible",iterations:u.iterations};a=numeric.__solveLP(a,b,d,c,g-u.iterations,k,!0);a.iterations+=u.iterations;return a};
numeric.solveLP=function(a,b,d,c,g,e,k){"undefined"===typeof k&&(k=1E3);"undefined"===typeof e&&(e=numeric.epsilon);if("undefined"===typeof c)return numeric._solveLP(a,b,d,e,k);var q=c.length,m=c[0].length,u=b.length,v=numeric.echelonize(c),w=numeric.rep([m],0),x=v.P,C=[],D;for(D=x.length-1;-1!==D;--D)w[x[D]]=1;for(D=m-1;-1!==D;--D)0===w[D]&&C.push(D);D=numeric.getRange;q=numeric.linspace(0,q-1);u=numeric.linspace(0,u-1);c=D(c,q,C);q=D(b,u,x);D=D(b,u,C);b=numeric.dot;u=numeric.sub;m=b(q,v.I);q=u(D,
b(m,c));d=u(d,b(m,g));m=Array(x.length);w=Array(C.length);for(D=x.length-1;-1!==D;--D)m[D]=a[x[D]];for(D=C.length-1;-1!==D;--D)w[D]=a[C[D]];D=u(w,b(m,b(v.I,c)));e=numeric._solveLP(D,q,d,e,k);k=e.solution;if(k!==k)return e;g=b(v.I,u(g,b(c,k)));a=Array(a.length);for(D=x.length-1;-1!==D;--D)a[x[D]]=g[D];for(D=C.length-1;-1!==D;--D)a[C[D]]=k[D];return{solution:a,message:e.message,iterations:e.iterations}};
numeric.MPStoLP=function(a){function b(l){throw Error("MPStoLP: "+l+"\nLine "+e+": "+a[e]+"\nCurrent state: "+c[d]+"\n");}a instanceof String&&a.split("\n");var d=0,c="Initial state;NAME;ROWS;COLUMNS;RHS;BOUNDS;ENDATA".split(";"),g=a.length,e,k,q,m=0,u={},v=[],w=0,x={},C=0,D,G=[],E=[],l=[];for(e=0;e<g;++e){q=a[e];var L=q.match(/\S*/g),H=[];for(k=0;k<L.length;++k)""!==L[k]&&H.push(L[k]);if(0!==H.length){for(k=0;k<c.length&&q.substr(0,c[k].length)!==c[k];++k);if(k<c.length){if(d=k,1===k&&(D=H[1]),6===
k)return{name:D,c:G,A:numeric.transpose(E),b:l,rows:u,vars:x}}else switch(d){case 0:case 1:b("Unexpected line");case 2:switch(H[0]){case "N":0===m?m=H[1]:b("Two or more N rows");break;case "L":u[H[1]]=w;v[w]=1;l[w]=0;++w;break;case "G":u[H[1]]=w;v[w]=-1;l[w]=0;++w;break;case "E":u[H[1]]=w;v[w]=0;l[w]=0;++w;break;default:b("Parse error "+numeric.prettyPrint(H))}break;case 3:x.hasOwnProperty(H[0])||(x[H[0]]=C,G[C]=0,E[C]=numeric.rep([w],0),++C);q=x[H[0]];for(k=1;k<H.length;k+=2)H[k]===m?G[q]=parseFloat(H[k+
1]):(L=u[H[k]],E[q][L]=(0>v[L]?-1:1)*parseFloat(H[k+1]));break;case 4:for(k=1;k<H.length;k+=2)l[u[H[k]]]=(0>v[u[H[k]]]?-1:1)*parseFloat(H[k+1]);break;case 6:b("Internal error")}}}b("Reached end of file without ENDATA")};numeric.seedrandom={pow:Math.pow,random:Math.random};
(function(a,b,d,c,g,e,k){function q(a){var b,c,e=this,k=a.length,g=0,m=e.i=e.j=e.m=0;e.S=[];e.c=[];for(k||(a=[k++]);g<d;)e.S[g]=g++;for(g=0;g<d;g++)b=e.S[g],m=m+b+a[g%k]&d-1,c=e.S[m],e.S[g]=c,e.S[m]=b;e.g=function(a){var b=e.S,c=e.i+1&d-1,k=b[c],g=e.j+k&d-1,m=b[g];b[c]=m;b[g]=k;for(var q=b[k+m&d-1];--a;)c=c+1&d-1,k=b[c],g=g+k&d-1,m=b[g],b[c]=m,b[g]=k,q=q*d+b[k+m&d-1];e.i=c;e.j=g;return q};e.g(d)}function m(a,b,d,c,e){d=[];e=typeof a;if(b&&"object"==e)for(c in a)if(5>c.indexOf("S"))try{d.push(m(a[c],
b-1))}catch(k){}return d.length?d:a+("string"!=e?"\x00":"")}function u(a,b,c,e){a+="";for(e=c=0;e<a.length;e++){var k=e&d-1,g=(c^=19*b[e&d-1])+a.charCodeAt(e);b[k]=g&d-1}a="";for(e in b)a+=String.fromCharCode(b[e]);return a}b.seedrandom=function(v,w){var x=[],C;v=u(m(w?[v,a]:arguments.length?v:[(new Date).getTime(),a,window],3),x);C=new q(x);u(C.S,a);b.random=function(){for(var a=C.g(c),b=k,m=0;a<g;)a=(a+m)*d,b*=d,m=C.g(1);for(;a>=e;)a/=2,b/=2,m>>>=1;return(a+m)/b};return v};k=b.pow(d,c);g=b.pow(2,
g);e=2*g;u(b.random(),a)})([],numeric.seedrandom,256,6,52);
(function(a){function b(a){if("object"!==typeof a)return a;var d=[],c,e=a.length;for(c=0;c<e;c++)d[c+1]=b(a[c]);return d}function d(a){if("object"!==typeof a)return a;var b=[],c,e=a.length;for(c=1;c<e;c++)b[c-1]=d(a[c]);return b}function c(a,b,d){var c,e,k;for(b=1;b<=d;b+=1){a[b][b]=1/a[b][b];k=-a[b][b];for(c=1;c<b;c+=1)a[c][b]*=k;c=b+1;if(d<c)break;for(e=c;e<=d;e+=1)for(k=a[b][e],a[b][e]=0,c=1;c<=b;c+=1)a[c][e]+=k*a[c][b]}}function g(a,b,d,c){var e,k,g;for(e=1;e<=d;e+=1){g=0;for(b=1;b<e;b+=1)g+=
a[b][e]*c[b];c[e]=(c[e]-g)/a[e][e]}for(k=1;k<=d;k+=1)for(e=d+1-k,c[e]/=a[e][e],g=-c[e],b=1;b<e;b+=1)c[b]+=g*a[b][e]}function e(a,b,c,d){var e,k,g,D,G;for(e=1;e<=c;e+=1){d[1]=e;G=0;k=e-1;if(!(1>k))for(g=1;g<=k;g+=1){D=a[g][e];for(b=1;b<g;b+=1)D-=a[b][e]*a[b][g];D/=a[g][g];a[g][e]=D;G+=D*D}G=a[e][e]-G;if(0>=G)break;a[e][e]=Math.sqrt(G);d[1]=0}}function k(a,b,d,k,w,x,C,D,G,E,l,L,H,S,O,Y){function ea(){for(z=1;z<=k;z+=1){aa=0;for(Q=1;Q<=k;Q+=1)aa+=a[Q][z]*C[Q][ma];O[z]=aa}W=sa;for(z=1;z<=k;z+=1)O[W+z]=
0;for(Q=H+1;Q<=k;Q+=1)for(z=1;z<=k;z+=1)O[W+z]+=a[z][Q]*O[Q];Pa=!0;for(z=H;1<=z;--z){aa=O[z];U=t+z*(z+3)/2;W=U-z;for(Q=z+1;Q<=H;Q+=1)aa-=O[U]*O[f+Q],U+=Q;aa/=O[W];O[f+z]=aa;if(L[z]<l)break;if(0>aa)break;Pa=!1;T=z}if(!Pa)for(ta=O[na+T]/O[f+T],z=1;z<=H&&!(L[z]<l)&&!(0>O[f+z]);z+=1)ha=O[na+z]/O[f+z],ha<ta&&(ta=ha,T=z);aa=0;for(z=sa+1;z<=sa+k;z+=1)aa+=O[z]*O[z];if(Math.abs(aa)<=Ka){if(Pa)return Y[1]=1,999;for(z=1;z<=H;z+=1)O[na+z]-=ta*O[f+z];O[na+H+1]+=ta;return 700}aa=0;for(z=1;z<=k;z+=1)aa+=O[sa+z]*
C[z][ma];pa=-O[V+ma]/aa;Va=!0;!Pa&&ta<pa&&(pa=ta,Va=!1);for(z=1;z<=k;z+=1)w[z]+=pa*O[sa+z],Math.abs(w[z])<Ka&&(w[z]=0);x[1]+=pa*aa*(pa/2+O[na+H+1]);for(z=1;z<=H;z+=1)O[na+z]-=pa*O[f+z];O[na+H+1]+=pa;if(Va){H+=1;L[H]=ma;U=t+(H-1)*H/2+1;for(z=1;z<=H-1;z+=1)O[U]=O[z],U+=1;if(H===k)O[U]=O[k];else{for(z=k;z>=H+1&&0!==O[z];--z){ja=Math.max(Math.abs(O[z-1]),Math.abs(O[z]));va=Math.min(Math.abs(O[z-1]),Math.abs(O[z]));ha=0<=O[z-1]?Math.abs(ja*Math.sqrt(1+va*va/(ja*ja))):-Math.abs(ja*Math.sqrt(1+va*va/(ja*
ja)));ja=O[z-1]/ha;va=O[z]/ha;if(1===ja)break;if(0===ja)for(O[z-1]=va*ha,Q=1;Q<=k;Q+=1)ha=a[Q][z-1],a[Q][z-1]=a[Q][z],a[Q][z]=ha;else for(O[z-1]=ha,Qa=va/(1+ja),Q=1;Q<=k;Q+=1)ha=ja*a[Q][z-1]+va*a[Q][z],a[Q][z]=Qa*(a[Q][z-1]+ha)-a[Q][z],a[Q][z-1]=ha}O[U]=O[H]}}else{aa=-D[ma];for(Q=1;Q<=k;Q+=1)aa+=w[Q]*C[Q][ma];if(ma>l)O[V+ma]=aa;else if(O[V+ma]=-Math.abs(aa),0<aa){for(Q=1;Q<=k;Q+=1)C[Q][ma]=-C[Q][ma];D[ma]=-D[ma]}return 700}return 0}function fa(){U=t+T*(T+1)/2+1;W=U+T;if(0===O[W])return 798;ja=Math.max(Math.abs(O[W-
1]),Math.abs(O[W]));va=Math.min(Math.abs(O[W-1]),Math.abs(O[W]));ha=0<=O[W-1]?Math.abs(ja*Math.sqrt(1+va*va/(ja*ja))):-Math.abs(ja*Math.sqrt(1+va*va/(ja*ja)));ja=O[W-1]/ha;va=O[W]/ha;if(1===ja)return 798;if(0===ja){for(z=T+1;z<=H;z+=1)ha=O[W-1],O[W-1]=O[W],O[W]=ha,W+=z;for(z=1;z<=k;z+=1)ha=a[z][T],a[z][T]=a[z][T+1],a[z][T+1]=ha}else{Qa=va/(1+ja);for(z=T+1;z<=H;z+=1)ha=ja*O[W-1]+va*O[W],O[W]=Qa*(O[W-1]+ha)-O[W],O[W-1]=ha,W+=z;for(z=1;z<=k;z+=1)ha=ja*a[z][T]+va*a[z][T+1],a[z][T+1]=Qa*(a[z][T]+ha)-a[z][T+
1],a[z][T]=ha}return 0}var z,Q,U,W,Z,T,sa,f,t,V,na,ma,ha,aa,ta,pa,ja,va,Qa,Pa,Va,Ka,I;G=Math.min(k,E);U=2*k+G*(G+5)/2+2*E+1;Ka=1E-60;do Ka+=Ka,Z=1+.1*Ka,I=1+.2*Ka;while(1>=Z||1>=I);for(z=1;z<=k;z+=1)O[z]=b[z];for(z=k+1;z<=U;z+=1)O[z]=0;for(z=1;z<=E;z+=1)L[z]=0;Z=[];if(0===Y[1]){e(a,d,k,Z);if(0!==Z[1]){Y[1]=2;return}g(a,d,k,b);c(a,d,k)}else{for(Q=1;Q<=k;Q+=1)for(w[Q]=0,z=1;z<=Q;z+=1)w[Q]+=a[z][Q]*b[z];for(Q=1;Q<=k;Q+=1)for(b[Q]=0,z=Q;z<=k;z+=1)b[Q]+=a[Q][z]*w[z]}x[1]=0;for(Q=1;Q<=k;Q+=1)for(w[Q]=b[Q],
x[1]+=O[Q]*w[Q],O[Q]=0,z=Q+1;z<=k;z+=1)a[z][Q]=0;x[1]=-x[1]/2;Y[1]=0;sa=k;f=sa+k;na=f+G;t=na+G+1;V=t+G*(G+1)/2;b=V+E;for(z=1;z<=E;z+=1){aa=0;for(Q=1;Q<=k;Q+=1)aa+=C[Q][z]*C[Q][z];O[b+z]=Math.sqrt(aa)}H=0;S[1]=0;for(d=S[2]=0;;){S[1]+=1;U=V;for(z=1;z<=E;z+=1){U+=1;aa=-D[z];for(Q=1;Q<=k;Q+=1)aa+=C[Q][z]*w[Q];Math.abs(aa)<Ka&&(aa=0);if(z>l)O[U]=aa;else if(O[U]=-Math.abs(aa),0<aa){for(Q=1;Q<=k;Q+=1)C[Q][z]=-C[Q][z];D[z]=-D[z]}}for(z=1;z<=H;z+=1)O[V+L[z]]=0;ha=ma=0;for(z=1;z<=E;z+=1)O[V+z]<ha*O[b+z]&&(ma=
z,ha=O[V+z]/O[b+z]);d=0===ma?999:0;if(999===d)break;for(;;){d=ea();if(0===d)break;if(999===d)return;if(700===d){if(T!==H)for(;;){fa();W=U-T;for(z=1;z<=T;z+=1)O[W]=O[U],U+=1,W+=1;O[na+T]=O[na+T+1];L[T]=L[T+1];T+=1;d=T<H?797:0;if(797!==d)break}O[na+H]=O[na+H+1];O[na+H+1]=0;L[H]=0;--H;S[2]+=1}}}}a.solveQP=function(a,c,e,g,w,x){a=b(a);c=b(c);e=b(e);var C,D,G,E,l=[],L=[],H=[],S=[],O=[];w=w||0;x=x?b(x):[void 0,0];g=g?b(g):[];D=a.length-1;G=e[1].length-1;if(!g)for(C=1;C<=G;C+=1)g[C]=0;for(C=1;C<=G;C+=1)L[C]=
0;E=Math.min(D,G);for(C=1;C<=D;C+=1)H[C]=0;l[1]=0;for(C=1;C<=2*D+E*(E+5)/2+2*G+1;C+=1)S[C]=0;for(C=1;2>=C;C+=1)O[C]=0;k(a,c,D,D,H,l,e,g,D,G,w,L,0,O,S,x);a="";1===x[1]&&(a="constraints are inconsistent, no solution!");2===x[1]&&(a="matrix D in quadratic function is not positive definite!");return{solution:d(H),value:d(l),unconstrained_solution:d(c),iterations:d(O),iact:d(L),message:a}}})(numeric);
numeric.svd=function(a){function b(a,b){a=Math.abs(a);b=Math.abs(b);return a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var d;d=numeric.epsilon;var c=1E-64/d,g=0,e=0,k=0,q=0,m=0;a=numeric.clone(a);var u=a.length,v=a[0].length;if(u<v)throw"Need more rows than columns";for(var w=Array(v),x=Array(v),e=0;e<v;e++)w[e]=x[e]=0;for(var C=numeric.rep([v,v],0),D=0,G=0,E=0,l=0,L=0,H=0,S=0,e=0;e<v;e++){w[e]=G;S=0;m=e+1;for(k=e;k<u;k++)S+=a[k][e]*a[k][e];if(S<=c)G=0;else for(D=a[e][e],G=Math.sqrt(S),
0<=D&&(G=-G),E=D*G-S,a[e][e]=D-G,k=m;k<v;k++){S=0;for(q=e;q<u;q++)S+=a[q][e]*a[q][k];D=S/E;for(q=e;q<u;q++)a[q][k]+=D*a[q][e]}x[e]=G;S=0;for(k=m;k<v;k++)S+=a[e][k]*a[e][k];if(S<=c)G=0;else{D=a[e][e+1];G=Math.sqrt(S);0<=D&&(G=-G);E=D*G-S;a[e][e+1]=D-G;for(k=m;k<v;k++)w[k]=a[e][k]/E;for(k=m;k<u;k++){S=0;for(q=m;q<v;q++)S+=a[k][q]*a[e][q];for(q=m;q<v;q++)a[k][q]+=S*w[q]}}L=Math.abs(x[e])+Math.abs(w[e]);L>l&&(l=L)}for(e=v-1;-1!=e;e+=-1){if(0!=G){E=G*a[e][e+1];for(k=m;k<v;k++)C[k][e]=a[e][k]/E;for(k=m;k<
v;k++){S=0;for(q=m;q<v;q++)S+=a[e][q]*C[q][k];for(q=m;q<v;q++)C[q][k]+=S*C[q][e]}}for(k=m;k<v;k++)C[e][k]=0,C[k][e]=0;C[e][e]=1;G=w[e];m=e}for(e=v-1;-1!=e;e+=-1){m=e+1;G=x[e];for(k=m;k<v;k++)a[e][k]=0;if(0!=G){E=a[e][e]*G;for(k=m;k<v;k++){S=0;for(q=m;q<u;q++)S+=a[q][e]*a[q][k];D=S/E;for(q=e;q<u;q++)a[q][k]+=D*a[q][e]}for(k=e;k<u;k++)a[k][e]/=G}else for(k=e;k<u;k++)a[k][e]=0;a[e][e]+=1}d*=l;for(q=v-1;-1!=q;q+=-1)for(c=0;50>c;c++){e=!1;for(m=q;-1!=m;m+=-1){if(Math.abs(w[m])<=d){e=!0;break}if(Math.abs(x[m-
1])<=d)break}if(!e)for(g=0,S=1,l=m-1,e=m;e<q+1;e++){D=S*w[e];w[e]*=g;if(Math.abs(D)<=d)break;G=x[e];E=b(D,G);x[e]=E;g=G/E;S=-D/E;for(k=0;k<u;k++)L=a[k][l],H=a[k][e],a[k][l]=L*g+H*S,a[k][e]=-L*S+H*g}H=x[q];if(m==q){if(0>H)for(x[q]=-H,k=0;k<v;k++)C[k][q]=-C[k][q];break}if(49<=c)throw"Error: no convergence.";l=x[m];L=x[q-1];G=w[q-1];E=w[q];D=((L-H)*(L+H)+(G-E)*(G+E))/(2*E*L);G=b(D,1);D=0>D?((l-H)*(l+H)+E*(L/(D-G)-E))/l:((l-H)*(l+H)+E*(L/(D+G)-E))/l;S=g=1;for(e=m+1;e<q+1;e++){G=w[e];L=x[e];E=S*G;G*=g;
H=b(D,E);w[e-1]=H;g=D/H;S=E/H;D=l*g+G*S;G=-l*S+G*g;E=L*S;L*=g;for(k=0;k<v;k++)l=C[k][e-1],H=C[k][e],C[k][e-1]=l*g+H*S,C[k][e]=-l*S+H*g;H=b(D,E);x[e-1]=H;g=D/H;S=E/H;D=g*G+S*L;l=-S*G+g*L;for(k=0;k<u;k++)L=a[k][e-1],H=a[k][e],a[k][e-1]=L*g+H*S,a[k][e]=-L*S+H*g}w[m]=0;w[q]=D;x[q]=l}for(e=0;e<x.length;e++)x[e]<d&&(x[e]=0);for(e=0;e<v;e++)for(k=e-1;0<=k;k--)if(x[k]<x[e]){g=x[k];x[k]=x[e];x[e]=g;for(q=0;q<a.length;q++)d=a[q][e],a[q][e]=a[q][k],a[q][k]=d;for(q=0;q<C.length;q++)d=C[q][e],C[q][e]=C[q][k],
C[q][k]=d;e=k}return{U:a,S:x,V:C}};
(function(){function a(f,t,a){l.biginteger_used=1;null!=f&&("number"==typeof f&&"undefined"==typeof t?this.fromInt(f):"number"==typeof f?this.fromNumber(f,t,a):null==t&&"string"!=typeof f?this.fromString(f,256):this.fromString(f,t))}function b(){return new a(null)}function d(f,t,a,b,d,c){for(;0<=--c;){var l=t*this[f++]+a[b]+d;d=Math.floor(l/67108864);a[b++]=l&67108863}return d}function c(f,t,a,b,d,c){var l=t&32767;for(t>>=15;0<=--c;){var e=this[f]&32767,k=this[f++]>>15,g=t*e+k*l,e=l*e+((g&32767)<<
15)+a[b]+(d&1073741823);d=(e>>>30)+(g>>>15)+t*k+(d>>>30);a[b++]=e&1073741823}return d}function g(f,t,a,b,d,c){var l=t&16383;for(t>>=14;0<=--c;){var e=this[f]&16383,k=this[f++]>>14,g=t*e+k*l,e=l*e+((g&16383)<<14)+a[b]+d;d=(e>>28)+(g>>14)+t*k;a[b++]=e&268435455}return d}function e(f,t){var a=U[f.charCodeAt(t)];return null==a?-1:a}function k(f){var t=b();t.fromInt(f);return t}function q(f){var t=1,a;0!=(a=f>>>16)&&(f=a,t+=16);0!=(a=f>>8)&&(f=a,t+=8);0!=(a=f>>4)&&(f=a,t+=4);0!=(a=f>>2)&&(f=a,t+=2);0!=
f>>1&&(t+=1);return t}function m(f){this.m=f}function u(f){this.m=f;this.mp=f.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<f.DB-15)-1;this.mt2=2*f.t}function v(f,t){return f&t}function w(f,t){return f|t}function x(f,t){return f^t}function C(f,t){return f&~t}function D(){}function G(f){return f}function E(f){this.r2=b();this.q3=b();a.ONE.dlShiftTo(2*f.t,this.r2);this.mu=this.r2.divide(f);this.m=f}var l={},L=!1;"undefined"!==typeof module&&module.exports?(module.exports=l,L=!0):
"undefined"!==typeof document?window.ClipperLib=l:self.ClipperLib=l;var H;if(L)S="chrome",H="Netscape";else{var S=navigator.userAgent.toString().toLowerCase();H=navigator.appName}var O,Y,ea,fa,z,Q;O=-1!=S.indexOf("chrome")&&-1==S.indexOf("chromium")?1:0;L=-1!=S.indexOf("chromium")?1:0;Y=-1!=S.indexOf("safari")&&-1==S.indexOf("chrome")&&-1==S.indexOf("chromium")?1:0;ea=-1!=S.indexOf("firefox")?1:0;S.indexOf("firefox/17");S.indexOf("firefox/15");S.indexOf("firefox/3");fa=-1!=S.indexOf("opera")?1:0;
S.indexOf("msie 10");S.indexOf("msie 9");z=-1!=S.indexOf("msie 8")?1:0;Q=-1!=S.indexOf("msie 7")?1:0;S=-1!=S.indexOf("msie ")?1:0;l.biginteger_used=null;"Microsoft Internet Explorer"==H?(a.prototype.am=c,H=30):"Netscape"!=H?(a.prototype.am=d,H=26):(a.prototype.am=g,H=28);a.prototype.DB=H;a.prototype.DM=(1<<H)-1;a.prototype.DV=1<<H;a.prototype.FV=Math.pow(2,52);a.prototype.F1=52-H;a.prototype.F2=2*H-52;var U=[],W;H=48;for(W=0;9>=W;++W)U[H++]=W;H=97;for(W=10;36>W;++W)U[H++]=W;H=65;for(W=10;36>W;++W)U[H++]=
W;m.prototype.convert=function(f){return 0>f.s||0<=f.compareTo(this.m)?f.mod(this.m):f};m.prototype.revert=function(f){return f};m.prototype.reduce=function(f){f.divRemTo(this.m,null,f)};m.prototype.mulTo=function(f,t,a){f.multiplyTo(t,a);this.reduce(a)};m.prototype.sqrTo=function(f,t){f.squareTo(t);this.reduce(t)};u.prototype.convert=function(f){var t=b();f.abs().dlShiftTo(this.m.t,t);t.divRemTo(this.m,null,t);0>f.s&&0<t.compareTo(a.ZERO)&&this.m.subTo(t,t);return t};u.prototype.revert=function(f){var t=
b();f.copyTo(t);this.reduce(t);return t};u.prototype.reduce=function(f){for(;f.t<=this.mt2;)f[f.t++]=0;for(var t=0;t<this.m.t;++t){var a=f[t]&32767,b=a*this.mpl+((a*this.mph+(f[t]>>15)*this.mpl&this.um)<<15)&f.DM,a=t+this.m.t;for(f[a]+=this.m.am(0,b,f,t,0,this.m.t);f[a]>=f.DV;)f[a]-=f.DV,f[++a]++}f.clamp();f.drShiftTo(this.m.t,f);0<=f.compareTo(this.m)&&f.subTo(this.m,f)};u.prototype.mulTo=function(f,t,a){f.multiplyTo(t,a);this.reduce(a)};u.prototype.sqrTo=function(f,t){f.squareTo(t);this.reduce(t)};
a.prototype.copyTo=function(f){for(var t=this.t-1;0<=t;--t)f[t]=this[t];f.t=this.t;f.s=this.s};a.prototype.fromInt=function(f){this.t=1;this.s=0>f?-1:0;0<f?this[0]=f:-1>f?this[0]=f+this.DV:this.t=0};a.prototype.fromString=function(f,t){var V;if(16==t)V=4;else if(8==t)V=3;else if(256==t)V=8;else if(2==t)V=1;else if(32==t)V=5;else if(4==t)V=2;else{this.fromRadix(f,t);return}this.s=this.t=0;for(var b=f.length,d=!1,c=0;0<=--b;){var l=8==V?f[b]&255:e(f,b);0>l?"-"==f.charAt(b)&&(d=!0):(d=!1,0==c?this[this.t++]=
l:c+V>this.DB?(this[this.t-1]|=(l&(1<<this.DB-c)-1)<<c,this[this.t++]=l>>this.DB-c):this[this.t-1]|=l<<c,c+=V,c>=this.DB&&(c-=this.DB))}8==V&&0!=(f[0]&128)&&(this.s=-1,0<c&&(this[this.t-1]|=(1<<this.DB-c)-1<<c));this.clamp();d&&a.ZERO.subTo(this,this)};a.prototype.clamp=function(){for(var f=this.s&this.DM;0<this.t&&this[this.t-1]==f;)--this.t};a.prototype.dlShiftTo=function(f,t){var a;for(a=this.t-1;0<=a;--a)t[a+f]=this[a];for(a=f-1;0<=a;--a)t[a]=0;t.t=this.t+f;t.s=this.s};a.prototype.drShiftTo=function(f,
t){for(var a=f;a<this.t;++a)t[a-f]=this[a];t.t=Math.max(this.t-f,0);t.s=this.s};a.prototype.lShiftTo=function(f,t){var a=f%this.DB,b=this.DB-a,d=(1<<b)-1,c=Math.floor(f/this.DB),l=this.s<<a&this.DM,e;for(e=this.t-1;0<=e;--e)t[e+c+1]=this[e]>>b|l,l=(this[e]&d)<<a;for(e=c-1;0<=e;--e)t[e]=0;t[c]=l;t.t=this.t+c+1;t.s=this.s;t.clamp()};a.prototype.rShiftTo=function(f,t){t.s=this.s;var a=Math.floor(f/this.DB);if(a>=this.t)t.t=0;else{var b=f%this.DB,c=this.DB-b,d=(1<<b)-1;t[0]=this[a]>>b;for(var l=a+1;l<
this.t;++l)t[l-a-1]|=(this[l]&d)<<c,t[l-a]=this[l]>>b;0<b&&(t[this.t-a-1]|=(this.s&d)<<c);t.t=this.t-a;t.clamp()}};a.prototype.subTo=function(f,t){for(var a=0,b=0,c=Math.min(f.t,this.t);a<c;)b+=this[a]-f[a],t[a++]=b&this.DM,b>>=this.DB;if(f.t<this.t){for(b-=f.s;a<this.t;)b+=this[a],t[a++]=b&this.DM,b>>=this.DB;b+=this.s}else{for(b+=this.s;a<f.t;)b-=f[a],t[a++]=b&this.DM,b>>=this.DB;b-=f.s}t.s=0>b?-1:0;-1>b?t[a++]=this.DV+b:0<b&&(t[a++]=b);t.t=a;t.clamp()};a.prototype.multiplyTo=function(f,t){var V=
this.abs(),b=f.abs(),c=V.t;for(t.t=c+b.t;0<=--c;)t[c]=0;for(c=0;c<b.t;++c)t[c+V.t]=V.am(0,b[c],t,c,0,V.t);t.s=0;t.clamp();this.s!=f.s&&a.ZERO.subTo(t,t)};a.prototype.squareTo=function(f){for(var t=this.abs(),a=f.t=2*t.t;0<=--a;)f[a]=0;for(a=0;a<t.t-1;++a){var b=t.am(a,t[a],f,2*a,0,1);(f[a+t.t]+=t.am(a+1,2*t[a],f,2*a+1,b,t.t-a-1))>=t.DV&&(f[a+t.t]-=t.DV,f[a+t.t+1]=1)}0<f.t&&(f[f.t-1]+=t.am(a,t[a],f,2*a,0,1));f.s=0;f.clamp()};a.prototype.divRemTo=function(f,t,V){var c=f.abs();if(!(0>=c.t)){var d=this.abs();
if(d.t<c.t)null!=t&&t.fromInt(0),null!=V&&this.copyTo(V);else{null==V&&(V=b());var l=b(),e=this.s;f=f.s;var k=this.DB-q(c[c.t-1]);0<k?(c.lShiftTo(k,l),d.lShiftTo(k,V)):(c.copyTo(l),d.copyTo(V));c=l.t;d=l[c-1];if(0!=d){var g=d*(1<<this.F1)+(1<c?l[c-2]>>this.F2:0),m=this.FV/g,g=(1<<this.F1)/g,u=1<<this.F2,v=V.t,w=v-c,x=null==t?b():t;l.dlShiftTo(w,x);0<=V.compareTo(x)&&(V[V.t++]=1,V.subTo(x,V));a.ONE.dlShiftTo(c,x);for(x.subTo(l,l);l.t<c;)l[l.t++]=0;for(;0<=--w;){var z=V[--v]==d?this.DM:Math.floor(V[v]*
m+(V[v-1]+u)*g);if((V[v]+=l.am(0,z,V,w,0,c))<z)for(l.dlShiftTo(w,x),V.subTo(x,V);V[v]<--z;)V.subTo(x,V)}null!=t&&(V.drShiftTo(c,t),e!=f&&a.ZERO.subTo(t,t));V.t=c;V.clamp();0<k&&V.rShiftTo(k,V);0>e&&a.ZERO.subTo(V,V)}}}};a.prototype.invDigit=function(){if(1>this.t)return 0;var f=this[0];if(0==(f&1))return 0;var t=f&3,t=t*(2-(f&15)*t)&15,t=t*(2-(f&255)*t)&255,t=t*(2-((f&65535)*t&65535))&65535,t=t*(2-f*t%this.DV)%this.DV;return 0<t?this.DV-t:-t};a.prototype.isEven=function(){return 0==(0<this.t?this[0]&
1:this.s)};a.prototype.exp=function(f,t){if(4294967295<f||1>f)return a.ONE;var V=b(),c=b(),d=t.convert(this),l=q(f)-1;for(d.copyTo(V);0<=--l;)if(t.sqrTo(V,c),0<(f&1<<l))t.mulTo(c,d,V);else var e=V,V=c,c=e;return t.revert(V)};a.prototype.toString=function(f){if(0>this.s)return"-"+this.negate().toString(f);if(16==f)f=4;else if(8==f)f=3;else if(2==f)f=1;else if(32==f)f=5;else if(4==f)f=2;else return this.toRadix(f);var t=(1<<f)-1,a,b=!1,c="",d=this.t,l=this.DB-d*this.DB%f;if(0<d--)for(l<this.DB&&0<(a=
this[d]>>l)&&(b=!0,c="0123456789abcdefghijklmnopqrstuvwxyz".charAt(a));0<=d;)l<f?(a=(this[d]&(1<<l)-1)<<f-l,a|=this[--d]>>(l+=this.DB-f)):(a=this[d]>>(l-=f)&t,0>=l&&(l+=this.DB,--d)),0<a&&(b=!0),b&&(c+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(a));return b?c:"0"};a.prototype.negate=function(){var f=b();a.ZERO.subTo(this,f);return f};a.prototype.abs=function(){return 0>this.s?this.negate():this};a.prototype.compareTo=function(f){var t=this.s-f.s;if(0!=t)return t;var a=this.t,t=a-f.t;if(0!=t)return 0>
this.s?-t:t;for(;0<=--a;)if(0!=(t=this[a]-f[a]))return t;return 0};a.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+q(this[this.t-1]^this.s&this.DM)};a.prototype.mod=function(f){var t=b();this.abs().divRemTo(f,null,t);0>this.s&&0<t.compareTo(a.ZERO)&&f.subTo(t,t);return t};a.prototype.modPowInt=function(f,t){var a;a=256>f||t.isEven()?new m(t):new u(t);return this.exp(f,a)};a.ZERO=k(0);a.ONE=k(1);D.prototype.convert=G;D.prototype.revert=G;D.prototype.mulTo=function(f,t,a){f.multiplyTo(t,
a)};D.prototype.sqrTo=function(f,t){f.squareTo(t)};E.prototype.convert=function(f){if(0>f.s||f.t>2*this.m.t)return f.mod(this.m);if(0>f.compareTo(this.m))return f;var t=b();f.copyTo(t);this.reduce(t);return t};E.prototype.revert=function(f){return f};E.prototype.reduce=function(f){f.drShiftTo(this.m.t-1,this.r2);f.t>this.m.t+1&&(f.t=this.m.t+1,f.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>f.compareTo(this.r2);)f.dAddOffset(1,
this.m.t+1);for(f.subTo(this.r2,f);0<=f.compareTo(this.m);)f.subTo(this.m,f)};E.prototype.mulTo=function(f,t,a){f.multiplyTo(t,a);this.reduce(a)};E.prototype.sqrTo=function(f,t){f.squareTo(t);this.reduce(t)};var Z=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,
409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],T=67108864/Z[Z.length-1];a.prototype.chunkSize=function(f){return Math.floor(Math.LN2*this.DB/Math.log(f))};a.prototype.toRadix=function(f){null==
f&&(f=10);if(0==this.signum()||2>f||36<f)return"0";var t=this.chunkSize(f),t=Math.pow(f,t),a=k(t),c=b(),d=b(),l="";for(this.divRemTo(a,c,d);0<c.signum();)l=(t+d.intValue()).toString(f).substr(1)+l,c.divRemTo(a,c,d);return d.intValue().toString(f)+l};a.prototype.fromRadix=function(f,t){this.fromInt(0);null==t&&(t=10);for(var V=this.chunkSize(t),b=Math.pow(t,V),c=!1,d=0,l=0,k=0;k<f.length;++k){var g=e(f,k);0>g?"-"==f.charAt(k)&&0==this.signum()&&(c=!0):(l=t*l+g,++d>=V&&(this.dMultiply(b),this.dAddOffset(l,
0),l=d=0))}0<d&&(this.dMultiply(Math.pow(t,d)),this.dAddOffset(l,0));c&&a.ZERO.subTo(this,this)};a.prototype.fromNumber=function(f,t,V){if("number"==typeof t)if(2>f)this.fromInt(1);else for(this.fromNumber(f,V),this.testBit(f-1)||this.bitwiseTo(a.ONE.shiftLeft(f-1),w,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>f&&this.subTo(a.ONE.shiftLeft(f-1),this);else{V=[];var b=f&7;V.length=(f>>3)+1;t.nextBytes(V);V[0]=0<b?V[0]&(1<<b)-1:0;this.fromString(V,
256)}};a.prototype.bitwiseTo=function(f,t,a){var b,c,d=Math.min(f.t,this.t);for(b=0;b<d;++b)a[b]=t(this[b],f[b]);if(f.t<this.t){c=f.s&this.DM;for(b=d;b<this.t;++b)a[b]=t(this[b],c);a.t=this.t}else{c=this.s&this.DM;for(b=d;b<f.t;++b)a[b]=t(c,f[b]);a.t=f.t}a.s=t(this.s,f.s);a.clamp()};a.prototype.changeBit=function(f,t){var V=a.ONE.shiftLeft(f);this.bitwiseTo(V,t,V);return V};a.prototype.addTo=function(f,t){for(var a=0,b=0,c=Math.min(f.t,this.t);a<c;)b+=this[a]+f[a],t[a++]=b&this.DM,b>>=this.DB;if(f.t<
this.t){for(b+=f.s;a<this.t;)b+=this[a],t[a++]=b&this.DM,b>>=this.DB;b+=this.s}else{for(b+=this.s;a<f.t;)b+=f[a],t[a++]=b&this.DM,b>>=this.DB;b+=f.s}t.s=0>b?-1:0;0<b?t[a++]=b:-1>b&&(t[a++]=this.DV+b);t.t=a;t.clamp()};a.prototype.dMultiply=function(f){this[this.t]=this.am(0,f-1,this,0,0,this.t);++this.t;this.clamp()};a.prototype.dAddOffset=function(f,t){if(0!=f){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=f;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}};a.prototype.multiplyLowerTo=
function(f,t,a){var b=Math.min(this.t+f.t,t);a.s=0;for(a.t=b;0<b;)a[--b]=0;var c;for(c=a.t-this.t;b<c;++b)a[b+this.t]=this.am(0,f[b],a,b,0,this.t);for(c=Math.min(f.t,t);b<c;++b)this.am(0,f[b],a,b,0,t-b);a.clamp()};a.prototype.multiplyUpperTo=function(f,t,a){--t;var b=a.t=this.t+f.t-t;for(a.s=0;0<=--b;)a[b]=0;for(b=Math.max(t-this.t,0);b<f.t;++b)a[this.t+b-t]=this.am(t-b,f[b],a,0,0,this.t+b-t);a.clamp();a.drShiftTo(1,a)};a.prototype.modInt=function(f){if(0>=f)return 0;var t=this.DV%f,a=0>this.s?f-
1:0;if(0<this.t)if(0==t)a=this[0]%f;else for(var b=this.t-1;0<=b;--b)a=(t*a+this[b])%f;return a};a.prototype.millerRabin=function(f){var t=this.subtract(a.ONE),V=t.getLowestSetBit();if(0>=V)return!1;var c=t.shiftRight(V);f=f+1>>1;f>Z.length&&(f=Z.length);for(var d=b(),l=0;l<f;++l){d.fromInt(Z[Math.floor(Math.random()*Z.length)]);var e=d.modPow(c,this);if(0!=e.compareTo(a.ONE)&&0!=e.compareTo(t)){for(var k=1;k++<V&&0!=e.compareTo(t);)if(e=e.modPowInt(2,this),0==e.compareTo(a.ONE))return!1;if(0!=e.compareTo(t))return!1}}return!0};
a.prototype.clone=function(){var f=b();this.copyTo(f);return f};a.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};a.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};a.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};a.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?
0:1};a.prototype.toByteArray=function(){var f=this.t,t=[];t[0]=this.s;var a=this.DB-f*this.DB%8,b,c=0;if(0<f--)for(a<this.DB&&(b=this[f]>>a)!=(this.s&this.DM)>>a&&(t[c++]=b|this.s<<this.DB-a);0<=f;)if(8>a?(b=(this[f]&(1<<a)-1)<<8-a,b|=this[--f]>>(a+=this.DB-8)):(b=this[f]>>(a-=8)&255,0>=a&&(a+=this.DB,--f)),0!=(b&128)&&(b|=-256),0==c&&(this.s&128)!=(b&128)&&++c,0<c||b!=this.s)t[c++]=b;return t};a.prototype.equals=function(f){return 0==this.compareTo(f)};a.prototype.min=function(f){return 0>this.compareTo(f)?
this:f};a.prototype.max=function(f){return 0<this.compareTo(f)?this:f};a.prototype.and=function(f){var t=b();this.bitwiseTo(f,v,t);return t};a.prototype.or=function(f){var t=b();this.bitwiseTo(f,w,t);return t};a.prototype.xor=function(f){var t=b();this.bitwiseTo(f,x,t);return t};a.prototype.andNot=function(f){var t=b();this.bitwiseTo(f,C,t);return t};a.prototype.not=function(){for(var f=b(),t=0;t<this.t;++t)f[t]=this.DM&~this[t];f.t=this.t;f.s=~this.s;return f};a.prototype.shiftLeft=function(f){var t=
b();0>f?this.rShiftTo(-f,t):this.lShiftTo(f,t);return t};a.prototype.shiftRight=function(f){var t=b();0>f?this.lShiftTo(-f,t):this.rShiftTo(f,t);return t};a.prototype.getLowestSetBit=function(){for(var f=0;f<this.t;++f)if(0!=this[f]){var t=f*this.DB,f=this[f];if(0==f)f=-1;else{var a=0;0==(f&65535)&&(f>>=16,a+=16);0==(f&255)&&(f>>=8,a+=8);0==(f&15)&&(f>>=4,a+=4);0==(f&3)&&(f>>=2,a+=2);0==(f&1)&&++a;f=a}return t+f}return 0>this.s?this.t*this.DB:-1};a.prototype.bitCount=function(){for(var f=0,t=this.s&
this.DM,a=0;a<this.t;++a){for(var b=this[a]^t,c=0;0!=b;)b&=b-1,++c;f+=c}return f};a.prototype.testBit=function(f){var t=Math.floor(f/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<f%this.DB)};a.prototype.setBit=function(f){return this.changeBit(f,w)};a.prototype.clearBit=function(f){return this.changeBit(f,C)};a.prototype.flipBit=function(f){return this.changeBit(f,x)};a.prototype.add=function(f){var t=b();this.addTo(f,t);return t};a.prototype.subtract=function(f){var t=b();this.subTo(f,t);return t};
a.prototype.multiply=function(f){var t=b();this.multiplyTo(f,t);return t};a.prototype.divide=function(f){var t=b();this.divRemTo(f,t,null);return t};a.prototype.remainder=function(f){var t=b();this.divRemTo(f,null,t);return t};a.prototype.divideAndRemainder=function(f){var t=b(),a=b();this.divRemTo(f,t,a);return[t,a]};a.prototype.modPow=function(f,t){var a=f.bitLength(),c,d=k(1),l;if(0>=a)return d;c=18>a?1:48>a?3:144>a?4:768>a?5:6;l=8>a?new m(t):t.isEven()?new E(t):new u(t);var e=[],g=3,v=c-1,w=(1<<
c)-1;e[1]=l.convert(this);if(1<c)for(a=b(),l.sqrTo(e[1],a);g<=w;)e[g]=b(),l.mulTo(a,e[g-2],e[g]),g+=2;for(var x=f.t-1,z,D=!0,C=b(),a=q(f[x])-1;0<=x;){a>=v?z=f[x]>>a-v&w:(z=(f[x]&(1<<a+1)-1)<<v-a,0<x&&(z|=f[x-1]>>this.DB+a-v));for(g=c;0==(z&1);)z>>=1,--g;0>(a-=g)&&(a+=this.DB,--x);if(D)e[z].copyTo(d),D=!1;else{for(;1<g;)l.sqrTo(d,C),l.sqrTo(C,d),g-=2;0<g?l.sqrTo(d,C):(g=d,d=C,C=g);l.mulTo(C,e[z],d)}for(;0<=x&&0==(f[x]&1<<a);)l.sqrTo(d,C),g=d,d=C,C=g,0>--a&&(a=this.DB-1,--x)}return l.revert(d)};a.prototype.modInverse=
function(f){var t=f.isEven();if(this.isEven()&&t||0==f.signum())return a.ZERO;for(var b=f.clone(),c=this.clone(),d=k(1),l=k(0),e=k(0),g=k(1);0!=b.signum();){for(;b.isEven();)b.rShiftTo(1,b),t?(d.isEven()&&l.isEven()||(d.addTo(this,d),l.subTo(f,l)),d.rShiftTo(1,d)):l.isEven()||l.subTo(f,l),l.rShiftTo(1,l);for(;c.isEven();)c.rShiftTo(1,c),t?(e.isEven()&&g.isEven()||(e.addTo(this,e),g.subTo(f,g)),e.rShiftTo(1,e)):g.isEven()||g.subTo(f,g),g.rShiftTo(1,g);0<=b.compareTo(c)?(b.subTo(c,b),t&&d.subTo(e,d),
l.subTo(g,l)):(c.subTo(b,c),t&&e.subTo(d,e),g.subTo(l,g))}if(0!=c.compareTo(a.ONE))return a.ZERO;if(0<=g.compareTo(f))return g.subtract(f);if(0>g.signum())g.addTo(f,g);else return g;return 0>g.signum()?g.add(f):g};a.prototype.pow=function(f){return this.exp(f,new D)};a.prototype.gcd=function(f){var t=0>this.s?this.negate():this.clone();f=0>f.s?f.negate():f.clone();if(0>t.compareTo(f)){var a=t,t=f;f=a}var a=t.getLowestSetBit(),b=f.getLowestSetBit();if(0>b)return t;a<b&&(b=a);for(0<b&&(t.rShiftTo(b,
t),f.rShiftTo(b,f));0<t.signum();)0<(a=t.getLowestSetBit())&&t.rShiftTo(a,t),0<(a=f.getLowestSetBit())&&f.rShiftTo(a,f),0<=t.compareTo(f)?(t.subTo(f,t),t.rShiftTo(1,t)):(f.subTo(t,f),f.rShiftTo(1,f));0<b&&f.lShiftTo(b,f);return f};a.prototype.isProbablePrime=function(f){var t,a=this.abs();if(1==a.t&&a[0]<=Z[Z.length-1]){for(t=0;t<Z.length;++t)if(a[0]==Z[t])return!0;return!1}if(a.isEven())return!1;for(t=1;t<Z.length;){for(var b=Z[t],c=t+1;c<Z.length&&b<T;)b*=Z[c++];for(b=a.modInt(b);t<c;)if(0==b%Z[t++])return!1}return a.millerRabin(f)};
a.prototype.square=function(){var f=b();this.squareTo(f);return f};a.prototype.IsNegative=function(){return-1==this.compareTo(a.ZERO)?!0:!1};a.op_Equality=function(f,a){return 0==f.compareTo(a)?!0:!1};a.op_Inequality=function(f,a){return 0!=f.compareTo(a)?!0:!1};a.op_GreaterThan=function(f,a){return 0<f.compareTo(a)?!0:!1};a.op_LessThan=function(f,a){return 0>f.compareTo(a)?!0:!1};a.op_Addition=function(f,t){return(new a(f)).add(new a(t))};a.op_Subtraction=function(f,t){return(new a(f)).subtract(new a(t))};
a.Int128Mul=function(f,t){return(new a(f)).multiply(new a(t))};a.op_Division=function(f,a){return f.divide(a)};a.prototype.ToDouble=function(){return parseFloat(this.toString())};if("undefined"==typeof sa)var sa=function(f,a){var b;if("undefined"==typeof Object.getOwnPropertyNames)for(b in a.prototype){if("undefined"==typeof f.prototype[b]||f.prototype[b]==Object.prototype[b])f.prototype[b]=a.prototype[b]}else for(var c=Object.getOwnPropertyNames(a.prototype),d=0;d<c.length;d++)"undefined"==typeof Object.getOwnPropertyDescriptor(f.prototype,
c[d])&&Object.defineProperty(f.prototype,c[d],Object.getOwnPropertyDescriptor(a.prototype,c[d]));for(b in a)"undefined"==typeof f[b]&&(f[b]=a[b]);f.$baseCtor=a};l.Path=function(){return[]};l.Paths=function(){return[]};l.DoublePoint=function(){var f=arguments;this.Y=this.X=0;1==f.length?(this.X=f[0].X,this.Y=f[0].Y):2==f.length&&(this.X=f[0],this.Y=f[1])};l.DoublePoint0=function(){this.Y=this.X=0};l.DoublePoint1=function(f){this.X=f.X;this.Y=f.Y};l.DoublePoint2=function(f,a){this.X=f;this.Y=a};l.PolyNode=
function(){this.m_Parent=null;this.m_polygon=new l.Path;this.m_endtype=this.m_jointype=this.m_Index=0;this.m_Childs=[];this.IsOpen=!1};l.PolyNode.prototype.IsHoleNode=function(){for(var f=!0,a=this.m_Parent;null!==a;)f=!f,a=a.m_Parent;return f};l.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};l.PolyNode.prototype.Contour=function(){return this.m_polygon};l.PolyNode.prototype.AddChild=function(f){var a=this.m_Childs.length;this.m_Childs.push(f);f.m_Parent=this;f.m_Index=a};l.PolyNode.prototype.GetNext=
function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()};l.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]};l.PolyNode.prototype.Childs=function(){return this.m_Childs};l.PolyNode.prototype.Parent=function(){return this.m_Parent};l.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};l.PolyTree=function(){this.m_AllPolys=
[];l.PolyNode.call(this)};l.PolyTree.prototype.Clear=function(){for(var f=0,a=this.m_AllPolys.length;f<a;f++)this.m_AllPolys[f]=null;this.m_AllPolys.length=0;this.m_Childs.length=0};l.PolyTree.prototype.GetFirst=function(){return 0<this.m_Childs.length?this.m_Childs[0]:null};l.PolyTree.prototype.Total=function(){return this.m_AllPolys.length};sa(l.PolyTree,l.PolyNode);l.Math_Abs_Int64=l.Math_Abs_Int32=l.Math_Abs_Double=function(f){return Math.abs(f)};l.Math_Max_Int32_Int32=function(f,a){return Math.max(f,
a)};l.Cast_Int32=S||fa||Y?function(f){return f|0}:function(f){return~~f};l.Cast_Int64=O?function(f){return-2147483648>f||2147483647<f?0>f?Math.ceil(f):Math.floor(f):~~f}:ea&&"function"==typeof Number.toInteger?function(f){return Number.toInteger(f)}:Q||z?function(f){return parseInt(f,10)}:S?function(f){return-2147483648>f||2147483647<f?0>f?Math.ceil(f):Math.floor(f):f|0}:function(f){return 0>f?Math.ceil(f):Math.floor(f)};l.Clear=function(f){f.length=0};l.PI=3.141592653589793;l.PI2=6.283185307179586;
l.IntPoint=function(){var f;f=arguments;var a=f.length;this.Y=this.X=0;2==a?(this.X=f[0],this.Y=f[1]):1==a?f[0]instanceof l.DoublePoint?(f=f[0],this.X=l.Clipper.Round(f.X),this.Y=l.Clipper.Round(f.Y)):(f=f[0],this.X=f.X,this.Y=f.Y):this.Y=this.X=0};l.IntPoint.op_Equality=function(f,a){return f.X==a.X&&f.Y==a.Y};l.IntPoint.op_Inequality=function(f,a){return f.X!=a.X||f.Y!=a.Y};l.IntPoint0=function(){this.Y=this.X=0};l.IntPoint1=function(f){this.X=f.X;this.Y=f.Y};l.IntPoint1dp=function(f){this.X=l.Clipper.Round(f.X);
this.Y=l.Clipper.Round(f.Y)};l.IntPoint2=function(f,a){this.X=f;this.Y=a};l.IntRect=function(){var f=arguments,a=f.length;4==a?(this.left=f[0],this.top=f[1],this.right=f[2],this.bottom=f[3]):1==a?(this.left=f[0].left,this.top=f[0].top,this.right=f[0].right,this.bottom=f[0].bottom):this.bottom=this.right=this.top=this.left=0};l.IntRect0=function(){this.bottom=this.right=this.top=this.left=0};l.IntRect1=function(f){this.left=f.left;this.top=f.top;this.right=f.right;this.bottom=f.bottom};l.IntRect4=
function(f,a,b,c){this.left=f;this.top=a;this.right=b;this.bottom=c};l.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};l.PolyType={ptSubject:0,ptClip:1};l.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};l.JoinType={jtSquare:0,jtRound:1,jtMiter:2};l.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};l.EdgeSide={esLeft:0,esRight:1};l.Direction={dRightToLeft:0,dLeftToRight:1};l.TEdge=function(){this.Bot=new l.IntPoint;this.Curr=new l.IntPoint;
this.Top=new l.IntPoint;this.Delta=new l.IntPoint;this.Dx=0;this.PolyTyp=l.PolyType.ptSubject;this.Side=l.EdgeSide.esLeft;this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0;this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null};l.IntersectNode=function(){this.Edge2=this.Edge1=null;this.Pt=new l.IntPoint};l.MyIntersectNodeSort=function(){};l.MyIntersectNodeSort.Compare=function(f,a){return a.Pt.Y-f.Pt.Y};l.LocalMinima=function(){this.Y=0;this.Next=
this.RightBound=this.LeftBound=null};l.Scanbeam=function(){this.Y=0;this.Next=null};l.OutRec=function(){this.Idx=0;this.IsOpen=this.IsHole=!1;this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null};l.OutPt=function(){this.Idx=0;this.Pt=new l.IntPoint;this.Prev=this.Next=null};l.Join=function(){this.OutPt2=this.OutPt1=null;this.OffPt=new l.IntPoint};l.ClipperBase=function(){this.m_CurrentLM=this.m_MinimaList=null;this.m_edges=[];this.PreserveCollinear=this.m_HasOpenPaths=this.m_UseFullRange=!1;this.m_CurrentLM=
this.m_MinimaList=null;this.m_HasOpenPaths=this.m_UseFullRange=!1};l.ClipperBase.horizontal=-9007199254740992;l.ClipperBase.Skip=-2;l.ClipperBase.Unassigned=-1;l.ClipperBase.tolerance=1E-20;l.ClipperBase.loRange=47453132;l.ClipperBase.hiRange=0xfffffffffffff;l.ClipperBase.near_zero=function(f){return f>-l.ClipperBase.tolerance&&f<l.ClipperBase.tolerance};l.ClipperBase.IsHorizontal=function(f){return 0===f.Delta.Y};l.ClipperBase.prototype.PointIsVertex=function(f,a){var b=a;do{if(l.IntPoint.op_Equality(b.Pt,
f))return!0;b=b.Next}while(b!=a);return!1};l.ClipperBase.prototype.PointOnLineSegment=function(f,t,b,c){return c?f.X==t.X&&f.Y==t.Y||f.X==b.X&&f.Y==b.Y||f.X>t.X==f.X<b.X&&f.Y>t.Y==f.Y<b.Y&&a.op_Equality(a.Int128Mul(f.X-t.X,b.Y-t.Y),a.Int128Mul(b.X-t.X,f.Y-t.Y)):f.X==t.X&&f.Y==t.Y||f.X==b.X&&f.Y==b.Y||f.X>t.X==f.X<b.X&&f.Y>t.Y==f.Y<b.Y&&(f.X-t.X)*(b.Y-t.Y)==(b.X-t.X)*(f.Y-t.Y)};l.ClipperBase.prototype.PointOnPolygon=function(f,a,b){for(var c=a;;){if(this.PointOnLineSegment(f,c.Pt,c.Next.Pt,b))return!0;
c=c.Next;if(c==a)break}return!1};l.ClipperBase.prototype.SlopesEqual=l.ClipperBase.SlopesEqual=function(){var f=arguments,t=f.length,b,c,d;if(3==t)return t=f[0],b=f[1],f[2]?a.op_Equality(a.Int128Mul(t.Delta.Y,b.Delta.X),a.Int128Mul(t.Delta.X,b.Delta.Y)):l.Cast_Int64(t.Delta.Y*b.Delta.X)==l.Cast_Int64(t.Delta.X*b.Delta.Y);if(4==t)return t=f[0],b=f[1],c=f[2],f[3]?a.op_Equality(a.Int128Mul(t.Y-b.Y,b.X-c.X),a.Int128Mul(t.X-b.X,b.Y-c.Y)):0===l.Cast_Int64((t.Y-b.Y)*(b.X-c.X))-l.Cast_Int64((t.X-b.X)*(b.Y-
c.Y));t=f[0];b=f[1];c=f[2];d=f[3];return f[4]?a.op_Equality(a.Int128Mul(t.Y-b.Y,c.X-d.X),a.Int128Mul(t.X-b.X,c.Y-d.Y)):0===l.Cast_Int64((t.Y-b.Y)*(c.X-d.X))-l.Cast_Int64((t.X-b.X)*(c.Y-d.Y))};l.ClipperBase.SlopesEqual3=function(f,t,b){return b?a.op_Equality(a.Int128Mul(f.Delta.Y,t.Delta.X),a.Int128Mul(f.Delta.X,t.Delta.Y)):l.Cast_Int64(f.Delta.Y*t.Delta.X)==l.Cast_Int64(f.Delta.X*t.Delta.Y)};l.ClipperBase.SlopesEqual4=function(f,t,b,c){return c?a.op_Equality(a.Int128Mul(f.Y-t.Y,t.X-b.X),a.Int128Mul(f.X-
t.X,t.Y-b.Y)):0===l.Cast_Int64((f.Y-t.Y)*(t.X-b.X))-l.Cast_Int64((f.X-t.X)*(t.Y-b.Y))};l.ClipperBase.SlopesEqual5=function(f,t,b,c,d){return d?a.op_Equality(a.Int128Mul(f.Y-t.Y,b.X-c.X),a.Int128Mul(f.X-t.X,b.Y-c.Y)):0===l.Cast_Int64((f.Y-t.Y)*(b.X-c.X))-l.Cast_Int64((f.X-t.X)*(b.Y-c.Y))};l.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var f=0,a=this.m_edges.length;f<a;++f){for(var b=0,c=this.m_edges[f].length;b<c;++b)this.m_edges[f][b]=null;l.Clear(this.m_edges[f])}l.Clear(this.m_edges);
this.m_HasOpenPaths=this.m_UseFullRange=!1};l.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var f=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=f}this.m_CurrentLM=null};l.ClipperBase.prototype.RangeTest=function(f,a){if(a.Value)(f.X>l.ClipperBase.hiRange||f.Y>l.ClipperBase.hiRange||-f.X>l.ClipperBase.hiRange||-f.Y>l.ClipperBase.hiRange)&&l.Error("Coordinate outside allowed range in RangeTest().");else if(f.X>l.ClipperBase.loRange||f.Y>l.ClipperBase.loRange||
-f.X>l.ClipperBase.loRange||-f.Y>l.ClipperBase.loRange)a.Value=!0,this.RangeTest(f,a)};l.ClipperBase.prototype.InitEdge=function(f,a,b,c){f.Next=a;f.Prev=b;f.Curr.X=c.X;f.Curr.Y=c.Y;f.OutIdx=-1};l.ClipperBase.prototype.InitEdge2=function(f,a){f.Curr.Y>=f.Next.Curr.Y?(f.Bot.X=f.Curr.X,f.Bot.Y=f.Curr.Y,f.Top.X=f.Next.Curr.X,f.Top.Y=f.Next.Curr.Y):(f.Top.X=f.Curr.X,f.Top.Y=f.Curr.Y,f.Bot.X=f.Next.Curr.X,f.Bot.Y=f.Next.Curr.Y);this.SetDx(f);f.PolyTyp=a};l.ClipperBase.prototype.FindNextLocMin=function(f){for(var a;;){for(;l.IntPoint.op_Inequality(f.Bot,
f.Prev.Bot)||l.IntPoint.op_Equality(f.Curr,f.Top);)f=f.Next;if(f.Dx!=l.ClipperBase.horizontal&&f.Prev.Dx!=l.ClipperBase.horizontal)break;for(;f.Prev.Dx==l.ClipperBase.horizontal;)f=f.Prev;for(a=f;f.Dx==l.ClipperBase.horizontal;)f=f.Next;if(f.Top.Y!=f.Prev.Bot.Y){a.Prev.Bot.X<f.Bot.X&&(f=a);break}}return f};l.ClipperBase.prototype.ProcessBound=function(f,a){var b=f,c=f,d;f.Dx==l.ClipperBase.horizontal&&(d=a?f.Prev.Bot.X:f.Next.Bot.X,f.Bot.X!=d&&this.ReverseHorizontal(f));if(c.OutIdx!=l.ClipperBase.Skip)if(a){for(;c.Top.Y==
c.Next.Bot.Y&&c.Next.OutIdx!=l.ClipperBase.Skip;)c=c.Next;if(c.Dx==l.ClipperBase.horizontal&&c.Next.OutIdx!=l.ClipperBase.Skip){for(d=c;d.Prev.Dx==l.ClipperBase.horizontal;)d=d.Prev;d.Prev.Top.X==c.Next.Top.X?a||(c=d.Prev):d.Prev.Top.X>c.Next.Top.X&&(c=d.Prev)}for(;f!=c;)f.NextInLML=f.Next,f.Dx==l.ClipperBase.horizontal&&f!=b&&f.Bot.X!=f.Prev.Top.X&&this.ReverseHorizontal(f),f=f.Next;f.Dx==l.ClipperBase.horizontal&&f!=b&&f.Bot.X!=f.Prev.Top.X&&this.ReverseHorizontal(f);c=c.Next}else{for(;c.Top.Y==
c.Prev.Bot.Y&&c.Prev.OutIdx!=l.ClipperBase.Skip;)c=c.Prev;if(c.Dx==l.ClipperBase.horizontal&&c.Prev.OutIdx!=l.ClipperBase.Skip){for(d=c;d.Next.Dx==l.ClipperBase.horizontal;)d=d.Next;d.Next.Top.X==c.Prev.Top.X?a||(c=d.Next):d.Next.Top.X>c.Prev.Top.X&&(c=d.Next)}for(;f!=c;)f.NextInLML=f.Prev,f.Dx==l.ClipperBase.horizontal&&f!=b&&f.Bot.X!=f.Next.Top.X&&this.ReverseHorizontal(f),f=f.Prev;f.Dx==l.ClipperBase.horizontal&&f!=b&&f.Bot.X!=f.Next.Top.X&&this.ReverseHorizontal(f);c=c.Prev}if(c.OutIdx==l.ClipperBase.Skip){f=
c;if(a){for(;f.Top.Y==f.Next.Bot.Y;)f=f.Next;for(;f!=c&&f.Dx==l.ClipperBase.horizontal;)f=f.Prev}else{for(;f.Top.Y==f.Prev.Bot.Y;)f=f.Prev;for(;f!=c&&f.Dx==l.ClipperBase.horizontal;)f=f.Next}f==c?c=a?f.Next:f.Prev:(f=a?c.Next:c.Prev,b=new l.LocalMinima,b.Next=null,b.Y=f.Bot.Y,b.LeftBound=null,b.RightBound=f,b.RightBound.WindDelta=0,c=this.ProcessBound(b.RightBound,a),this.InsertLocalMinima(b))}return c};l.ClipperBase.prototype.AddPath=function(f,a,b){b||a!=l.PolyType.ptClip||l.Error("AddPath: Open paths must be subject.");
var c=f.length-1;if(b)for(;0<c&&l.IntPoint.op_Equality(f[c],f[0]);)--c;for(;0<c&&l.IntPoint.op_Equality(f[c],f[c-1]);)--c;if(b&&2>c||!b&&1>c)return!1;for(var d=[],e=0;e<=c;e++)d.push(new l.TEdge);var g=!0;try{for(d[1].Curr.X=f[1].X,d[1].Curr.Y=f[1].Y,function(){var a={Value:this.m_UseFullRange},t=this.RangeTest(f[0],a);this.m_UseFullRange=a.Value;return t}.call(this),function(){var a={Value:this.m_UseFullRange},t=this.RangeTest(f[c],a);this.m_UseFullRange=a.Value;return t}.call(this),this.InitEdge(d[0],
d[1],d[c],f[0]),this.InitEdge(d[c],d[0],d[c-1],f[c]),e=c-1;1<=e;--e)(function(){var a={Value:this.m_UseFullRange},t=this.RangeTest(f[e],a);this.m_UseFullRange=a.Value;return t}).call(this),this.InitEdge(d[e],d[e+1],d[e-1],f[e])}catch(k){return!1}var m=d[0];b||(m.Prev.OutIdx=l.ClipperBase.Skip);for(var q=m,u=m;;)if(l.IntPoint.op_Equality(q.Curr,q.Next.Curr)){if(q==q.Next)break;q==m&&(m=q.Next);u=q=this.RemoveEdge(q)}else{if(q.Prev==q.Next)break;else if(b&&l.ClipperBase.SlopesEqual(q.Prev.Curr,q.Curr,
q.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(q.Prev.Curr,q.Curr,q.Next.Curr))){q==m&&(m=q.Next);q=this.RemoveEdge(q);u=q=q.Prev;continue}q=q.Next;if(q==u)break}if(!b&&q==q.Next||b&&q.Prev==q.Next)return!1;b||(this.m_HasOpenPaths=!0);q=m;do this.InitEdge2(q,a),q=q.Next,g&&q.Curr.Y!=m.Curr.Y&&(g=!1);while(q!=m);if(g){if(b)return!1;q.Prev.OutIdx=l.ClipperBase.Skip;q.Prev.Bot.X<q.Prev.Top.X&&this.ReverseHorizontal(q.Prev);a=new l.LocalMinima;a.Next=null;a.Y=
q.Bot.Y;a.LeftBound=null;a.RightBound=q;a.RightBound.Side=l.EdgeSide.esRight;for(a.RightBound.WindDelta=0;q.Next.OutIdx!=l.ClipperBase.Skip;)q.NextInLML=q.Next,q.Bot.X!=q.Prev.Top.X&&this.ReverseHorizontal(q),q=q.Next;this.InsertLocalMinima(a);this.m_edges.push(d);return!0}this.m_edges.push(d);for(g=null;;){q=this.FindNextLocMin(q);if(q==g)break;else null==g&&(g=q);a=new l.LocalMinima;a.Next=null;a.Y=q.Bot.Y;q.Dx<q.Prev.Dx?(a.LeftBound=q.Prev,a.RightBound=q,d=!1):(a.LeftBound=q,a.RightBound=q.Prev,
d=!0);a.LeftBound.Side=l.EdgeSide.esLeft;a.RightBound.Side=l.EdgeSide.esRight;a.LeftBound.WindDelta=b?a.LeftBound.Next==a.RightBound?-1:1:0;a.RightBound.WindDelta=-a.LeftBound.WindDelta;q=this.ProcessBound(a.LeftBound,d);m=this.ProcessBound(a.RightBound,!d);a.LeftBound.OutIdx==l.ClipperBase.Skip?a.LeftBound=null:a.RightBound.OutIdx==l.ClipperBase.Skip&&(a.RightBound=null);this.InsertLocalMinima(a);d||(q=m)}return!0};l.ClipperBase.prototype.AddPaths=function(f,a,b){for(var c=!1,d=0,l=f.length;d<l;++d)this.AddPath(f[d],
a,b)&&(c=!0);return c};l.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(f,a,b){return l.IntPoint.op_Equality(f,b)||l.IntPoint.op_Equality(f,a)||l.IntPoint.op_Equality(b,a)?!1:f.X!=b.X?a.X>f.X==a.X<b.X:a.Y>f.Y==a.Y<b.Y};l.ClipperBase.prototype.RemoveEdge=function(f){f.Prev.Next=f.Next;f.Next.Prev=f.Prev;var a=f.Next;f.Prev=null;return a};l.ClipperBase.prototype.SetDx=function(f){f.Delta.X=f.Top.X-f.Bot.X;f.Delta.Y=f.Top.Y-f.Bot.Y;f.Dx=0===f.Delta.Y?l.ClipperBase.horizontal:f.Delta.X/f.Delta.Y};
l.ClipperBase.prototype.InsertLocalMinima=function(f){if(null===this.m_MinimaList)this.m_MinimaList=f;else if(f.Y>=this.m_MinimaList.Y)f.Next=this.m_MinimaList,this.m_MinimaList=f;else{for(var a=this.m_MinimaList;null!==a.Next&&f.Y<a.Next.Y;)a=a.Next;f.Next=a.Next;a.Next=f}};l.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)};l.ClipperBase.prototype.ReverseHorizontal=function(f){var a=f.Top.X;f.Top.X=f.Bot.X;f.Bot.X=a};l.ClipperBase.prototype.Reset=
function(){this.m_CurrentLM=this.m_MinimaList;if(null!=this.m_CurrentLM)for(var f=this.m_MinimaList;null!=f;){var a=f.LeftBound;null!=a&&(a.Curr.X=a.Bot.X,a.Curr.Y=a.Bot.Y,a.Side=l.EdgeSide.esLeft,a.OutIdx=l.ClipperBase.Unassigned);a=f.RightBound;null!=a&&(a.Curr.X=a.Bot.X,a.Curr.Y=a.Bot.Y,a.Side=l.EdgeSide.esRight,a.OutIdx=l.ClipperBase.Unassigned);f=f.Next}};l.Clipper=function(f){"undefined"==typeof f&&(f=0);this.m_PolyOuts=null;this.m_ClipType=l.ClipType.ctIntersection;this.m_IntersectNodeComparer=
this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_ExecuteLocked=!1;this.m_SubjFillType=this.m_ClipFillType=l.PolyFillType.pftEvenOdd;this.m_GhostJoins=this.m_Joins=null;this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1;l.ClipperBase.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_IntersectList=[];this.m_IntersectNodeComparer=l.MyIntersectNodeSort.Compare;this.m_UsingPolyTree=this.m_ExecuteLocked=!1;this.m_PolyOuts=[];
this.m_Joins=[];this.m_GhostJoins=[];this.ReverseSolution=0!==(1&f);this.StrictlySimple=0!==(2&f);this.PreserveCollinear=0!==(4&f)};l.Clipper.ioReverseSolution=1;l.Clipper.ioStrictlySimple=2;l.Clipper.ioPreserveCollinear=4;l.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),l.ClipperBase.prototype.Clear.call(this))};l.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var f=this.m_Scanbeam.Next;this.m_Scanbeam=null;this.m_Scanbeam=f}};
l.Clipper.prototype.Reset=function(){l.ClipperBase.prototype.Reset.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.DisposeAllPolyPts();for(var f=this.m_MinimaList;null!==f;)this.InsertScanbeam(f.Y),f=f.Next};l.Clipper.prototype.InsertScanbeam=function(f){if(null===this.m_Scanbeam)this.m_Scanbeam=new l.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=f;else if(f>this.m_Scanbeam.Y){var a=new l.Scanbeam;a.Y=f;a.Next=this.m_Scanbeam;this.m_Scanbeam=a}else{for(var b=this.m_Scanbeam;null!==
b.Next&&f<=b.Next.Y;)b=b.Next;f!=b.Y&&(a=new l.Scanbeam,a.Y=f,a.Next=b.Next,b.Next=a)}};l.Clipper.prototype.Execute=function(){var f=arguments,a=f.length,b=f[1]instanceof l.PolyTree;if(4!=a||b){if(4==a&&b){b=f[0];a=f[1];c=f[2];f=f[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;this.m_SubjFillType=c;this.m_ClipFillType=f;this.m_ClipType=b;this.m_UsingPolyTree=!0;(f=this.ExecuteInternal())&&this.BuildResult2(a);this.m_ExecuteLocked=!1;return f}if(2==a&&!b||2==a&&b)return b=f[0],a=f[1],
this.Execute(b,a,l.PolyFillType.pftEvenOdd,l.PolyFillType.pftEvenOdd)}else{var b=f[0],a=f[1],c=f[2],f=f[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&l.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=!0;l.Clear(a);this.m_SubjFillType=c;this.m_ClipFillType=f;this.m_ClipType=b;this.m_UsingPolyTree=!1;(f=this.ExecuteInternal())&&this.BuildResult(a);this.m_ExecuteLocked=!1;return f}};l.Clipper.prototype.FixHoleLinkage=function(f){if(null!==f.FirstLeft&&
(f.IsHole==f.FirstLeft.IsHole||null===f.FirstLeft.Pts)){for(var a=f.FirstLeft;null!==a&&(a.IsHole==f.IsHole||null===a.Pts);)a=a.FirstLeft;f.FirstLeft=a}};l.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(null===this.m_CurrentLM)return!1;var f=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(f);l.Clear(this.m_GhostJoins);this.ProcessHorizontals(!1);if(null===this.m_Scanbeam)break;var a=this.PopScanbeam();if(!this.ProcessIntersections(f,a))return!1;this.ProcessEdgesAtTopOfScanbeam(a);
f=a}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var f=0,b=this.m_PolyOuts.length;f<b;f++){var c=this.m_PolyOuts[f];null===c.Pts||c.IsOpen||(c.IsHole^this.ReverseSolution)==0<this.Area(c)&&this.ReversePolyPtLinks(c.Pts)}this.JoinCommonEdges();f=0;for(b=this.m_PolyOuts.length;f<b;f++)c=this.m_PolyOuts[f],null===c.Pts||c.IsOpen||this.FixupOutPolygon(c);this.StrictlySimple&&this.DoSimplePolygons();return!0}finally{l.Clear(this.m_Joins),l.Clear(this.m_GhostJoins)}};l.Clipper.prototype.PopScanbeam=
function(){var f=this.m_Scanbeam.Y;this.m_Scanbeam=this.m_Scanbeam.Next;return f};l.Clipper.prototype.DisposeAllPolyPts=function(){for(var f=0,a=this.m_PolyOuts.length;f<a;++f)this.DisposeOutRec(f);l.Clear(this.m_PolyOuts)};l.Clipper.prototype.DisposeOutRec=function(f){var a=this.m_PolyOuts[f];null!==a.Pts&&this.DisposeOutPts(a.Pts);this.m_PolyOuts[f]=null};l.Clipper.prototype.DisposeOutPts=function(f){if(null!==f)for(f.Prev.Next=null;null!==f;)f=f.Next};l.Clipper.prototype.AddJoin=function(f,a,b){var c=
new l.Join;c.OutPt1=f;c.OutPt2=a;c.OffPt.X=b.X;c.OffPt.Y=b.Y;this.m_Joins.push(c)};l.Clipper.prototype.AddGhostJoin=function(f,a){var b=new l.Join;b.OutPt1=f;b.OffPt.X=a.X;b.OffPt.Y=a.Y;this.m_GhostJoins.push(b)};l.Clipper.prototype.InsertLocalMinimaIntoAEL=function(f){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==f;){var a=this.m_CurrentLM.LeftBound,b=this.m_CurrentLM.RightBound;this.PopLocalMinima();var c=null;null===a?(this.InsertEdgeIntoAEL(b,null),this.SetWindingCount(b),this.IsContributing(b)&&
(c=this.AddOutPt(b,b.Bot))):(null==b?(this.InsertEdgeIntoAEL(a,null),this.SetWindingCount(a),this.IsContributing(a)&&(c=this.AddOutPt(a,a.Bot))):(this.InsertEdgeIntoAEL(a,null),this.InsertEdgeIntoAEL(b,a),this.SetWindingCount(a),b.WindCnt=a.WindCnt,b.WindCnt2=a.WindCnt2,this.IsContributing(a)&&(c=this.AddLocalMinPoly(a,b,a.Bot))),this.InsertScanbeam(a.Top.Y));null!=b&&(l.ClipperBase.IsHorizontal(b)?this.AddEdgeToSEL(b):this.InsertScanbeam(b.Top.Y));if(null!=a&&null!=b){if(null!==c&&l.ClipperBase.IsHorizontal(b)&&
0<this.m_GhostJoins.length&&0!==b.WindDelta)for(var d=0,e=this.m_GhostJoins.length;d<e;d++){var g=this.m_GhostJoins[d];this.HorzSegmentsOverlap(g.OutPt1.Pt,g.OffPt,b.Bot,b.Top)&&this.AddJoin(g.OutPt1,c,g.OffPt)}0<=a.OutIdx&&null!==a.PrevInAEL&&a.PrevInAEL.Curr.X==a.Bot.X&&0<=a.PrevInAEL.OutIdx&&l.ClipperBase.SlopesEqual(a.PrevInAEL,a,this.m_UseFullRange)&&0!==a.WindDelta&&0!==a.PrevInAEL.WindDelta&&(d=this.AddOutPt(a.PrevInAEL,a.Bot),this.AddJoin(c,d,a.Top));if(a.NextInAEL!=b&&(0<=b.OutIdx&&0<=b.PrevInAEL.OutIdx&&
l.ClipperBase.SlopesEqual(b.PrevInAEL,b,this.m_UseFullRange)&&0!==b.WindDelta&&0!==b.PrevInAEL.WindDelta&&(d=this.AddOutPt(b.PrevInAEL,b.Bot),this.AddJoin(c,d,b.Top)),c=a.NextInAEL,null!==c))for(;c!=b;)this.IntersectEdges(b,c,a.Curr,!1),c=c.NextInAEL}}};l.Clipper.prototype.InsertEdgeIntoAEL=function(f,a){if(null===this.m_ActiveEdges)f.PrevInAEL=null,f.NextInAEL=null,this.m_ActiveEdges=f;else if(null===a&&this.E2InsertsBeforeE1(this.m_ActiveEdges,f))f.PrevInAEL=null,f.NextInAEL=this.m_ActiveEdges,
this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=f;else{for(null===a&&(a=this.m_ActiveEdges);null!==a.NextInAEL&&!this.E2InsertsBeforeE1(a.NextInAEL,f);)a=a.NextInAEL;f.NextInAEL=a.NextInAEL;null!==a.NextInAEL&&(a.NextInAEL.PrevInAEL=f);f.PrevInAEL=a;a.NextInAEL=f}};l.Clipper.prototype.E2InsertsBeforeE1=function(f,a){return a.Curr.X==f.Curr.X?a.Top.Y>f.Top.Y?a.Top.X<l.Clipper.TopX(f,a.Top.Y):f.Top.X>l.Clipper.TopX(a,f.Top.Y):a.Curr.X<f.Curr.X};l.Clipper.prototype.IsEvenOddFillType=function(f){return f.PolyTyp==
l.PolyType.ptSubject?this.m_SubjFillType==l.PolyFillType.pftEvenOdd:this.m_ClipFillType==l.PolyFillType.pftEvenOdd};l.Clipper.prototype.IsEvenOddAltFillType=function(f){return f.PolyTyp==l.PolyType.ptSubject?this.m_ClipFillType==l.PolyFillType.pftEvenOdd:this.m_SubjFillType==l.PolyFillType.pftEvenOdd};l.Clipper.prototype.IsContributing=function(f){var a,b;f.PolyTyp==l.PolyType.ptSubject?(a=this.m_SubjFillType,b=this.m_ClipFillType):(a=this.m_ClipFillType,b=this.m_SubjFillType);switch(a){case l.PolyFillType.pftEvenOdd:if(0===
f.WindDelta&&1!=f.WindCnt)return!1;break;case l.PolyFillType.pftNonZero:if(1!=Math.abs(f.WindCnt))return!1;break;case l.PolyFillType.pftPositive:if(1!=f.WindCnt)return!1;break;default:if(-1!=f.WindCnt)return!1}switch(this.m_ClipType){case l.ClipType.ctIntersection:switch(b){case l.PolyFillType.pftEvenOdd:case l.PolyFillType.pftNonZero:return 0!==f.WindCnt2;case l.PolyFillType.pftPositive:return 0<f.WindCnt2;default:return 0>f.WindCnt2}case l.ClipType.ctUnion:switch(b){case l.PolyFillType.pftEvenOdd:case l.PolyFillType.pftNonZero:return 0===
f.WindCnt2;case l.PolyFillType.pftPositive:return 0>=f.WindCnt2;default:return 0<=f.WindCnt2}case l.ClipType.ctDifference:if(f.PolyTyp==l.PolyType.ptSubject)switch(b){case l.PolyFillType.pftEvenOdd:case l.PolyFillType.pftNonZero:return 0===f.WindCnt2;case l.PolyFillType.pftPositive:return 0>=f.WindCnt2;default:return 0<=f.WindCnt2}else switch(b){case l.PolyFillType.pftEvenOdd:case l.PolyFillType.pftNonZero:return 0!==f.WindCnt2;case l.PolyFillType.pftPositive:return 0<f.WindCnt2;default:return 0>
f.WindCnt2}case l.ClipType.ctXor:if(0===f.WindDelta)switch(b){case l.PolyFillType.pftEvenOdd:case l.PolyFillType.pftNonZero:return 0===f.WindCnt2;case l.PolyFillType.pftPositive:return 0>=f.WindCnt2;default:return 0<=f.WindCnt2}}return!0};l.Clipper.prototype.SetWindingCount=function(f){for(var a=f.PrevInAEL;null!==a&&(a.PolyTyp!=f.PolyTyp||0===a.WindDelta);)a=a.PrevInAEL;if(null===a)f.WindCnt=0===f.WindDelta?1:f.WindDelta,f.WindCnt2=0,a=this.m_ActiveEdges;else{if(0===f.WindDelta&&this.m_ClipType!=
l.ClipType.ctUnion)f.WindCnt=1;else if(this.IsEvenOddFillType(f))if(0===f.WindDelta){for(var b=!0,c=a.PrevInAEL;null!==c;)c.PolyTyp==a.PolyTyp&&0!==c.WindDelta&&(b=!b),c=c.PrevInAEL;f.WindCnt=b?0:1}else f.WindCnt=f.WindDelta;else 0>a.WindCnt*a.WindDelta?1<Math.abs(a.WindCnt)?f.WindCnt=0>a.WindDelta*f.WindDelta?a.WindCnt:a.WindCnt+f.WindDelta:f.WindCnt=0===f.WindDelta?1:f.WindDelta:f.WindCnt=0===f.WindDelta?0>a.WindCnt?a.WindCnt-1:a.WindCnt+1:0>a.WindDelta*f.WindDelta?a.WindCnt:a.WindCnt+f.WindDelta;
f.WindCnt2=a.WindCnt2;a=a.NextInAEL}if(this.IsEvenOddAltFillType(f))for(;a!=f;)0!==a.WindDelta&&(f.WindCnt2=0===f.WindCnt2?1:0),a=a.NextInAEL;else for(;a!=f;)f.WindCnt2+=a.WindDelta,a=a.NextInAEL};l.Clipper.prototype.AddEdgeToSEL=function(f){null===this.m_SortedEdges?(this.m_SortedEdges=f,f.PrevInSEL=null,f.NextInSEL=null):(f.NextInSEL=this.m_SortedEdges,f.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=f)};l.Clipper.prototype.CopyAELToSEL=function(){var f=this.m_ActiveEdges;for(this.m_SortedEdges=
f;null!==f;)f.PrevInSEL=f.PrevInAEL,f=f.NextInSEL=f.NextInAEL};l.Clipper.prototype.SwapPositionsInAEL=function(f,a){if(f.NextInAEL!=f.PrevInAEL&&a.NextInAEL!=a.PrevInAEL){if(f.NextInAEL==a){var b=a.NextInAEL;null!==b&&(b.PrevInAEL=f);var c=f.PrevInAEL;null!==c&&(c.NextInAEL=a);a.PrevInAEL=c;a.NextInAEL=f;f.PrevInAEL=a;f.NextInAEL=b}else a.NextInAEL==f?(b=f.NextInAEL,null!==b&&(b.PrevInAEL=a),c=a.PrevInAEL,null!==c&&(c.NextInAEL=f),f.PrevInAEL=c,f.NextInAEL=a,a.PrevInAEL=f,a.NextInAEL=b):(b=f.NextInAEL,
c=f.PrevInAEL,f.NextInAEL=a.NextInAEL,null!==f.NextInAEL&&(f.NextInAEL.PrevInAEL=f),f.PrevInAEL=a.PrevInAEL,null!==f.PrevInAEL&&(f.PrevInAEL.NextInAEL=f),a.NextInAEL=b,null!==a.NextInAEL&&(a.NextInAEL.PrevInAEL=a),a.PrevInAEL=c,null!==a.PrevInAEL&&(a.PrevInAEL.NextInAEL=a));null===f.PrevInAEL?this.m_ActiveEdges=f:null===a.PrevInAEL&&(this.m_ActiveEdges=a)}};l.Clipper.prototype.SwapPositionsInSEL=function(f,a){if(null!==f.NextInSEL||null!==f.PrevInSEL)if(null!==a.NextInSEL||null!==a.PrevInSEL){if(f.NextInSEL==
a){var b=a.NextInSEL;null!==b&&(b.PrevInSEL=f);var c=f.PrevInSEL;null!==c&&(c.NextInSEL=a);a.PrevInSEL=c;a.NextInSEL=f;f.PrevInSEL=a;f.NextInSEL=b}else a.NextInSEL==f?(b=f.NextInSEL,null!==b&&(b.PrevInSEL=a),c=a.PrevInSEL,null!==c&&(c.NextInSEL=f),f.PrevInSEL=c,f.NextInSEL=a,a.PrevInSEL=f,a.NextInSEL=b):(b=f.NextInSEL,c=f.PrevInSEL,f.NextInSEL=a.NextInSEL,null!==f.NextInSEL&&(f.NextInSEL.PrevInSEL=f),f.PrevInSEL=a.PrevInSEL,null!==f.PrevInSEL&&(f.PrevInSEL.NextInSEL=f),a.NextInSEL=b,null!==a.NextInSEL&&
(a.NextInSEL.PrevInSEL=a),a.PrevInSEL=c,null!==a.PrevInSEL&&(a.PrevInSEL.NextInSEL=a));null===f.PrevInSEL?this.m_SortedEdges=f:null===a.PrevInSEL&&(this.m_SortedEdges=a)}};l.Clipper.prototype.AddLocalMaxPoly=function(f,a,b){this.AddOutPt(f,b);0==a.WindDelta&&this.AddOutPt(a,b);f.OutIdx==a.OutIdx?(f.OutIdx=-1,a.OutIdx=-1):f.OutIdx<a.OutIdx?this.AppendPolygon(f,a):this.AppendPolygon(a,f)};l.Clipper.prototype.AddLocalMinPoly=function(f,a,b){var c,d;l.ClipperBase.IsHorizontal(a)||f.Dx>a.Dx?(c=this.AddOutPt(f,
b),a.OutIdx=f.OutIdx,f.Side=l.EdgeSide.esLeft,a.Side=l.EdgeSide.esRight,d=f,f=d.PrevInAEL==a?a.PrevInAEL:d.PrevInAEL):(c=this.AddOutPt(a,b),f.OutIdx=a.OutIdx,f.Side=l.EdgeSide.esRight,a.Side=l.EdgeSide.esLeft,d=a,f=d.PrevInAEL==f?f.PrevInAEL:d.PrevInAEL);null!==f&&0<=f.OutIdx&&l.Clipper.TopX(f,b.Y)==l.Clipper.TopX(d,b.Y)&&l.ClipperBase.SlopesEqual(d,f,this.m_UseFullRange)&&0!==d.WindDelta&&0!==f.WindDelta&&(b=this.AddOutPt(f,b),this.AddJoin(c,b,d.Top));return c};l.Clipper.prototype.CreateOutRec=function(){var f=
new l.OutRec;f.Idx=-1;f.IsHole=!1;f.IsOpen=!1;f.FirstLeft=null;f.Pts=null;f.BottomPt=null;f.PolyNode=null;this.m_PolyOuts.push(f);f.Idx=this.m_PolyOuts.length-1;return f};l.Clipper.prototype.AddOutPt=function(f,a){var b=f.Side==l.EdgeSide.esLeft;if(0>f.OutIdx){var c=this.CreateOutRec();c.IsOpen=0===f.WindDelta;var d=new l.OutPt;c.Pts=d;d.Idx=c.Idx;d.Pt.X=a.X;d.Pt.Y=a.Y;d.Next=d;d.Prev=d;c.IsOpen||this.SetHoleState(f,c);f.OutIdx=c.Idx}else{var c=this.m_PolyOuts[f.OutIdx],e=c.Pts;if(b&&l.IntPoint.op_Equality(a,
e.Pt))return e;if(!b&&l.IntPoint.op_Equality(a,e.Prev.Pt))return e.Prev;d=new l.OutPt;d.Idx=c.Idx;d.Pt.X=a.X;d.Pt.Y=a.Y;d.Next=e;d.Prev=e.Prev;d.Prev.Next=d;e.Prev=d;b&&(c.Pts=d)}return d};l.Clipper.prototype.SwapPoints=function(f,a){var b=new l.IntPoint(f.Value);f.Value.X=a.Value.X;f.Value.Y=a.Value.Y;a.Value.X=b.X;a.Value.Y=b.Y};l.Clipper.prototype.HorzSegmentsOverlap=function(f,a,b,c){return f.X>b.X==f.X<c.X?!0:a.X>b.X==a.X<c.X?!0:b.X>f.X==b.X<a.X?!0:c.X>f.X==c.X<a.X?!0:f.X==b.X&&a.X==c.X?!0:f.X==
c.X&&a.X==b.X?!0:!1};l.Clipper.prototype.InsertPolyPtBetween=function(f,a,b){var c=new l.OutPt;c.Pt.X=b.X;c.Pt.Y=b.Y;a==f.Next?(f.Next=c,a.Prev=c,c.Next=a,c.Prev=f):(a.Next=c,f.Prev=c,c.Next=f,c.Prev=a);return c};l.Clipper.prototype.SetHoleState=function(f,a){for(var b=!1,c=f.PrevInAEL;null!==c;)0<=c.OutIdx&&0!=c.WindDelta&&(b=!b,null===a.FirstLeft&&(a.FirstLeft=this.m_PolyOuts[c.OutIdx])),c=c.PrevInAEL;b&&(a.IsHole=!0)};l.Clipper.prototype.GetDx=function(f,a){return f.Y==a.Y?l.ClipperBase.horizontal:
(a.X-f.X)/(a.Y-f.Y)};l.Clipper.prototype.FirstIsBottomPt=function(f,a){for(var b=f.Prev;l.IntPoint.op_Equality(b.Pt,f.Pt)&&b!=f;)b=b.Prev;for(var c=Math.abs(this.GetDx(f.Pt,b.Pt)),b=f.Next;l.IntPoint.op_Equality(b.Pt,f.Pt)&&b!=f;)b=b.Next;for(var d=Math.abs(this.GetDx(f.Pt,b.Pt)),b=a.Prev;l.IntPoint.op_Equality(b.Pt,a.Pt)&&b!=a;)b=b.Prev;for(var e=Math.abs(this.GetDx(a.Pt,b.Pt)),b=a.Next;l.IntPoint.op_Equality(b.Pt,a.Pt)&&b!=a;)b=b.Next;b=Math.abs(this.GetDx(a.Pt,b.Pt));return c>=e&&c>=b||d>=e&&d>=
b};l.Clipper.prototype.GetBottomPt=function(f){for(var a=null,b=f.Next;b!=f;)b.Pt.Y>f.Pt.Y?(f=b,a=null):b.Pt.Y==f.Pt.Y&&b.Pt.X<=f.Pt.X&&(b.Pt.X<f.Pt.X?(a=null,f=b):b.Next!=f&&b.Prev!=f&&(a=b)),b=b.Next;if(null!==a)for(;a!=b;)for(this.FirstIsBottomPt(b,a)||(f=a),a=a.Next;l.IntPoint.op_Inequality(a.Pt,f.Pt);)a=a.Next;return f};l.Clipper.prototype.GetLowermostRec=function(f,a){null===f.BottomPt&&(f.BottomPt=this.GetBottomPt(f.Pts));null===a.BottomPt&&(a.BottomPt=this.GetBottomPt(a.Pts));var b=f.BottomPt,
c=a.BottomPt;return b.Pt.Y>c.Pt.Y?f:b.Pt.Y<c.Pt.Y?a:b.Pt.X<c.Pt.X?f:b.Pt.X>c.Pt.X?a:b.Next==b?a:c.Next==c?f:this.FirstIsBottomPt(b,c)?f:a};l.Clipper.prototype.Param1RightOfParam2=function(f,a){do if(f=f.FirstLeft,f==a)return!0;while(null!==f);return!1};l.Clipper.prototype.GetOutRec=function(f){for(f=this.m_PolyOuts[f];f!=this.m_PolyOuts[f.Idx];)f=this.m_PolyOuts[f.Idx];return f};l.Clipper.prototype.AppendPolygon=function(f,a){var b=this.m_PolyOuts[f.OutIdx],c=this.m_PolyOuts[a.OutIdx],d;d=this.Param1RightOfParam2(b,
c)?c:this.Param1RightOfParam2(c,b)?b:this.GetLowermostRec(b,c);var e=b.Pts,g=e.Prev,k=c.Pts,m=k.Prev;f.Side==l.EdgeSide.esLeft?(a.Side==l.EdgeSide.esLeft?(this.ReversePolyPtLinks(k),k.Next=e,e.Prev=k,g.Next=m,m.Prev=g,b.Pts=m):(m.Next=e,e.Prev=m,k.Prev=g,g.Next=k,b.Pts=k),e=l.EdgeSide.esLeft):(a.Side==l.EdgeSide.esRight?(this.ReversePolyPtLinks(k),g.Next=m,m.Prev=g,k.Next=e,e.Prev=k):(g.Next=k,k.Prev=g,e.Prev=m,m.Next=e),e=l.EdgeSide.esRight);b.BottomPt=null;d==c&&(c.FirstLeft!=b&&(b.FirstLeft=c.FirstLeft),
b.IsHole=c.IsHole);c.Pts=null;c.BottomPt=null;c.FirstLeft=b;d=f.OutIdx;g=a.OutIdx;f.OutIdx=-1;a.OutIdx=-1;for(k=this.m_ActiveEdges;null!==k;){if(k.OutIdx==g){k.OutIdx=d;k.Side=e;break}k=k.NextInAEL}c.Idx=b.Idx};l.Clipper.prototype.ReversePolyPtLinks=function(f){if(null!==f){var a,b;a=f;do b=a.Next,a.Next=a.Prev,a=a.Prev=b;while(a!=f)}};l.Clipper.SwapSides=function(f,a){var b=f.Side;f.Side=a.Side;a.Side=b};l.Clipper.SwapPolyIndexes=function(f,a){var b=f.OutIdx;f.OutIdx=a.OutIdx;a.OutIdx=b};l.Clipper.prototype.IntersectEdges=
function(f,a,b,c){var d=!c&&null===f.NextInLML&&f.Top.X==b.X&&f.Top.Y==b.Y;c=!c&&null===a.NextInLML&&a.Top.X==b.X&&a.Top.Y==b.Y;var e=0<=f.OutIdx,g=0<=a.OutIdx;if(0===f.WindDelta||0===a.WindDelta)0===f.WindDelta&&0===a.WindDelta?(d||c)&&e&&g&&this.AddLocalMaxPoly(f,a,b):f.PolyTyp==a.PolyTyp&&f.WindDelta!=a.WindDelta&&this.m_ClipType==l.ClipType.ctUnion?0===f.WindDelta?g&&(this.AddOutPt(f,b),e&&(f.OutIdx=-1)):e&&(this.AddOutPt(a,b),g&&(a.OutIdx=-1)):f.PolyTyp!=a.PolyTyp&&(0!==f.WindDelta||1!=Math.abs(a.WindCnt)||
this.m_ClipType==l.ClipType.ctUnion&&0!==a.WindCnt2?0!==a.WindDelta||1!=Math.abs(f.WindCnt)||this.m_ClipType==l.ClipType.ctUnion&&0!==f.WindCnt2||(this.AddOutPt(a,b),g&&(a.OutIdx=-1)):(this.AddOutPt(f,b),e&&(f.OutIdx=-1))),d&&(0>f.OutIdx?this.DeleteFromAEL(f):l.Error("Error intersecting polylines")),c&&(0>a.OutIdx?this.DeleteFromAEL(a):l.Error("Error intersecting polylines"));else{if(f.PolyTyp==a.PolyTyp)if(this.IsEvenOddFillType(f)){var k=f.WindCnt;f.WindCnt=a.WindCnt;a.WindCnt=k}else f.WindCnt=
0===f.WindCnt+a.WindDelta?-f.WindCnt:f.WindCnt+a.WindDelta,a.WindCnt=0===a.WindCnt-f.WindDelta?-a.WindCnt:a.WindCnt-f.WindDelta;else this.IsEvenOddFillType(a)?f.WindCnt2=0===f.WindCnt2?1:0:f.WindCnt2+=a.WindDelta,this.IsEvenOddFillType(f)?a.WindCnt2=0===a.WindCnt2?1:0:a.WindCnt2-=f.WindDelta;var m,q,u;f.PolyTyp==l.PolyType.ptSubject?(m=this.m_SubjFillType,u=this.m_ClipFillType):(m=this.m_ClipFillType,u=this.m_SubjFillType);a.PolyTyp==l.PolyType.ptSubject?(q=this.m_SubjFillType,k=this.m_ClipFillType):
(q=this.m_ClipFillType,k=this.m_SubjFillType);switch(m){case l.PolyFillType.pftPositive:m=f.WindCnt;break;case l.PolyFillType.pftNegative:m=-f.WindCnt;break;default:m=Math.abs(f.WindCnt)}switch(q){case l.PolyFillType.pftPositive:q=a.WindCnt;break;case l.PolyFillType.pftNegative:q=-a.WindCnt;break;default:q=Math.abs(a.WindCnt)}if(e&&g)d||c||0!==m&&1!=m||0!==q&&1!=q||f.PolyTyp!=a.PolyTyp&&this.m_ClipType!=l.ClipType.ctXor?this.AddLocalMaxPoly(f,a,b):(this.AddOutPt(f,b),this.AddOutPt(a,b),l.Clipper.SwapSides(f,
a),l.Clipper.SwapPolyIndexes(f,a));else if(e){if(0===q||1==q)this.AddOutPt(f,b),l.Clipper.SwapSides(f,a),l.Clipper.SwapPolyIndexes(f,a)}else if(g){if(0===m||1==m)this.AddOutPt(a,b),l.Clipper.SwapSides(f,a),l.Clipper.SwapPolyIndexes(f,a)}else if(!(0!==m&&1!=m||0!==q&&1!=q||d||c)){switch(u){case l.PolyFillType.pftPositive:e=f.WindCnt2;break;case l.PolyFillType.pftNegative:e=-f.WindCnt2;break;default:e=Math.abs(f.WindCnt2)}switch(k){case l.PolyFillType.pftPositive:g=a.WindCnt2;break;case l.PolyFillType.pftNegative:g=
-a.WindCnt2;break;default:g=Math.abs(a.WindCnt2)}if(f.PolyTyp!=a.PolyTyp)this.AddLocalMinPoly(f,a,b);else if(1==m&&1==q)switch(this.m_ClipType){case l.ClipType.ctIntersection:0<e&&0<g&&this.AddLocalMinPoly(f,a,b);break;case l.ClipType.ctUnion:0>=e&&0>=g&&this.AddLocalMinPoly(f,a,b);break;case l.ClipType.ctDifference:(f.PolyTyp==l.PolyType.ptClip&&0<e&&0<g||f.PolyTyp==l.PolyType.ptSubject&&0>=e&&0>=g)&&this.AddLocalMinPoly(f,a,b);break;case l.ClipType.ctXor:this.AddLocalMinPoly(f,a,b)}else l.Clipper.SwapSides(f,
a)}d!=c&&(d&&0<=f.OutIdx||c&&0<=a.OutIdx)&&(l.Clipper.SwapSides(f,a),l.Clipper.SwapPolyIndexes(f,a));d&&this.DeleteFromAEL(f);c&&this.DeleteFromAEL(a)}};l.Clipper.prototype.DeleteFromAEL=function(a){var b=a.PrevInAEL,c=a.NextInAEL;if(null!==b||null!==c||a==this.m_ActiveEdges)null!==b?b.NextInAEL=c:this.m_ActiveEdges=c,null!==c&&(c.PrevInAEL=b),a.NextInAEL=null,a.PrevInAEL=null};l.Clipper.prototype.DeleteFromSEL=function(a){var b=a.PrevInSEL,c=a.NextInSEL;if(null!==b||null!==c||a==this.m_SortedEdges)null!==
b?b.NextInSEL=c:this.m_SortedEdges=c,null!==c&&(c.PrevInSEL=b),a.NextInSEL=null,a.PrevInSEL=null};l.Clipper.prototype.UpdateEdgeIntoAEL=function(a){null===a.Value.NextInLML&&l.Error("UpdateEdgeIntoAEL: invalid call");var b=a.Value.PrevInAEL,c=a.Value.NextInAEL;a.Value.NextInLML.OutIdx=a.Value.OutIdx;null!==b?b.NextInAEL=a.Value.NextInLML:this.m_ActiveEdges=a.Value.NextInLML;null!==c&&(c.PrevInAEL=a.Value.NextInLML);a.Value.NextInLML.Side=a.Value.Side;a.Value.NextInLML.WindDelta=a.Value.WindDelta;
a.Value.NextInLML.WindCnt=a.Value.WindCnt;a.Value.NextInLML.WindCnt2=a.Value.WindCnt2;a.Value=a.Value.NextInLML;a.Value.Curr.X=a.Value.Bot.X;a.Value.Curr.Y=a.Value.Bot.Y;a.Value.PrevInAEL=b;a.Value.NextInAEL=c;l.ClipperBase.IsHorizontal(a.Value)||this.InsertScanbeam(a.Value.Top.Y)};l.Clipper.prototype.ProcessHorizontals=function(a){for(var b=this.m_SortedEdges;null!==b;)this.DeleteFromSEL(b),this.ProcessHorizontal(b,a),b=this.m_SortedEdges};l.Clipper.prototype.GetHorzDirection=function(a,b,c,d){a.Bot.X<
a.Top.X?(c.Value=a.Bot.X,d.Value=a.Top.X,b.Value=l.Direction.dLeftToRight):(c.Value=a.Top.X,d.Value=a.Bot.X,b.Value=l.Direction.dRightToLeft)};l.Clipper.prototype.PrepareHorzJoins=function(a,b){var c=this.m_PolyOuts[a.OutIdx].Pts;a.Side!=l.EdgeSide.esLeft&&(c=c.Prev);for(var d=0,e=this.m_GhostJoins.length;d<e;++d){var g=this.m_GhostJoins[d];this.HorzSegmentsOverlap(g.OutPt1.Pt,g.OffPt,a.Bot,a.Top)&&this.AddJoin(g.OutPt1,c,g.OffPt)}b&&(l.IntPoint.op_Equality(c.Pt,a.Top)?this.AddGhostJoin(c,a.Bot):
this.AddGhostJoin(c,a.Top))};l.Clipper.prototype.ProcessHorizontal=function(a,b){var c,d,e;(function(){c={Value:c};d={Value:d};e={Value:e};var b=this.GetHorzDirection(a,c,d,e);c=c.Value;d=d.Value;e=e.Value;return b}).call(this);for(var g=a,k=null;null!==g.NextInLML&&l.ClipperBase.IsHorizontal(g.NextInLML);)g=g.NextInLML;for(null===g.NextInLML&&(k=this.GetMaximaPair(g));;){for(var m=a==g,q=this.GetNextInAEL(a,c);null!==q&&!(q.Curr.X==a.Top.X&&null!==a.NextInLML&&q.Dx<a.NextInLML.Dx);){var u=this.GetNextInAEL(q,
c);if(c==l.Direction.dLeftToRight&&q.Curr.X<=e||c==l.Direction.dRightToLeft&&q.Curr.X>=d){0<=a.OutIdx&&0!=a.WindDelta&&this.PrepareHorzJoins(a,b);if(q==k&&m){c==l.Direction.dLeftToRight?this.IntersectEdges(a,q,q.Top,!1):this.IntersectEdges(q,a,q.Top,!1);0<=k.OutIdx&&l.Error("ProcessHorizontal error");return}if(c==l.Direction.dLeftToRight){var v=new l.IntPoint(q.Curr.X,a.Curr.Y);this.IntersectEdges(a,q,v,!0)}else v=new l.IntPoint(q.Curr.X,a.Curr.Y),this.IntersectEdges(q,a,v,!0);this.SwapPositionsInAEL(a,
q)}else if(c==l.Direction.dLeftToRight&&q.Curr.X>=e||c==l.Direction.dRightToLeft&&q.Curr.X<=d)break;q=u}0<=a.OutIdx&&0!==a.WindDelta&&this.PrepareHorzJoins(a,b);if(null!==a.NextInLML&&l.ClipperBase.IsHorizontal(a.NextInLML))(function(){a={Value:a};var b=this.UpdateEdgeIntoAEL(a);a=a.Value;return b}).call(this),0<=a.OutIdx&&this.AddOutPt(a,a.Bot),function(){c={Value:c};d={Value:d};e={Value:e};var b=this.GetHorzDirection(a,c,d,e);c=c.Value;d=d.Value;e=e.Value;return b}.call(this);else break}null!==
a.NextInLML?0<=a.OutIdx?(g=this.AddOutPt(a,a.Top),function(){a={Value:a};var b=this.UpdateEdgeIntoAEL(a);a=a.Value;return b}.call(this),0!==a.WindDelta&&(k=a.PrevInAEL,u=a.NextInAEL,null!==k&&k.Curr.X==a.Bot.X&&k.Curr.Y==a.Bot.Y&&0!==k.WindDelta&&0<=k.OutIdx&&k.Curr.Y>k.Top.Y&&l.ClipperBase.SlopesEqual(a,k,this.m_UseFullRange)?(u=this.AddOutPt(k,a.Bot),this.AddJoin(g,u,a.Top)):null!==u&&u.Curr.X==a.Bot.X&&u.Curr.Y==a.Bot.Y&&0!==u.WindDelta&&0<=u.OutIdx&&u.Curr.Y>u.Top.Y&&l.ClipperBase.SlopesEqual(a,
u,this.m_UseFullRange)&&(u=this.AddOutPt(u,a.Bot),this.AddJoin(g,u,a.Top)))):function(){a={Value:a};var b=this.UpdateEdgeIntoAEL(a);a=a.Value;return b}.call(this):null!==k?0<=k.OutIdx?(c==l.Direction.dLeftToRight?this.IntersectEdges(a,k,a.Top,!1):this.IntersectEdges(k,a,a.Top,!1),0<=k.OutIdx&&l.Error("ProcessHorizontal error")):(this.DeleteFromAEL(a),this.DeleteFromAEL(k)):(0<=a.OutIdx&&this.AddOutPt(a,a.Top),this.DeleteFromAEL(a))};l.Clipper.prototype.GetNextInAEL=function(a,b){return b==l.Direction.dLeftToRight?
a.NextInAEL:a.PrevInAEL};l.Clipper.prototype.IsMinima=function(a){return null!==a&&a.Prev.NextInLML!=a&&a.Next.NextInLML!=a};l.Clipper.prototype.IsMaxima=function(a,b){return null!==a&&a.Top.Y==b&&null===a.NextInLML};l.Clipper.prototype.IsIntermediate=function(a,b){return a.Top.Y==b&&null!==a.NextInLML};l.Clipper.prototype.GetMaximaPair=function(a){var b=null;l.IntPoint.op_Equality(a.Next.Top,a.Top)&&null===a.Next.NextInLML?b=a.Next:l.IntPoint.op_Equality(a.Prev.Top,a.Top)&&null===a.Prev.NextInLML&&
(b=a.Prev);return null===b||-2!=b.OutIdx&&(b.NextInAEL!=b.PrevInAEL||l.ClipperBase.IsHorizontal(b))?b:null};l.Clipper.prototype.ProcessIntersections=function(a,b){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(a,b);if(0==this.m_IntersectList.length)return!0;if(1==this.m_IntersectList.length||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch(c){this.m_SortedEdges=null,this.m_IntersectList.length=0,l.Error("ProcessIntersections error")}this.m_SortedEdges=
null;return!0};l.Clipper.prototype.BuildIntersectList=function(a,b){if(null!==this.m_ActiveEdges){var c=this.m_ActiveEdges;for(this.m_SortedEdges=c;null!==c;)c.PrevInSEL=c.PrevInAEL,c.NextInSEL=c.NextInAEL,c.Curr.X=l.Clipper.TopX(c,b),c=c.NextInAEL;for(var d=!0;d&&null!==this.m_SortedEdges;){d=!1;for(c=this.m_SortedEdges;null!==c.NextInSEL;){var e=c.NextInSEL,g=new l.IntPoint;c.Curr.X>e.Curr.X?(g={Value:g},d=this.IntersectPoint(c,e,g),g=g.Value,!d&&c.Curr.X>e.Curr.X+1&&l.Error("Intersection error"),
g.Y>a&&(g.Y=a,Math.abs(c.Dx)>Math.abs(e.Dx)?g.X=l.Clipper.TopX(e,a):g.X=l.Clipper.TopX(c,a)),d=new l.IntersectNode,d.Edge1=c,d.Edge2=e,d.Pt.X=g.X,d.Pt.Y=g.Y,this.m_IntersectList.push(d),this.SwapPositionsInSEL(c,e),d=!0):c=e}if(null!==c.PrevInSEL)c.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}};l.Clipper.prototype.EdgesAdjacent=function(a){return a.Edge1.NextInSEL==a.Edge2||a.Edge1.PrevInSEL==a.Edge2};l.Clipper.IntersectNodeSort=function(a,b){return b.Pt.Y-a.Pt.Y};l.Clipper.prototype.FixupIntersectionOrder=
function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();for(var a=this.m_IntersectList.length,b=0;b<a;b++){if(!this.EdgesAdjacent(this.m_IntersectList[b])){for(var c=b+1;c<a&&!this.EdgesAdjacent(this.m_IntersectList[c]);)c++;if(c==a)return!1;var d=this.m_IntersectList[b];this.m_IntersectList[b]=this.m_IntersectList[c];this.m_IntersectList[c]=d}this.SwapPositionsInSEL(this.m_IntersectList[b].Edge1,this.m_IntersectList[b].Edge2)}return!0};l.Clipper.prototype.ProcessIntersectList=
function(){for(var a=0,b=this.m_IntersectList.length;a<b;a++){var c=this.m_IntersectList[a];this.IntersectEdges(c.Edge1,c.Edge2,c.Pt,!0);this.SwapPositionsInAEL(c.Edge1,c.Edge2)}this.m_IntersectList.length=0};O=function(a){return 0>a?Math.ceil(a-.5):Math.round(a)};ea=function(a){return 0>a?Math.ceil(a-.5):Math.floor(a+.5)};fa=function(a){return 0>a?-Math.round(Math.abs(a)):Math.round(a)};z=function(a){if(0>a)return a-=.5,-2147483648>a?Math.ceil(a):a|0;a+=.5;return 2147483647<a?Math.floor(a):a|0};
l.Clipper.Round=S?O:L?fa:Y?z:ea;l.Clipper.TopX=function(a,b){return b==a.Top.Y?a.Top.X:a.Bot.X+l.Clipper.Round(a.Dx*(b-a.Bot.Y))};l.Clipper.prototype.IntersectPoint=function(a,b,c){c.Value=new l.IntPoint;var d,e;if(l.ClipperBase.SlopesEqual(a,b,this.m_UseFullRange)||a.Dx==b.Dx)return b.Bot.Y>a.Bot.Y?(c.Value.X=b.Bot.X,c.Value.Y=b.Bot.Y):(c.Value.X=a.Bot.X,c.Value.Y=a.Bot.Y),!1;if(0===a.Delta.X)c.Value.X=a.Bot.X,l.ClipperBase.IsHorizontal(b)?c.Value.Y=b.Bot.Y:(e=b.Bot.Y-b.Bot.X/b.Dx,c.Value.Y=l.Clipper.Round(c.Value.X/
b.Dx+e));else if(0===b.Delta.X)c.Value.X=b.Bot.X,l.ClipperBase.IsHorizontal(a)?c.Value.Y=a.Bot.Y:(d=a.Bot.Y-a.Bot.X/a.Dx,c.Value.Y=l.Clipper.Round(c.Value.X/a.Dx+d));else{d=a.Bot.X-a.Bot.Y*a.Dx;e=b.Bot.X-b.Bot.Y*b.Dx;var g=(e-d)/(a.Dx-b.Dx);c.Value.Y=l.Clipper.Round(g);Math.abs(a.Dx)<Math.abs(b.Dx)?c.Value.X=l.Clipper.Round(a.Dx*g+d):c.Value.X=l.Clipper.Round(b.Dx*g+e)}if(c.Value.Y<a.Top.Y||c.Value.Y<b.Top.Y){if(a.Top.Y>b.Top.Y)return c.Value.Y=a.Top.Y,c.Value.X=l.Clipper.TopX(b,a.Top.Y),c.Value.X<
a.Top.X;c.Value.Y=b.Top.Y;Math.abs(a.Dx)<Math.abs(b.Dx)?c.Value.X=l.Clipper.TopX(a,c.Value.Y):c.Value.X=l.Clipper.TopX(b,c.Value.Y)}return!0};l.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(a){for(var b=this.m_ActiveEdges;null!==b;){var c=this.IsMaxima(b,a);c&&(c=this.GetMaximaPair(b),c=null===c||!l.ClipperBase.IsHorizontal(c));if(c){var d=b.PrevInAEL;this.DoMaxima(b);b=null===d?this.m_ActiveEdges:d.NextInAEL}else this.IsIntermediate(b,a)&&l.ClipperBase.IsHorizontal(b.NextInLML)?(function(){b=
{Value:b};var a=this.UpdateEdgeIntoAEL(b);b=b.Value;return a}.call(this),0<=b.OutIdx&&this.AddOutPt(b,b.Bot),this.AddEdgeToSEL(b)):(b.Curr.X=l.Clipper.TopX(b,a),b.Curr.Y=a),this.StrictlySimple&&(d=b.PrevInAEL,0<=b.OutIdx&&0!==b.WindDelta&&null!==d&&0<=d.OutIdx&&d.Curr.X==b.Curr.X&&0!==d.WindDelta&&(c=this.AddOutPt(d,b.Curr),d=this.AddOutPt(b,b.Curr),this.AddJoin(c,d,b.Curr))),b=b.NextInAEL}this.ProcessHorizontals(!0);for(b=this.m_ActiveEdges;null!==b;){if(this.IsIntermediate(b,a)){c=null;0<=b.OutIdx&&
(c=this.AddOutPt(b,b.Top));(function(){b={Value:b};var a=this.UpdateEdgeIntoAEL(b);b=b.Value;return a}).call(this);var d=b.PrevInAEL,e=b.NextInAEL;null!==d&&d.Curr.X==b.Bot.X&&d.Curr.Y==b.Bot.Y&&null!==c&&0<=d.OutIdx&&d.Curr.Y>d.Top.Y&&l.ClipperBase.SlopesEqual(b,d,this.m_UseFullRange)&&0!==b.WindDelta&&0!==d.WindDelta?(d=this.AddOutPt(d,b.Bot),this.AddJoin(c,d,b.Top)):null!==e&&e.Curr.X==b.Bot.X&&e.Curr.Y==b.Bot.Y&&null!==c&&0<=e.OutIdx&&e.Curr.Y>e.Top.Y&&l.ClipperBase.SlopesEqual(b,e,this.m_UseFullRange)&&
0!==b.WindDelta&&0!==e.WindDelta&&(d=this.AddOutPt(e,b.Bot),this.AddJoin(c,d,b.Top))}b=b.NextInAEL}};l.Clipper.prototype.DoMaxima=function(a){var b=this.GetMaximaPair(a);if(null===b)0<=a.OutIdx&&this.AddOutPt(a,a.Top),this.DeleteFromAEL(a);else{for(var c=a.NextInAEL;null!==c&&c!=b;)this.IntersectEdges(a,c,a.Top,!0),this.SwapPositionsInAEL(a,c),c=a.NextInAEL;-1==a.OutIdx&&-1==b.OutIdx?(this.DeleteFromAEL(a),this.DeleteFromAEL(b)):0<=a.OutIdx&&0<=b.OutIdx?this.IntersectEdges(a,b,a.Top,!1):0===a.WindDelta?
(0<=a.OutIdx&&(this.AddOutPt(a,a.Top),a.OutIdx=-1),this.DeleteFromAEL(a),0<=b.OutIdx&&(this.AddOutPt(b,a.Top),b.OutIdx=-1),this.DeleteFromAEL(b)):l.Error("DoMaxima error")}};l.Clipper.ReversePaths=function(a){for(var b=0,c=a.length;b<c;b++)a[b].reverse()};l.Clipper.Orientation=function(a){return 0<=l.Clipper.Area(a)};l.Clipper.prototype.PointCount=function(a){if(null===a)return 0;var b=0,c=a;do b++,c=c.Next;while(c!=a);return b};l.Clipper.prototype.BuildResult=function(a){l.Clear(a);for(var b=0,c=
this.m_PolyOuts.length;b<c;b++){var d=this.m_PolyOuts[b];if(null!==d.Pts){var d=d.Pts.Prev,e=this.PointCount(d);if(!(2>e)){for(var g=Array(e),k=0;k<e;k++)g[k]=d.Pt,d=d.Prev;a.push(g)}}}};l.Clipper.prototype.BuildResult2=function(a){a.Clear();for(var b=0,c=this.m_PolyOuts.length;b<c;b++){var d=this.m_PolyOuts[b],e=this.PointCount(d.Pts);if(!(d.IsOpen&&2>e||!d.IsOpen&&3>e)){this.FixHoleLinkage(d);var g=new l.PolyNode;a.m_AllPolys.push(g);d.PolyNode=g;g.m_polygon.length=e;for(var d=d.Pts.Prev,k=0;k<
e;k++)g.m_polygon[k]=d.Pt,d=d.Prev}}b=0;for(c=this.m_PolyOuts.length;b<c;b++)d=this.m_PolyOuts[b],null!==d.PolyNode&&(d.IsOpen?(d.PolyNode.IsOpen=!0,a.AddChild(d.PolyNode)):null!==d.FirstLeft&&null!=d.FirstLeft.PolyNode?d.FirstLeft.PolyNode.AddChild(d.PolyNode):a.AddChild(d.PolyNode))};l.Clipper.prototype.FixupOutPolygon=function(a){var b=null;a.BottomPt=null;for(var c=a.Pts;;){if(c.Prev==c||c.Prev==c.Next){this.DisposeOutPts(c);a.Pts=null;return}if(l.IntPoint.op_Equality(c.Pt,c.Next.Pt)||l.IntPoint.op_Equality(c.Pt,
c.Prev.Pt)||l.ClipperBase.SlopesEqual(c.Prev.Pt,c.Pt,c.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(c.Prev.Pt,c.Pt,c.Next.Pt)))b=null,c.Prev.Next=c.Next,c=c.Next.Prev=c.Prev;else if(c==b)break;else null===b&&(b=c),c=c.Next}a.Pts=c};l.Clipper.prototype.DupOutPt=function(a,b){var c=new l.OutPt;c.Pt.X=a.Pt.X;c.Pt.Y=a.Pt.Y;c.Idx=a.Idx;b?(c.Next=a.Next,c.Prev=a,a.Next.Prev=c,a.Next=c):(c.Prev=a.Prev,c.Next=a,a.Prev.Next=c,a.Prev=c);return c};l.Clipper.prototype.GetOverlap=
function(a,b,c,d,e,l){a<b?c<d?(e.Value=Math.max(a,c),l.Value=Math.min(b,d)):(e.Value=Math.max(a,d),l.Value=Math.min(b,c)):c<d?(e.Value=Math.max(b,c),l.Value=Math.min(a,d)):(e.Value=Math.max(b,d),l.Value=Math.min(a,c));return e.Value<l.Value};l.Clipper.prototype.JoinHorz=function(a,b,c,d,e,g){var k=a.Pt.X>b.Pt.X?l.Direction.dRightToLeft:l.Direction.dLeftToRight;d=c.Pt.X>d.Pt.X?l.Direction.dRightToLeft:l.Direction.dLeftToRight;if(k==d)return!1;if(k==l.Direction.dLeftToRight){for(;a.Next.Pt.X<=e.X&&
a.Next.Pt.X>=a.Pt.X&&a.Next.Pt.Y==e.Y;)a=a.Next;g&&a.Pt.X!=e.X&&(a=a.Next);b=this.DupOutPt(a,!g);l.IntPoint.op_Inequality(b.Pt,e)&&(a=b,a.Pt.X=e.X,a.Pt.Y=e.Y,b=this.DupOutPt(a,!g))}else{for(;a.Next.Pt.X>=e.X&&a.Next.Pt.X<=a.Pt.X&&a.Next.Pt.Y==e.Y;)a=a.Next;g||a.Pt.X==e.X||(a=a.Next);b=this.DupOutPt(a,g);l.IntPoint.op_Inequality(b.Pt,e)&&(a=b,a.Pt.X=e.X,a.Pt.Y=e.Y,b=this.DupOutPt(a,g))}if(d==l.Direction.dLeftToRight){for(;c.Next.Pt.X<=e.X&&c.Next.Pt.X>=c.Pt.X&&c.Next.Pt.Y==e.Y;)c=c.Next;g&&c.Pt.X!=
e.X&&(c=c.Next);d=this.DupOutPt(c,!g);l.IntPoint.op_Inequality(d.Pt,e)&&(c=d,c.Pt.X=e.X,c.Pt.Y=e.Y,d=this.DupOutPt(c,!g))}else{for(;c.Next.Pt.X>=e.X&&c.Next.Pt.X<=c.Pt.X&&c.Next.Pt.Y==e.Y;)c=c.Next;g||c.Pt.X==e.X||(c=c.Next);d=this.DupOutPt(c,g);l.IntPoint.op_Inequality(d.Pt,e)&&(c=d,c.Pt.X=e.X,c.Pt.Y=e.Y,d=this.DupOutPt(c,g))}k==l.Direction.dLeftToRight==g?(a.Prev=c,c.Next=a,b.Next=d,d.Prev=b):(a.Next=c,c.Prev=a,b.Prev=d,d.Next=b);return!0};l.Clipper.prototype.JoinPoints=function(a,b,c){var d=a.OutPt1,
e=new l.OutPt,g=a.OutPt2,k=new l.OutPt;if((k=a.OutPt1.Pt.Y==a.OffPt.Y)&&l.IntPoint.op_Equality(a.OffPt,a.OutPt1.Pt)&&l.IntPoint.op_Equality(a.OffPt,a.OutPt2.Pt)){for(e=a.OutPt1.Next;e!=d&&l.IntPoint.op_Equality(e.Pt,a.OffPt);)e=e.Next;e=e.Pt.Y>a.OffPt.Y;for(k=a.OutPt2.Next;k!=g&&l.IntPoint.op_Equality(k.Pt,a.OffPt);)k=k.Next;if(e==k.Pt.Y>a.OffPt.Y)return!1;e?(e=this.DupOutPt(d,!1),k=this.DupOutPt(g,!0),d.Prev=g,g.Next=d,e.Next=k,k.Prev=e):(e=this.DupOutPt(d,!0),k=this.DupOutPt(g,!1),d.Next=g,g.Prev=
d,e.Prev=k,k.Next=e);a.OutPt1=d;a.OutPt2=e;return!0}if(k){for(e=d;d.Prev.Pt.Y==d.Pt.Y&&d.Prev!=e&&d.Prev!=g;)d=d.Prev;for(;e.Next.Pt.Y==e.Pt.Y&&e.Next!=d&&e.Next!=g;)e=e.Next;if(e.Next==d||e.Next==g)return!1;for(k=g;g.Prev.Pt.Y==g.Pt.Y&&g.Prev!=k&&g.Prev!=e;)g=g.Prev;for(;k.Next.Pt.Y==k.Pt.Y&&k.Next!=g&&k.Next!=d;)k=k.Next;if(k.Next==g||k.Next==d)return!1;var m,q;m={Value:m};q={Value:q};b=this.GetOverlap(d.Pt.X,e.Pt.X,g.Pt.X,k.Pt.X,m,q);m=m.Value;q=q.Value;if(!b)return!1;b=new l.IntPoint;d.Pt.X>=
m&&d.Pt.X<=q?(b.X=d.Pt.X,b.Y=d.Pt.Y,c=d.Pt.X>e.Pt.X):g.Pt.X>=m&&g.Pt.X<=q?(b.X=g.Pt.X,b.Y=g.Pt.Y,c=g.Pt.X>k.Pt.X):e.Pt.X>=m&&e.Pt.X<=q?(b.X=e.Pt.X,b.Y=e.Pt.Y,c=e.Pt.X>d.Pt.X):(b.X=k.Pt.X,b.Y=k.Pt.Y,c=k.Pt.X>g.Pt.X);a.OutPt1=d;a.OutPt2=g;return this.JoinHorz(d,e,g,k,b,c)}for(e=d.Next;l.IntPoint.op_Equality(e.Pt,d.Pt)&&e!=d;)e=e.Next;if(m=e.Pt.Y>d.Pt.Y||!l.ClipperBase.SlopesEqual(d.Pt,e.Pt,a.OffPt,this.m_UseFullRange)){for(e=d.Prev;l.IntPoint.op_Equality(e.Pt,d.Pt)&&e!=d;)e=e.Prev;if(e.Pt.Y>d.Pt.Y||
!l.ClipperBase.SlopesEqual(d.Pt,e.Pt,a.OffPt,this.m_UseFullRange))return!1}for(k=g.Next;l.IntPoint.op_Equality(k.Pt,g.Pt)&&k!=g;)k=k.Next;if(q=k.Pt.Y>g.Pt.Y||!l.ClipperBase.SlopesEqual(g.Pt,k.Pt,a.OffPt,this.m_UseFullRange)){for(k=g.Prev;l.IntPoint.op_Equality(k.Pt,g.Pt)&&k!=g;)k=k.Prev;if(k.Pt.Y>g.Pt.Y||!l.ClipperBase.SlopesEqual(g.Pt,k.Pt,a.OffPt,this.m_UseFullRange))return!1}if(e==d||k==g||e==k||b==c&&m==q)return!1;m?(e=this.DupOutPt(d,!1),k=this.DupOutPt(g,!0),d.Prev=g,g.Next=d,e.Next=k,k.Prev=
e):(e=this.DupOutPt(d,!0),k=this.DupOutPt(g,!1),d.Next=g,g.Prev=d,e.Prev=k,k.Next=e);a.OutPt1=d;a.OutPt2=e;return!0};l.Clipper.GetBounds=function(a){for(var b=0,c=a.length;b<c&&0==a[b].length;)b++;if(b==c)return new l.IntRect(0,0,0,0);var d=new l.IntRect;d.left=a[b][0].X;d.right=d.left;d.top=a[b][0].Y;for(d.bottom=d.top;b<c;b++)for(var e=0,g=a[b].length;e<g;e++)a[b][e].X<d.left?d.left=a[b][e].X:a[b][e].X>d.right&&(d.right=a[b][e].X),a[b][e].Y<d.top?d.top=a[b][e].Y:a[b][e].Y>d.bottom&&(d.bottom=a[b][e].Y);
return d};l.Clipper.prototype.GetBounds2=function(a){var b=a,c=new l.IntRect;c.left=a.Pt.X;c.right=a.Pt.X;c.top=a.Pt.Y;c.bottom=a.Pt.Y;for(a=a.Next;a!=b;)a.Pt.X<c.left&&(c.left=a.Pt.X),a.Pt.X>c.right&&(c.right=a.Pt.X),a.Pt.Y<c.top&&(c.top=a.Pt.Y),a.Pt.Y>c.bottom&&(c.bottom=a.Pt.Y),a=a.Next;return c};l.ClipperBase.prototype.PointInPolygon=l.Clipper.prototype.PointInPolygon=function(){var b=arguments,c=b.length;if(2==c){for(var c=b[0],d=b[1],b=0,e=d;;){var l=d.Pt.X,g=d.Pt.Y,k=d.Next.Pt.X,m=d.Next.Pt.Y;
if(m==c.Y&&(k==c.X||g==c.Y&&k>c.X==l<c.X))return-1;if(g<c.Y!=m<c.Y)if(l>=c.X)if(k>c.X)b=1-b;else{l=(l-c.X)*(m-c.Y)-(k-c.X)*(g-c.Y);if(0==l)return-1;0<l==m>g&&(b=1-b)}else if(k>c.X){l=(l-c.X)*(m-c.Y)-(k-c.X)*(g-c.Y);if(0==l)return-1;0<l==m>g&&(b=1-b)}d=d.Next;if(e==d)break}return b}if(3==c){c=b[0];d=b[1];e=b[2];g=d;b=!1;if(e){do g.Pt.Y>c.Y!=g.Prev.Pt.Y>c.Y&&a.op_LessThan(new a(c.X-g.Pt.X),a.op_Division(a.Int128Mul(g.Prev.Pt.X-g.Pt.X,c.Y-g.Pt.Y),new a(g.Prev.Pt.Y-g.Pt.Y)))&&(b=!b),g=g.Next;while(g!=
d)}else{do g.Pt.Y>c.Y!=g.Prev.Pt.Y>c.Y&&c.X-g.Pt.X<(g.Prev.Pt.X-g.Pt.X)*(c.Y-g.Pt.Y)/(g.Prev.Pt.Y-g.Pt.Y)&&(b=!b),g=g.Next;while(g!=d)}return b}};l.Clipper.prototype.Poly2ContainsPoly1=function(a,b){var c=a;do{var d=this.PointInPolygon(c.Pt,b);if(0<=d)return 0!=d;c=c.Next}while(c!=a);return!0};l.Clipper.prototype.FixupFirstLefts1=function(a,b){for(var c=0,d=this.m_PolyOuts.length;c<d;c++){var e=this.m_PolyOuts[c];null!==e.Pts&&e.FirstLeft==a&&this.Poly2ContainsPoly1(e.Pts,b.Pts)&&(e.FirstLeft=b)}};
l.Clipper.prototype.FixupFirstLefts2=function(a,b){for(var c=0,d=this.m_PolyOuts,e=d.length,g=d[c];c<e;c++,g=d[c])g.FirstLeft==a&&(g.FirstLeft=b)};l.Clipper.ParseFirstLeft=function(a){for(;null!=a&&null==a.Pts;)a=a.FirstLeft;return a};l.Clipper.prototype.JoinCommonEdges=function(){for(var a=0,b=this.m_Joins.length;a<b;a++){var c=this.m_Joins[a],d=this.GetOutRec(c.OutPt1.Idx),e=this.GetOutRec(c.OutPt2.Idx);if(null!=d.Pts&&null!=e.Pts){var g;g=d==e?d:this.Param1RightOfParam2(d,e)?e:this.Param1RightOfParam2(e,
d)?d:this.GetLowermostRec(d,e);if(this.JoinPoints(c,d,e))if(d==e){d.Pts=c.OutPt1;d.BottomPt=null;e=this.CreateOutRec();e.Pts=c.OutPt2;this.UpdateOutPtIdxs(e);if(this.m_UsingPolyTree){g=0;for(var k=this.m_PolyOuts.length;g<k-1;g++){var m=this.m_PolyOuts[g];null!=m.Pts&&l.Clipper.ParseFirstLeft(m.FirstLeft)==d&&m.IsHole!=d.IsHole&&this.Poly2ContainsPoly1(m.Pts,c.OutPt2)&&(m.FirstLeft=e)}}this.Poly2ContainsPoly1(e.Pts,d.Pts)?(e.IsHole=!d.IsHole,e.FirstLeft=d,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,
d),(e.IsHole^this.ReverseSolution)==0<this.Area(e)&&this.ReversePolyPtLinks(e.Pts)):this.Poly2ContainsPoly1(d.Pts,e.Pts)?(e.IsHole=d.IsHole,d.IsHole=!e.IsHole,e.FirstLeft=d.FirstLeft,d.FirstLeft=e,this.m_UsingPolyTree&&this.FixupFirstLefts2(d,e),(d.IsHole^this.ReverseSolution)==0<this.Area(d)&&this.ReversePolyPtLinks(d.Pts)):(e.IsHole=d.IsHole,e.FirstLeft=d.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(d,e))}else e.Pts=null,e.BottomPt=null,e.Idx=d.Idx,d.IsHole=g.IsHole,g==e&&(d.FirstLeft=
e.FirstLeft),e.FirstLeft=d,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,d)}}};l.Clipper.prototype.UpdateOutPtIdxs=function(a){var b=a.Pts;do b.Idx=a.Idx,b=b.Prev;while(b!=a.Pts)};l.Clipper.prototype.DoSimplePolygons=function(){for(var a=0;a<this.m_PolyOuts.length;){var b=this.m_PolyOuts[a++],c=b.Pts;if(null!==c){do{for(var d=c.Next;d!=b.Pts;){if(l.IntPoint.op_Equality(c.Pt,d.Pt)&&d.Next!=c&&d.Prev!=c){var e=c.Prev,g=d.Prev;c.Prev=g;g.Next=c;d.Prev=e;e.Next=d;b.Pts=c;e=this.CreateOutRec();e.Pts=d;
this.UpdateOutPtIdxs(e);this.Poly2ContainsPoly1(e.Pts,b.Pts)?(e.IsHole=!b.IsHole,e.FirstLeft=b):this.Poly2ContainsPoly1(b.Pts,e.Pts)?(e.IsHole=b.IsHole,b.IsHole=!e.IsHole,e.FirstLeft=b.FirstLeft,b.FirstLeft=e):(e.IsHole=b.IsHole,e.FirstLeft=b.FirstLeft);d=c}d=d.Next}c=c.Next}while(c!=b.Pts)}}};l.Clipper.Area=function(a){var b=a.length;if(3>b)return 0;for(var c=0,d=0,e=b-1;d<b;++d)c+=(a[e].X+a[d].X)*(a[e].Y-a[d].Y),e=d;return.5*-c};l.Clipper.prototype.Area=function(a){var b=a.Pts;if(null==b)return 0;
var c=0;do c+=(b.Prev.Pt.X+b.Pt.X)*(b.Prev.Pt.Y-b.Pt.Y),b=b.Next;while(b!=a.Pts);return.5*c};l.Clipper.SimplifyPolygon=function(a,b){var c=[],d=new l.Clipper(0);d.StrictlySimple=!0;d.AddPath(a,l.PolyType.ptSubject,!0);d.Execute(l.ClipType.ctUnion,c,b,b);return c};l.Clipper.SimplifyPolygons=function(a,b){"undefined"==typeof b&&(b=l.PolyFillType.pftEvenOdd);var c=[],d=new l.Clipper(0);d.StrictlySimple=!0;d.AddPaths(a,l.PolyType.ptSubject,!0);d.Execute(l.ClipType.ctUnion,c,b,b);return c};l.Clipper.DistanceSqrd=
function(a,b){var c=a.X-b.X,d=a.Y-b.Y;return c*c+d*d};l.Clipper.DistanceFromLineSqrd=function(a,b,c){var d=b.Y-c.Y;c=c.X-b.X;b=d*b.X+c*b.Y;b=d*a.X+c*a.Y-b;return b*b/(d*d+c*c)};l.Clipper.SlopesNearCollinear=function(a,b,c,d){return l.Clipper.DistanceFromLineSqrd(b,a,c)<d};l.Clipper.PointsAreClose=function(a,b,c){var d=a.X-b.X;a=a.Y-b.Y;return d*d+a*a<=c};l.Clipper.ExcludeOp=function(a){var b=a.Prev;b.Next=a.Next;a.Next.Prev=b;b.Idx=0;return b};l.Clipper.CleanPolygon=function(a,b){"undefined"==typeof b&&
(b=1.415);var c=a.length;if(0==c)return[];for(var d=Array(c),e=0;e<c;++e)d[e]=new l.OutPt;for(e=0;e<c;++e)d[e].Pt=a[e],d[e].Next=d[(e+1)%c],d[e].Next.Prev=d[e],d[e].Idx=0;e=b*b;for(d=d[0];0==d.Idx&&d.Next!=d.Prev;)l.Clipper.PointsAreClose(d.Pt,d.Prev.Pt,e)?(d=l.Clipper.ExcludeOp(d),c--):l.Clipper.PointsAreClose(d.Prev.Pt,d.Next.Pt,e)?(l.Clipper.ExcludeOp(d.Next),d=l.Clipper.ExcludeOp(d),c-=2):l.Clipper.SlopesNearCollinear(d.Prev.Pt,d.Pt,d.Next.Pt,e)?(d=l.Clipper.ExcludeOp(d),c--):(d.Idx=1,d=d.Next);
3>c&&(c=0);for(var g=Array(c),e=0;e<c;++e)g[e]=new l.IntPoint(d.Pt),d=d.Next;return g};l.Clipper.CleanPolygons=function(a,b){for(var c=Array(a.length),d=0,e=a.length;d<e;d++)c[d]=l.Clipper.CleanPolygon(a[d],b);return c};l.Clipper.Minkowski=function(a,b,c,d){var e=d?1:0,g=a.length,k=b.length;d=[];if(c)for(c=0;c<k;c++){for(var m=Array(g),q=0,u=a.length,v=a[q];q<u;q++,v=a[q])m[q]=new l.IntPoint(b[c].X+v.X,b[c].Y+v.Y);d.push(m)}else for(c=0;c<k;c++){m=Array(g);q=0;u=a.length;for(v=a[q];q<u;q++,v=a[q])m[q]=
new l.IntPoint(b[c].X-v.X,b[c].Y-v.Y);d.push(m)}a=[];for(c=0;c<=k-2+e;c++)for(q=0;q<=g-1;q++)b=[],b.push(d[c%k][q%g]),b.push(d[(c+1)%k][q%g]),b.push(d[(c+1)%k][(q+1)%g]),b.push(d[c%k][(q+1)%g]),l.Clipper.Orientation(b)||b.reverse(),a.push(b);e=new l.Clipper(0);e.AddPaths(a,l.PolyType.ptSubject,!0);e.Execute(l.ClipType.ctUnion,d,l.PolyFillType.pftNonZero,l.PolyFillType.pftNonZero);return d};l.Clipper.MinkowskiSum=function(a,b,c){return l.Clipper.Minkowski(a,b,!0,c)};l.Clipper.MinkowskiDiff=function(a,
b,c){return l.Clipper.Minkowski(a,b,!1,c)};l.Clipper.PolyTreeToPaths=function(a){var b=[];l.Clipper.AddPolyNodeToPaths(a,l.Clipper.NodeType.ntAny,b);return b};l.Clipper.AddPolyNodeToPaths=function(a,b,c){var d=!0;switch(b){case l.Clipper.NodeType.ntOpen:return;case l.Clipper.NodeType.ntClosed:d=!a.IsOpen}0<a.m_polygon.length&&d&&c.push(a.m_polygon);d=0;a=a.Childs();for(var e=a.length,g=a[d];d<e;d++,g=a[d])l.Clipper.AddPolyNodeToPaths(g,b,c)};l.Clipper.OpenPathsFromPolyTree=function(a){for(var b=new l.Paths,
c=0,d=a.ChildCount();c<d;c++)a.Childs()[c].IsOpen&&b.push(a.Childs()[c].m_polygon);return b};l.Clipper.ClosedPathsFromPolyTree=function(a){var b=new l.Paths;l.Clipper.AddPolyNodeToPaths(a,l.Clipper.NodeType.ntClosed,b);return b};sa(l.Clipper,l.ClipperBase);l.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};l.ClipperOffset=function(a,b){"undefined"==typeof a&&(a=2);"undefined"==typeof b&&(b=l.ClipperOffset.def_arc_tolerance);this.m_destPolys=new l.Paths;this.m_srcPoly=new l.Path;this.m_destPoly=new l.Path;
this.m_normals=[];this.m_StepsPerRad=this.m_miterLim=this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0;this.m_lowest=new l.IntPoint;this.m_polyNodes=new l.PolyNode;this.MiterLimit=a;this.ArcTolerance=b;this.m_lowest.X=-1};l.ClipperOffset.two_pi=6.28318530717959;l.ClipperOffset.def_arc_tolerance=.25;l.ClipperOffset.prototype.Clear=function(){l.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};l.ClipperOffset.Round=l.Clipper.Round;l.ClipperOffset.prototype.AddPath=function(a,b,c){var d=a.length-1;
if(!(0>d)){var e=new l.PolyNode;e.m_jointype=b;e.m_endtype=c;if(c==l.EndType.etClosedLine||c==l.EndType.etClosedPolygon)for(;0<d&&l.IntPoint.op_Equality(a[0],a[d]);)d--;e.m_polygon.push(a[0]);var g=0;b=0;for(var k=1;k<=d;k++)l.IntPoint.op_Inequality(e.m_polygon[g],a[k])&&(g++,e.m_polygon.push(a[k]),a[k].Y>e.m_polygon[b].Y||a[k].Y==e.m_polygon[b].Y&&a[k].X<e.m_polygon[b].X)&&(b=g);if(!(c==l.EndType.etClosedPolygon&&2>g||c!=l.EndType.etClosedPolygon&&0>g)&&(this.m_polyNodes.AddChild(e),c==l.EndType.etClosedPolygon))if(0>
this.m_lowest.X)this.m_lowest=new l.IntPoint(0,b);else if(a=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y],e.m_polygon[b].Y>a.Y||e.m_polygon[b].Y==a.Y&&e.m_polygon[b].X<a.X)this.m_lowest=new l.IntPoint(this.m_polyNodes.ChildCount()-1,b)}};l.ClipperOffset.prototype.AddPaths=function(a,b,c){for(var d=0,e=a.length;d<e;d++)this.AddPath(a[d],b,c)};l.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.X&&!l.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var a=
0;a<this.m_polyNodes.ChildCount();a++){var b=this.m_polyNodes.Childs()[a];(b.m_endtype==l.EndType.etClosedPolygon||b.m_endtype==l.EndType.etClosedLine&&l.Clipper.Orientation(b.m_polygon))&&b.m_polygon.reverse()}else for(a=0;a<this.m_polyNodes.ChildCount();a++)b=this.m_polyNodes.Childs()[a],b.m_endtype!=l.EndType.etClosedLine||l.Clipper.Orientation(b.m_polygon)||b.m_polygon.reverse()};l.ClipperOffset.GetUnitNormal=function(a,b){var c=b.X-a.X,d=b.Y-a.Y;if(0==c&&0==d)return new l.DoublePoint(0,0);var e=
1/Math.sqrt(c*c+d*d);return new l.DoublePoint(d*e,-(c*e))};l.ClipperOffset.prototype.DoOffset=function(a){this.m_destPolys=[];this.m_delta=a;if(l.ClipperBase.near_zero(a))for(var b=0;b<this.m_polyNodes.ChildCount();b++){var c=this.m_polyNodes.Childs()[b];c.m_endtype==l.EndType.etClosedPolygon&&this.m_destPolys.push(c.m_polygon)}else{this.m_miterLim=2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var b=0>=this.ArcTolerance?l.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(a)*l.ClipperOffset.def_arc_tolerance?
Math.abs(a)*l.ClipperOffset.def_arc_tolerance:this.ArcTolerance,d=3.14159265358979/Math.acos(1-b/Math.abs(a));this.m_sin=Math.sin(l.ClipperOffset.two_pi/d);this.m_cos=Math.cos(l.ClipperOffset.two_pi/d);this.m_StepsPerRad=d/l.ClipperOffset.two_pi;0>a&&(this.m_sin=-this.m_sin);for(b=0;b<this.m_polyNodes.ChildCount();b++){c=this.m_polyNodes.Childs()[b];this.m_srcPoly=c.m_polygon;var e=this.m_srcPoly.length;if(!(0==e||0>=a&&(3>e||c.m_endtype!=l.EndType.etClosedPolygon))){this.m_destPoly=[];if(1==e)if(c.m_jointype==
l.JoinType.jtRound)for(var c=1,e=0,g=1;g<=d;g++){this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[0].X+c*a),l.ClipperOffset.Round(this.m_srcPoly[0].Y+e*a)));var k=c,c=c*this.m_cos-this.m_sin*e,e=k*this.m_sin+e*this.m_cos}else for(e=c=-1,g=0;4>g;++g)this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[0].X+c*a),l.ClipperOffset.Round(this.m_srcPoly[0].Y+e*a))),0>c?c=1:0>e?e=1:c=-1;else{for(g=this.m_normals.length=0;g<e-1;g++)this.m_normals.push(l.ClipperOffset.GetUnitNormal(this.m_srcPoly[g],
this.m_srcPoly[g+1]));c.m_endtype==l.EndType.etClosedLine||c.m_endtype==l.EndType.etClosedPolygon?this.m_normals.push(l.ClipperOffset.GetUnitNormal(this.m_srcPoly[e-1],this.m_srcPoly[0])):this.m_normals.push(new l.DoublePoint(this.m_normals[e-2]));if(c.m_endtype==l.EndType.etClosedPolygon)for(k=e-1,g=0;g<e;g++)k=this.OffsetPoint(g,k,c.m_jointype);else if(c.m_endtype==l.EndType.etClosedLine){k=e-1;for(g=0;g<e;g++)k=this.OffsetPoint(g,k,c.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=
[];k=this.m_normals[e-1];for(g=e-1;0<g;g--)this.m_normals[g]=new l.DoublePoint(-this.m_normals[g-1].X,-this.m_normals[g-1].Y);this.m_normals[0]=new l.DoublePoint(-k.X,-k.Y);k=0;for(g=e-1;0<=g;g--)k=this.OffsetPoint(g,k,c.m_jointype)}else{k=0;for(g=1;g<e-1;++g)k=this.OffsetPoint(g,k,c.m_jointype);c.m_endtype==l.EndType.etOpenButt?(g=e-1,k=new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[g].X+this.m_normals[g].X*a),l.ClipperOffset.Round(this.m_srcPoly[g].Y+this.m_normals[g].Y*a)),this.m_destPoly.push(k),
k=new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[g].X-this.m_normals[g].X*a),l.ClipperOffset.Round(this.m_srcPoly[g].Y-this.m_normals[g].Y*a)),this.m_destPoly.push(k)):(g=e-1,k=e-2,this.m_sinA=0,this.m_normals[g]=new l.DoublePoint(-this.m_normals[g].X,-this.m_normals[g].Y),c.m_endtype==l.EndType.etOpenSquare?this.DoSquare(g,k):this.DoRound(g,k));for(g=e-1;0<g;g--)this.m_normals[g]=new l.DoublePoint(-this.m_normals[g-1].X,-this.m_normals[g-1].Y);this.m_normals[0]=new l.DoublePoint(-this.m_normals[1].X,
-this.m_normals[1].Y);k=e-1;for(g=k-1;0<g;--g)k=this.OffsetPoint(g,k,c.m_jointype);c.m_endtype==l.EndType.etOpenButt?(k=new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*a),l.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*a)),this.m_destPoly.push(k),k=new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*a),l.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*a)),this.m_destPoly.push(k)):(this.m_sinA=0,c.m_endtype==l.EndType.etOpenSquare?
this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}};l.ClipperOffset.prototype.Execute=function(){var a=arguments;if(a[0]instanceof l.PolyTree)if(b=a[0],c=a[1],b.Clear(),this.FixOrientations(),this.DoOffset(c),a=new l.Clipper(0),a.AddPaths(this.m_destPolys,l.PolyType.ptSubject,!0),0<c)a.Execute(l.ClipType.ctUnion,b,l.PolyFillType.pftPositive,l.PolyFillType.pftPositive);else if(c=l.Clipper.GetBounds(this.m_destPolys),d=new l.Path,d.push(new l.IntPoint(c.left-10,c.bottom+
10)),d.push(new l.IntPoint(c.right+10,c.bottom+10)),d.push(new l.IntPoint(c.right+10,c.top-10)),d.push(new l.IntPoint(c.left-10,c.top-10)),a.AddPath(d,l.PolyType.ptSubject,!0),a.ReverseSolution=!0,a.Execute(l.ClipType.ctUnion,b,l.PolyFillType.pftNegative,l.PolyFillType.pftNegative),1==b.ChildCount()&&0<b.Childs()[0].ChildCount())for(a=b.Childs()[0],b.Childs()[0]=a.Childs()[0],c=1;c<a.ChildCount();c++)b.AddChild(a.Childs()[c]);else b.Clear();else{var b=a[0],c=a[1];l.Clear(b);this.FixOrientations();
this.DoOffset(c);a=new l.Clipper(0);a.AddPaths(this.m_destPolys,l.PolyType.ptSubject,!0);if(0<c)a.Execute(l.ClipType.ctUnion,b,l.PolyFillType.pftPositive,l.PolyFillType.pftPositive);else{var c=l.Clipper.GetBounds(this.m_destPolys),d=new l.Path;d.push(new l.IntPoint(c.left-10,c.bottom+10));d.push(new l.IntPoint(c.right+10,c.bottom+10));d.push(new l.IntPoint(c.right+10,c.top-10));d.push(new l.IntPoint(c.left-10,c.top-10));a.AddPath(d,l.PolyType.ptSubject,!0);a.ReverseSolution=!0;a.Execute(l.ClipType.ctUnion,
b,l.PolyFillType.pftNegative,l.PolyFillType.pftNegative);0<b.length&&b.splice(0,1)}}};l.ClipperOffset.prototype.OffsetPoint=function(a,b,c){this.m_sinA=this.m_normals[b].X*this.m_normals[a].Y-this.m_normals[a].X*this.m_normals[b].Y;if(5E-5>this.m_sinA&&-5E-5<this.m_sinA)return b;1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1);if(0>this.m_sinA*this.m_delta)this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_normals[b].X*this.m_delta),l.ClipperOffset.Round(this.m_srcPoly[a].Y+
this.m_normals[b].Y*this.m_delta))),this.m_destPoly.push(new l.IntPoint(this.m_srcPoly[a])),this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_normals[a].X*this.m_delta),l.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_normals[a].Y*this.m_delta)));else switch(c){case l.JoinType.jtMiter:c=1+(this.m_normals[a].X*this.m_normals[b].X+this.m_normals[a].Y*this.m_normals[b].Y);c>=this.m_miterLim?this.DoMiter(a,b,c):this.DoSquare(a,b);break;case l.JoinType.jtSquare:this.DoSquare(a,
b);break;case l.JoinType.jtRound:this.DoRound(a,b)}return a};l.ClipperOffset.prototype.DoSquare=function(a,b){var c=Math.tan(Math.atan2(this.m_sinA,this.m_normals[b].X*this.m_normals[a].X+this.m_normals[b].Y*this.m_normals[a].Y)/4);this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_delta*(this.m_normals[b].X-this.m_normals[b].Y*c)),l.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_delta*(this.m_normals[b].Y+this.m_normals[b].X*c))));this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[a].X+
this.m_delta*(this.m_normals[a].X+this.m_normals[a].Y*c)),l.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_delta*(this.m_normals[a].Y-this.m_normals[a].X*c))))};l.ClipperOffset.prototype.DoMiter=function(a,b,c){c=this.m_delta/c;this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[a].X+(this.m_normals[b].X+this.m_normals[a].X)*c),l.ClipperOffset.Round(this.m_srcPoly[a].Y+(this.m_normals[b].Y+this.m_normals[a].Y)*c)))};l.ClipperOffset.prototype.DoRound=function(a,b){for(var c=Math.atan2(this.m_sinA,
this.m_normals[b].X*this.m_normals[a].X+this.m_normals[b].Y*this.m_normals[a].Y),c=l.Cast_Int32(l.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(c))),d=this.m_normals[b].X,e=this.m_normals[b].Y,g,k=0;k<c;++k)this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[a].X+d*this.m_delta),l.ClipperOffset.Round(this.m_srcPoly[a].Y+e*this.m_delta))),g=d,d=d*this.m_cos-this.m_sin*e,e=g*this.m_sin+e*this.m_cos;this.m_destPoly.push(new l.IntPoint(l.ClipperOffset.Round(this.m_srcPoly[a].X+
this.m_normals[a].X*this.m_delta),l.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_normals[a].Y*this.m_delta)))};l.Error=function(a){try{throw Error(a);}catch(b){alert(b.message)}};l.JS={};l.JS.AreaOfPolygon=function(a,b){b||(b=1);return l.Clipper.Area(a)/(b*b)};l.JS.AreaOfPolygons=function(a,b){b||(b=1);for(var c=0,d=0;d<a.length;d++)c+=l.Clipper.Area(a[d]);return c/(b*b)};l.JS.BoundsOfPath=function(a,b){return l.JS.BoundsOfPaths([a],b)};l.JS.BoundsOfPaths=function(a,b){b||(b=1);var c=l.Clipper.GetBounds(a);
c.left/=b;c.bottom/=b;c.right/=b;c.top/=b;return c};l.JS.Clean=function(a,b){if(!(a instanceof Array))return[];var c=a[0]instanceof Array;a=l.JS.Clone(a);if("number"!=typeof b||null===b)return l.Error("Delta is not a number in Clean()."),a;if(0===a.length||1==a.length&&0===a[0].length||0>b)return a;c||(a=[a]);for(var d=a.length,e,g,k,m,q,u,v,w=[],x=0;x<d;x++)if(g=a[x],e=g.length,0!==e)if(3>e)k=g,w.push(k);else{k=g;m=b*b;q=g[0];for(v=u=1;v<e;v++)(g[v].X-q.X)*(g[v].X-q.X)+(g[v].Y-q.Y)*(g[v].Y-q.Y)<=
m||(k[u]=g[v],q=g[v],u++);q=g[u-1];(g[0].X-q.X)*(g[0].X-q.X)+(g[0].Y-q.Y)*(g[0].Y-q.Y)<=m&&u--;u<e&&k.splice(u,e-u);k.length&&w.push(k)}!c&&w.length?w=w[0]:c||0!==w.length?c&&0===w.length&&(w=[[]]):w=[];return w};l.JS.Clone=function(a){if(!(a instanceof Array)||0===a.length)return[];if(1==a.length&&0===a[0].length)return[[]];var b=a[0]instanceof Array;b||(a=[a]);var c=a.length,d,e,g,k,l=Array(c);for(e=0;e<c;e++){d=a[e].length;k=Array(d);for(g=0;g<d;g++)k[g]={X:a[e][g].X,Y:a[e][g].Y};l[e]=k}b||(l=
l[0]);return l};l.JS.Lighten=function(a,b){if(!(a instanceof Array))return[];if("number"!=typeof b||null===b)return l.Error("Tolerance is not a number in Lighten()."),l.JS.Clone(a);if(0===a.length||1==a.length&&0===a[0].length||0>b)return l.JS.Clone(a);a[0]instanceof Array||(a=[a]);var c,d,e,g,k,m,q,u,v,w,x,z,C,D,E,G=a.length,H=b*b,L=[];for(c=0;c<G;c++)if(e=a[c],m=e.length,0!=m){for(g=0;1E6>g;g++){k=[];m=e.length;e[m-1].X!=e[0].X||e[m-1].Y!=e[0].Y?(x=1,e.push({X:e[0].X,Y:e[0].Y}),m=e.length):x=0;
w=[];for(d=0;d<m-2;d++){q=e[d];v=e[d+1];u=e[d+2];D=q.X;E=q.Y;q=u.X-D;z=u.Y-E;if(0!==q||0!==z)C=((v.X-D)*q+(v.Y-E)*z)/(q*q+z*z),1<C?(D=u.X,E=u.Y):0<C&&(D+=q*C,E+=z*C);q=v.X-D;z=v.Y-E;u=q*q+z*z;u<=H&&(w[d+1]=1,d++)}k.push({X:e[0].X,Y:e[0].Y});for(d=1;d<m-1;d++)w[d]||k.push({X:e[d].X,Y:e[d].Y});k.push({X:e[m-1].X,Y:e[m-1].Y});x&&e.pop();if(w.length)e=k;else break}m=k.length;k[m-1].X==k[0].X&&k[m-1].Y==k[0].Y&&k.pop();2<k.length&&L.push(k)}a[0]instanceof Array||(L=L[0]);"undefined"==typeof L&&(L=[[]]);
return L};l.JS.PerimeterOfPath=function(a,b,c){if("undefined"==typeof a)return 0;var d=Math.sqrt,e=0,g,k,l=0,m=0,q=a.length;if(2>q)return 0;for(b&&(a[q]=a[0],q++);--q;)g=a[q],l=g.X,g=g.Y,k=a[q-1],m=k.X,k=k.Y,e+=d((l-m)*(l-m)+(g-k)*(g-k));b&&a.pop();return e/c};l.JS.PerimeterOfPaths=function(a,b,c){c||(c=1);for(var d=0,e=0;e<a.length;e++)d+=l.JS.PerimeterOfPath(a[e],b,c);return d};l.JS.ScaleDownPath=function(a,b){var c,d;b||(b=1);for(c=a.length;c--;)d=a[c],d.X/=b,d.Y/=b};l.JS.ScaleDownPaths=function(a,
b){var c,d,e;b||(b=1);for(c=a.length;c--;)for(d=a[c].length;d--;)e=a[c][d],e.X/=b,e.Y/=b};l.JS.ScaleUpPath=function(a,b){var c,d,e=Math.round;b||(b=1);for(c=a.length;c--;)d=a[c],d.X=e(d.X*b),d.Y=e(d.Y*b)};l.JS.ScaleUpPaths=function(a,b){var c,d,e,g=Math.round;b||(b=1);for(c=a.length;c--;)for(d=a[c].length;d--;)e=a[c][d],e.X=g(e.X*b),e.Y=g(e.Y*b)};l.ExPolygons=function(){return[]};l.ExPolygon=function(){this.holes=this.outer=null};l.JS.AddOuterPolyNodeToExPolygons=function(a,b){var c=new l.ExPolygon;
c.outer=a.Contour();var d=a.Childs(),e=d.length;c.holes=Array(e);var g,k,m,q,u;for(k=0;k<e;k++)for(g=d[k],c.holes[k]=g.Contour(),m=0,q=g.Childs(),u=q.length;m<u;m++)g=q[m],l.JS.AddOuterPolyNodeToExPolygons(g,b);b.push(c)};l.JS.ExPolygonsToPaths=function(a){var b,c,d,e,g=new l.Paths;b=0;for(d=a.length;b<d;b++)for(g.push(a[b].outer),c=0,e=a[b].holes.length;c<e;c++)g.push(a[b].holes[c]);return g};l.JS.PolyTreeToExPolygons=function(a){var b=new l.ExPolygons,c,d,e;c=0;d=a.Childs();for(e=d.length;c<e;c++)a=
d[c],l.JS.AddOuterPolyNodeToExPolygons(a,b);return b}})();
var createCindy=function(){function a(a){if(0===d)return console.error("Waiting for "+a+" after we finished waiting."),function(){};0>d&&(d=0);++d;return function(){--d;0>d&&console.error("Wait count mismatch: "+a);if(0===d)for(var b=0,k=c.length;b<k;)c[b++].startup()}}function b(a){var e=b.newInstance(a);0>=d?e.startup():!1!==a.autostart&&c.push(e);"undefined"!==typeof window&&(window.evokeCS=e.evokeCS,window.csplay=e.play,window.cspause=e.pause,window.csstop=e.stop);return e}var d=-1,c=[];"undefined"===
typeof document||"undefined"===typeof window||"undefined"===typeof document.addEventListener||"undefined"!==typeof window.cindyDontWait&&!0===window.cindyDontWait||document.addEventListener("DOMContentLoaded",a("DOMContentLoaded"));"undefined"!==typeof window&&"undefined"!==typeof window.__gwt_activeModules&&(Object.keys(window.__gwt_activeModules).forEach(function(b){b=window.__gwt_activeModules[b];b.cindyDoneWaiting=a(b.moduleName)}),window.__gwtStatsEvent=function(a){"moduleStartup"===a.evtGroup&&
"end"===a.type&&window.__gwt_activeModules[a.moduleName].cindyDoneWaiting()});b.waitFor=a;b._pluginRegistry={};b.instances=[];b.registerPlugin=function(a,c,d){if(1!==a)return console.error("Plugin API version "+a+" not supported"),!1;b._pluginRegistry[c]=d};b.newInstance=function(a){function b(h){if(h){for(var a=0;a<h.length;a++){var r=h[a],c=Object.keys(r)[0];"scale"===c&&(ib=r.scale,B[c](r.scale));if("translate"===c)B[c](r.translate[0],r.translate[1]);"scaleAndOrigin"===c&&(ib=r[c][0]/25,B[c].apply(null,
r[c]));"visibleRect"===c&&(B[c].apply(null,r[c]),ib=B.drawingstate.initialmatrix.a/25)}B.createnewbackup()}}function c(){null!==Wa&&(ya.set(Wa.state),Object.keys(Wa.speeds).forEach(function(h){var a=P.csnames[h];"undefined"!==typeof a.behavior&&(h=Wa.speeds[h],a.behavior.vx=h[0],a.behavior.vy=h[1],a.behavior.vz=h[2],a.behavior.fx=0,a.behavior.fy=0,a.behavior.fz=0)}),ac())}function d(){if(!Ra){if(jb){var h=Wa?Wa.state:new Float64Array(ya.length);h.set(ya);for(var a={},r=0;r<P.points.length;r++){var b=
P.points[r];"undefined"!==typeof b.behavior&&(a[b.name]=[b.behavior.vx,b.behavior.vy,b.behavior.vz])}Wa={state:h,speeds:a};jb=!1}"function"===typeof rb&&sb&&bc(Ea);Ra=!0;G()}}function m(){Ra&&(Ra=!1)}function u(){jb||(Ra=!1,jb=!0,c())}function v(){if(!tb){tb=!0;for(var h=Xa.instances.length;0<h;)if(Xa.instances[--h]===Ma){Xa.instances.splice(h,1);break}for(h=bb.length;0<h;)try{bb[--h]()}catch(a){console.error(a)}}}function w(h){for(var a=null,r=1E6,b,c=0;c<P.free.length;c++){var d=P.free[c];if(!d.pinned){var e,
f,g,k=B.drawingstate.matrix.sdet;if("P"===d.kind){var l=n.normalizeZ(d.homog);if(!n._helper.isAlmostReal(l))continue;e=l.value[0].value.real-h.x;f=l.value[1].value.real-h.y;g=Math.sqrt(e*e+f*f);d.narrow&g>20/k&&(g=1E4)}else"C"===d.kind?(f=P.csnames[d.args[0]],g=d.radius,e=p.div(f.homog.value[0],f.homog.value[2]).value.real,f=p.div(f.homog.value[1],f.homog.value[2]).value.real,e-=h.x,f-=h.y,g=Math.sqrt(e*e+f*f)-g.value.real,f=e=0,0>g&&(g=-g),g+=30/k):"L"===d.kind&&(e=d.homog,g=p,f=g.add(g.mult(e.value[0],
g.conjugate(e.value[0])),g.mult(e.value[1],g.conjugate(e.value[1]))),f=n.scaldiv(g.sqrt(f),e),g=f.value[0].value.real*h.x+f.value[1].value.real*h.y+f.value[2].value.real,e=f.value[0].value.real*g,f=f.value[1].value.real*g,0>g&&(g=-g),g+=1);g<r+.2/k&&(r=g,a=d,b={x:e,y:f})}}console.log("Moving "+(a?a.name:"nothing"));return null===a?null:{mover:a,offset:b,prev:{x:h.x,y:h.y}}}function x(h,a,r,b){void 0===b&&(b=!1);bb.push(function(){h.removeEventListener(a,r,b)});h.addEventListener(a,r,b)}function C(h,
a){function r(a){var r=h.getBoundingClientRect();a=B.to(a.clientX-r.left-h.clientLeft,a.clientY-r.top-h.clientTop);oa.prevx=oa.x;oa.prevy=oa.y;oa.x=a[0];oa.y=a[1];eb[0]=oa.x;eb[1]=oa.y}function b(h){oa.down=!1;xa=void 0;Ya();E();I(Ca.mouseup);h.preventDefault()}var c=null;"undefined"!==typeof MutationObserver&&(c=MutationObserver);c||"undefined"===typeof WebKitMutationObserver||(c=WebKitMutationObserver);c?(c=new c(function(a){document.body.contains(h)||v()}),c.observe(document.documentElement,{childList:!0,
subtree:!0}),bb.push(function(){c.disconnect()})):(x(h,"DOMNodeRemovedFromDocument",v),x(h,"DOMNodeRemoved",v));!0===a.keylistener?x(document,"keydown",function(h){l(h);return!1}):Ca.keydown&&(h.setAttribute("tabindex","0"),x(h,"mousedown",function(){h.focus()}),x(h,"keydown",function(h){9!==h.keyCode&&(l(h),h.preventDefault())}));x(h,"mousedown",function(h){oa.button=h.which;r(h);I(Ca.mousedown);xa=w(oa);G();oa.down=!0;h.preventDefault()});x(h,"mouseup",function(h){oa.down=!1;xa=void 0;Ya();I(Ca.mouseup);
E();h.preventDefault()});x(h,"mousemove",function(h){r(h);oa.down?I(Ca.mousedrag):I(Ca.mousemove);h.preventDefault()});x(h,"touchstart",function(h){r(h.targetTouches[0]);I(Ca.mousedown);oa.down=!0;xa=w(oa);G();h.preventDefault()},!1);x(h,"touchmove",function(h){r(h.targetTouches[0]);oa.down?I(Ca.mousedrag):I(Ca.mousemove);h.preventDefault()},!0);x(h,"touchend",b,!1);"undefined"!==typeof document&&document.body&&x(document.body,"touchcancel",b,!1);E()}function D(){if(tb)return!0;Ra&&(sb&&"undefined"!==
typeof Da&&Da.tick(),Ra&&I(Ca.tick));E();kb=Ra||oa.down;return!kb}function G(){kb||(kb=!0,ub.timer(D))}function E(){B.reset();M.save();M.clearRect(0,0,Aa,ua);0!==Sa&&I(Ib);cc();B.greset();dc();M.restore()}function l(h){h=window.event?event:h;h=h.charCode?h.charCode:h.keyCode;Jb=String.fromCharCode(h);Kb=h;I(Ca.keydown);E()}function L(h,a){if(a in h)return a;a=a.charAt(0).toUpperCase()+a.substring(1);for(var r=0,b=Lb.length;r<b;++r){var c=Lb[r]+a;if(c in h)return c}}function H(){var h=S(),h=O()-h;
24<h?(isFinite(h)&&(clearTimeout(lb),lb=setTimeout(H,h)),mb=0):(mb=1,Mb(H))}function S(){var h=Date.now();for(Ta=nb;Ta;)h>=Ta.t&&(Ta.f=Ta.c(h-Ta.t)),Ta=Ta.n;return h}function O(){for(var h,a=nb,r=Infinity;a;)a.f?a=h?h.n=a.n:nb=a.n:(a.t<r&&(r=a.t),a=(h=a).n);ob=h;return r}function Y(){this.ctype="undefined"}function ea(){this.ctype="void"}function fa(h){this.ctype="error";this.message=h}function z(h){if("undefined"===typeof h)return"_??_";if("undefined"===h.ctype)return"_?_";if("number"===h.ctype)return p.niceprint(h);
if("string"===h.ctype||"boolean"===h.ctype)return h.value;if("list"===h.ctype){for(var a="[",r=0;r<h.value.length;r++)a+=z(I(h.value[r])),r!==h.value.length-1&&(a+=", ");return a+"]"}return"function"===h.ctype?"FUNCTION":"infix"===h.ctype?"INFIX":"modifier"===h.ctype?h.key+"->"+z(h.value):"shape"===h.ctype?h.type:"error"===h.ctype?"Error: "+h.message:"variable"===h.ctype?(console.log("HALLO"),z(h.stack[length.stack])):"geo"===h.ctype?h.value.name:"__"}function Q(h,a,r){h=Q[h];if(void 0===h)return y;
var b=[];for(r=0;r<h.arglist.length;r++)b[r]=I(a[r]);for(r=0;r<h.arglist.length;r++)ca.newvar(h.arglist[r].name),ca.setvar(h.arglist[r].name,b[r]);ca.pushVstack("*");a=I(h.body);ca.cleanVstack();for(r=0;r<h.arglist.length;r++)ca.removevar(h.arglist[r].name);return a}function U(h,a){var r="undefined"===h[0].ctype,b="undefined"===h[1].ctype,c=I(h[1]);if(r||b)return y;"variable"===h[0].ctype?ca.setvar(h[0].name,c):"infix"===h[0].ctype?"_"===h[0].oper?R.assigntake(h[0],c):console.error("Can't use infix expression as lvalue"):
"field"===h[0].ctype?R.assigndot(h[0],c):"function"===h[0].ctype&&"genList"===h[0].oper?"list"===c.ctype?R.assignlist(h[0].args,c.value):console.error("Expected list in rhs of assignment"):console.error("Left hand side of assignment is not a recognized lvalue");return c}function W(h,a){var r=N(h[0]),b=N(h[1]);return"number"===r.ctype&&"number"===b.ctype?{ctype:"boolean",value:r.value.real===b.value.real&&r.value.imag===b.value.imag}:"string"===r.ctype&&"string"===b.ctype||"boolean"===r.ctype&&"boolean"===
b.ctype?{ctype:"boolean",value:r.value===b.value}:"list"===r.ctype&&"list"===b.ctype?n.equals(r,b):{ctype:"boolean",value:!1}}function Z(h,a){var r=N(h[0]),b=N(h[1]);return"number"===r.ctype&&"number"===b.ctype?{ctype:"boolean",value:p._helper.isAlmostEqual(r,b)}:"string"===r.ctype&&"string"===b.ctype||"boolean"===r.ctype&&"boolean"===b.ctype?{ctype:"boolean",value:r.value===b.value}:"list"===r.ctype&&"list"===b.ctype?n.almostequals(r,b):{ctype:"boolean",value:!1}}function T(h,a){var r=N(h[0]),b=
N(h[1]);return"boolean"===r.ctype&&"boolean"===b.ctype?{ctype:"boolean",value:r.value&&b.value}:y}function sa(h,a){var r=N(h[0]),b=N(h[1]);return"boolean"===r.ctype&&"boolean"===b.ctype?{ctype:"boolean",value:r.value||b.value}:y}function f(h,a){var r=N(h[0]),b=N(h[1]);return J.add(r,b)}function t(h,a){var r=N(h[0]),b=N(h[1]);return J.sub(r,b)}function V(h,a){var r=N(h[0]),b=N(h[1]);return J.mult(r,b)}function na(h,a){var r=N(h[0]),b=N(h[1]);return J.div(r,b)}function ma(h,a){var r=N(h[0]),b=N(h[1]);
return"number"===r.ctype&&"number"===b.ctype?p.pow(r,b):y}function ha(h){var a=h.length;if(0===a)return[];if(1===a)return[0];if(2===a)return h[0][0]+h[1][1]<=h[0][1]+h[1][0]?[0,1]:[1,0];if(4<a)return aa(h);for(var r=ec[a],b=Number.POSITIVE_INFINITY,c=r[0],d=0;d<r.length;++d){for(var e=r[d],f=0,g=0;g<a;++g)f+=h[g][e[g]];f<b&&(b=f,c=e)}return c}function aa(h){function a(){return{matched:-1,prev:-1,start:-1,cost:0,used:!1,leaf:!1}}function r(h){for(var a=0;a<d;++a)0<l[h][a]||k[a].used||(k[a].used=!0,
r(k[a].matched))}function b(h){for(var a=0;a<d;++a)0<l[a][h]||g[a].used||(g[a].used=!0,b(g[a].matched))}var c=Math.abs,d=h.length,e,f,g=Array(d),k=Array(d),l=Array(d);for(e=0;e<d;++e)l[e]=Array(d);for(e=0;e<d;++e)for(g[e]=a(),k[e]=a(),g[e].cost=h[e][0],f=1;f<d;++f)g[e].cost>h[e][f]&&(g[e].cost=h[e][f]);for(;;){for(e=0;e<d;++e)for(f=0;f<d;++f)l[e][f]=h[e][f]-g[e].cost-k[f].cost,l[e][f]<1E-14*(c(h[e][f])+c(g[e].cost)+c(k[f].cost))&&(l[e][f]=0);for(e=0;e<d;++e)g[e].matched=k[e].matched=-1;for(var n=
0;;){for(e=0;e<d;++e)g[e].used=g[e].leaf=k[e].used=k[e].leaf=!1,-1===g[e].matched&&(g[e].start=e,g[e].used=g[e].leaf=!0,g[e].prev=-1);for(var m=!1,p=!1;!p;){for(e=0;e<d;++e)if(g[e].leaf)for(g[e].leaf=!1,f=0;f<d;++f)if(!(k[f].used||0<l[e][f])&&g[e].matched!==f&&(k[f].prev=e,k[f].start=g[e].start,k[f].used=k[f].leaf=!0,-1===k[f].matched)){g[k[f].start].prev=f;m=!0;break}if(m)break;p=!0;for(f=0;f<d;++f)k[f].leaf&&(k[f].leaf=!1,e=k[f].matched,g[e].used||(g[e].prev=f,g[e].start=k[f].start,g[e].used=g[e].leaf=
!0,p=!1))}if(!m)break;for(m=0;m<d;++m)if(-1===g[m].matched&&-1!==g[m].prev){f=g[m].prev;do e=k[f].prev,k[f].matched=e,g[e].matched=f,f=g[e].prev;while(e!==m);++n}}if(n===d)break;for(e=0;e<d;++e)g[e].used=g[e].leaf=k[e].used=k[e].leaf=!1;for(e=0;e<d;++e)-1===g[e].matched&&r(e);for(f=0;f<d;++f)-1===k[f].matched&&b(f);for(e=0;e<d;++e)-1===g[e].matched||g[e].used||k[g[e].matched].used||(g[e].used=!0);n=Number.POSITIVE_INFINITY;for(e=0;e<d;++e)if(!g[e].used)for(f=0;f<d;++f)k[f].used||n>l[e][f]&&(n=l[e][f]);
for(e=0;e<d;++e)g[e].used||(g[e].cost+=n),k[e].used&&(k[e].cost-=n)}h=Array(d);for(e=0;e<d;++e)f=g[e].matched,h[e]=f;return h}function ta(h,a){var r=I(h[0]),b=N(h[1]);if("number"===b.ctype){var c=Math.floor(b.value.real);if("list"===r.ctype||"string"===r.ctype)return 0>c&&(c=r.value.length+c+1),0<c&&c<r.value.length+1?"list"===r.ctype?r.value[c-1]:{ctype:"string",value:r.value.charAt(c-1)}:y}if("list"===b.ctype){for(var c=[],d=0;d<b.value.length;d++){var e=N(b.value[d]);c[d]=ta([r,e],[])}return n.turnIntoCSList(c)}return y}
function pa(h,a){var r=I(h[0]),b=I(h[1]);return"list"===r.ctype&&"list"===b.ctype?n.concat(r,b):"shape"===r.ctype&&"shape"===b.ctype?R.shapeconcat(r,b):y}function ja(h,a){var r=I(h[0]),b=I(h[1]);return"list"===r.ctype&&"list"===b.ctype?n.set(n.common(r,b)):"shape"===r.ctype&&"shape"===b.ctype?R.shapecommon(r,b):y}function va(h,a){var r=I(h[0]),b=I(h[1]);return"list"===r.ctype&&"list"===b.ctype?n.remove(r,b):"shape"===r.ctype&&"shape"===b.ctype?R.shaperemove(r,b):y}function Qa(h,a){var r=I(h[0]),b=
I(h[1]);return"list"===r.ctype?n.append(r,b):y}function Pa(h,a){var r=I(h[0]),b=I(h[1]);return"list"===b.ctype?n.prepend(r,b):y}function Va(h,a){h|=0;a|=0;if(0===h&&0===a)return 0;for(;0!==a;){var r=h;h=a;a=r%a|0}return h}function Ka(h){return 1===h?0:1}function I(h){if("undefined"===typeof h)return y;if("infix"===h.ctype)return h.impl(h.args,{});if("variable"===h.ctype)return ca.getvar(h.name);if("void"===h.ctype||"geo"===h.ctype||"number"===h.ctype||"boolean"===h.ctype||"string"===h.ctype||"list"===
h.ctype||"undefined"===h.ctype||"shape"===h.ctype)return h;if("field"===h.ctype){var a=I(h.obj);return"geo"===a.ctype?Ha.getField(a.value,h.key):"list"===a.ctype?n.getField(a,h.key):y}return"function"===h.ctype?R.evaluate(h.oper,h.args,h.modifs):y}function N(h){h=I(h);if("geo"===h.ctype){var a=h.value;if("P"===a.kind)return Ha.getField(a,"xy")}return h}function ga(h){h=I(h);if("geo"===h.ctype){var a=h.value;if("P"===a.kind||"L"===a.kind)return Ha.getField(a,"homog")}return n._helper.isNumberVecN(h,
3)?h:n._helper.isNumberVecN(h,2)?(a=n.turnIntoCSList([h.value[0],h.value[1],p.real(1)]),h.usage&&(a=J.withUsage(a,h.usage)),a):y}function db(h){for(var a=!1,r=!1,b="",c=0;c<h.length;c++){var d=h[c];'"'!==d||r||(a=!a);"/"===d&&c!==h.length-1&&"/"===h[c+1]&&(r=!0);"\n"===d&&(r=!1);if(" "!==d&&"\t"!==d&&"\n"!==d&&"\f"!==d&&"\r"!==d&&!r||a)b+=d}return b}function Hb(h,a,r){var b={ctype:"infix"};b.oper=h;b.impl=la[h];b.args=[a,r];return b}function fc(h){var a,r;if("function"!==h.ctype)return console.log("Invalid function name."),
!1;for(a=0;a<h.args.length;a++)if("variable"!==h.args[a].ctype)return console.log("Argument is not a variable."),!1;for(a=0;a<h.args.length-1;a++)for(r=a+1;r<h.args.length;r++)if(h.args[a].name===h.args[r].name)return console.log("Variable name used twice."),!1;return!0}function pb(h){return""!==h&&!isNaN(h)}function vb(h){return"["===h||"("===h||"{"===h||"|"===h}function wb(h){return"]"===h||")"===h||"}"===h||"|"===h}function xb(h){var a,r=[],b=[],c=[];a=h+",";var d=a.length,e=0,f=0,g=!1,k=!1;for(h=
f;h<d;h++){var l;l=a[h];'"'===l&&(k=!k);!k&&(!vb(l)||"|"===l&&g?wb(l)&&("|"!==l||g)&&(e--,"|"===l&&(g=!1)):(e++,"|"===l&&(g=!0)),","===l&&0===e||-1===e)&&(l=a.substring(f,h),r.push(l),b.push(f),f=h+1)}for(h=0;h<r.length;h++)if(b=r[h],""===b)c.push("nil");else{b=Fa(b,!1);if("error"===b.ctype)return b;c.push(b)}r={ctype:"function",oper:"genList"};r.args=c;r.modifs={};return r}function gc(h){var a;return"|"===h[0]?(h=xb(h.substring(1,h.length-1)),a=h.args.length,1===a?(h.oper="abs_infix",h):2===a?(h.oper=
"dist_infix",h):y):"()"===h||"[]"===h?a={ctype:"list",value:[]}:"["===h[0]?xb(h.substring(1,h.length-1)):"("===h[0]&&(a=xb(h.substring(1,h.length-1)),1<a.args.length)?a:a=Fa(h.substring(1,h.length-1),!1)}function Fa(h,a){for(var r=!1,b="",c=-1,d=-1,e="",f=0,g=0,k=" ",l=" ",n=0,m=!1,p=h.length,q=0;q<p;q++){var t,u=" ",v=" ";0<n&&n--;t=h[q];q+1<p&&(u=h[q+1]);q+2<p&&(v=h[q+2]);'"'===t&&(r=!r);if(!r){if(vb(t)&&("|"!==t||!m))"|"===t&&(m=!0),b+=t,f++,1===f&&g++," "===k&&(k=t);else if(wb(t)&&("|"!==t||m)){"|"===
t&&(m=!1);if(0===f)return new fa("close without open");l=b[b.length-1]+t;if("[]"===l||"()"===l||"{}"===l||"||"===l)f--,b=b.substring(0,b.length-1),l=t;else return new fa("unmatched brackets")}if(0===b.length){var w=-1,x="";"undefined"!==typeof qb[t+u+v]&&0===n?(x=t+u+v,n=3):"undefined"!==typeof qb[t+u]&&0===n?(x=""+t+u,n=2):"undefined"!==typeof qb[t]&&0===n&&(x=""+t,n=1);""!==x&&(w=qb[x]);w>=d&&(d=w,c=q,e=x,0<=w&&(q+=x.length-1))}}}if(0!==f)return new fa("open without close");r=h.indexOf(k);b=h.lastIndexOf(l);
if(0===f&&-1<d){if("->"===e)return d=e,e=h.substring(0,c),c=Fa(h.substring(c+d.length),!1),e="error"===c.ctype?c:{ctype:"modifier",key:e,value:c},e;if("."===e)return d=h.indexOf("."),f=h.lastIndexOf("."),(d!==f?0:-1===d?pb(h):pb(h.substring(0,d))||pb(h.substring(d+1)))?(e={},e.value={real:parseFloat(h),imag:0},e.ctype="number"):(d=Fa(h.substring(0,c),!1),e=h.substring(c+e.length),e={ctype:"field",obj:d,key:e}),e;if(":="===e)return d=h.substring(0,c),d=Fa(d,!0),"error"===d.ctype?e=d:"variable"===d.cstring||
fc(d)?(c=h.substring(c+e.length),c=Fa(c,!1),e="error"===c.ctype?c:Hb(e,d,c)):(console.log(["Function not definable",d]),e=new fa("Function not definable")),e;d=Fa(h.substring(0,c),!1);c=Fa(h.substring(c+e.length),!1);e="error"===d.ctype?d:"error"===c.ctype?c:Hb(e,d,c);return e}if(0===f&&1===g&&b===h.length-1){if(0===r)return gc(h);a:{f=[];g=[];e=[];c={};d=h.substring(0,r);b=h.length;k=0;l=r+1;m=n=!1;for(r=l;r<b;r++)if(p=h[r],'"'===p&&(n=!n),!n)if(!vb(p)||"|"===p&&m?wb(p)&&("|"!==p||m)&&(k--,"|"===
p&&(m=!1)):(k++,"|"===p&&(m=!0)),","===p&&0===k||-1===k)p=h.substring(l,r),f.push(p),g.push(l),1!==f.length||-1!==k||f[0].length||(f=[],g=[]),l=r+1;for(r=0;r<f.length;r++){g=Fa(f[r],!1);if("error"===g.ctype){e=g;break a}"modifier"===g.ctype?c[g.key]=g.value:e.push(g)}f={ctype:"function"};f.oper=d+"$"+e.length;f.args=e;f.modifs=c;e=f}return e}return""===h?new ea:'"'===h.charAt(0)&&'"'===h.charAt(h.length-1)?{ctype:"string",value:h.substring(1,h.length-1)}:pb(h)?{ctype:"number",value:{real:parseInt(h),
imag:0}}:ca.isVariable(h)?ca.vars[h]:ca.isVariableName(h)?ca.create(h):y}function Nb(h){for(var a in h)null!==h[a]&&(Ia[a]=h[a])}function hc(h){function a(h){void 0===h.size&&(h.size=Ia.pointSize);h.size=p.real(h.size);"Free"!==h.type?(h.color=n.realVector(h.color||Ia.pointColor),h.color=n.scalmult(p.real(Ia.dimDependent),h.color)):h.color=n.realVector(h.color||Ia.pointColor);void 0===h.alpha&&(h.alpha=Ia.alpha);h.alpha=p.real(h.alpha)}function r(h){void 0===h.size&&(h.size=Ia.lineSize);h.size=p.real(h.size);
h.color=n.realVector(h.color||Ia.lineColor);void 0===h.alpha&&(h.alpha=Ia.alpha);h.alpha=p.real(h.alpha);h.clip=J.string(h.clip||Ia.clip);void 0===h.overhang&&(h.overhang=Ia.overhangLine);h.overhang=p.real(h.overhang)}function b(h){r(h);h.clip=J.string("end");void 0===h.overhang&&(h.overhang=Ia.overhangSeg);h.overhang=p.real(h.overhang)}Object.keys(F).forEach(function(h){h=F[h];void 0!==h.updatePosition&&void 0===h.stateSize&&(h.stateSize=0)});P.gslp=h;P.csnames={};var c,d,e,f=0;P.points=[];P.lines=
[];P.conics=[];P.free=[];var g=0,k=0,l=0,m=0;for(c=0;c<h.length;c++)d=h[c],(e=ic[d.type])?(d=e(d).slice(),d.splice(0,0,c,1),h.splice.apply(h,d),--c):(P.csnames[d.name]=d,e=F[d.type],e||(console.error(d),console.error("Operation "+d.type+" not implemented yet")),d.kind=e.kind,d.stateIdx=f,f+=e.stateSize,d.incidences=[],d.isshowing=!0,d.movable=!1,e.isMovable&&(d.movable=!0,P.free[k++]=d),"P"===d.kind&&(P.points[g]=d,a(d),g+=1),"L"===d.kind&&(P.lines[l]=d,r(d),l+=1),"C"===d.kind&&(P.conics[m]=d,r(d),
m+=1),"S"===d.kind&&(P.lines[l]=d,b(d),l+=1));Ua=ya=La=new Float64Array(f);for(c=0;c<h.length;c++)d=h[c],e=F[d.type],Za=!0,e.initialize&&(Ba=Ga=d.stateIdx,d.param=e.initialize(d),$a(Ga===d.stateIdx+e.stateSize,"State fully initialized")),Ba=Ga=d.stateIdx,e.updatePosition(d,!1),$a(Ba===d.stateIdx+e.stateSize,"State fully consumed"),$a(Ga===d.stateIdx+e.stateSize,"State fully updated"),yb(d,e);ya=new Float64Array(f);La=new Float64Array(f);Za=!1;jc()}function Ob(h,a){var r=P.csnames[a.args[0]].homog,
b=P.csnames[a.args[1]].homog,c=h.homog,d=p.div(r.value[0],r.value[2]),e=p.div(r.value[1],r.value[2]),r=p.div(b.value[0],b.value[2]),b=p.div(b.value[1],b.value[2]),f=p.div(c.value[0],c.value[2]),g=p.div(c.value[1],c.value[2]);return p._helper.isAlmostReal(d)&&p._helper.isAlmostReal(e)&&p._helper.isAlmostReal(r)&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(f)&&p._helper.isAlmostReal(g)?(d=d.value.real,e=e.value.real,r=r.value.real,b=b.value.real,f=f.value.real,g=g.value.real,c=Math.sqrt((d-r)*
(d-r)+(e-b)*(e-b)),d=Math.sqrt((d-f)*(d-f)+(e-g)*(e-g)),r=Math.sqrt((r-f)*(r-f)+(b-g)*(b-g)),d=c-d-r,1E-15>d*d):!1}function yb(h,a){h.isshowing=!0;if(h.args)for(var r=0;r<h.args.length;r++)if(!P.csnames[h.args[r]].isshowing){h.isshowing=!1;return}a.visiblecheck&&a.visiblecheck(h)}function jc(){for(var h=0;h<P.lines.length;h++)for(var a=P.lines[h],r=0;r<P.points.length;r++){var b=P.points[r],c=n.scaldiv(n.abs(b.homog),b.homog),d=n.scaldiv(n.abs(a.homog),a.homog);1E-13>p.abs(n.scalproduct(c,d)).value.real&&
(b.incidences.push(a.name),a.incidences.push(b.name))}}function dc(){function h(h){if(h.isshowing&&!1!==h.visible&&n._helper.isAlmostReal(h.homog)){var a=h.color;h.behavior&&(a=h.color);A.draw$1([h.homog],{size:h.size,color:a,alpha:h.alpha});if(h.labeled){var a=h.printname||h.name||"P",r=h.labelpos||{x:3,y:3},b=h.textsize||12,c=!0===h.textbold,ka=!0===h.textitalics,d=h.text_fontfamily||"Sans Serif",ia=r.x*r.x+r.y*r.y,e=1;0<ia&&(e=1+h.size.value.real/Math.sqrt(ia));A.drawtext$2([h.homog,J.wrap(a)],
{x_offset:J.wrap(e*r.x),y_offset:J.wrap(e*r.y),size:J.wrap(b),bold:J.wrap(c),italics:J.wrap(ka),family:J.wrap(d)})}}}function a(h){if(h.isshowing&&!1!==h.visible){var r={};r.color=h.color;r.alpha=h.alpha;r.size=h.size;R.drawconic(h,r)}}function r(h){var a,r;if(h.isshowing&&!1!==h.visible&&n._helper.isAlmostReal(h.homog))if("none"===h.clip.value)A.draw$1([h.homog],{size:h.size,color:h.color,alpha:h.alpha});else if("end"===h.clip.value)a=P.csnames[h.args[0]],r=P.csnames[h.args[1]],A.draw$2([a.homog,
r.homog],{size:h.size,color:h.color,alpha:h.alpha});else if("inci"===h.clip.value){a=[1E6,0];r=[-1E6,0];for(var b=[1E6,0],c=[-1E6,0],ka=0;ka<h.incidences.length;ka++){var d=P.csnames[h.incidences[ka]].homog,e=d.value[0],ia=d.value[1],f=d.value[2];p._helper.isAlmostZero(f)||(e=p.div(e,f),ia=p.div(ia,f),p._helper.isAlmostReal(e)&&p._helper.isAlmostReal(ia)&&(e.value.real<a[0]&&(a=[e.value.real,d]),e.value.real>r[0]&&(r=[e.value.real,d]),ia.value.real<b[0]&&(b=[ia.value.real,d]),ia.value.real>c[0]&&
(c=[ia.value.real,d])))}r[0]-a[0]>c[0]-b[0]?(a=a[1],r=r[1]):(a=b[1],r=c[1]);a!==r?A.draw$2([a,r],{size:h.size,color:h.color,alpha:h.alpha,overhang:h.overhang}):A.draw$1([h.homog],{size:h.size,color:h.color,alpha:h.alpha})}else console.error(["Bad clip: ",h.clip])}var b;for(b=0;b<P.conics.length;b++)a(P.conics[b]);for(b=0;b<P.lines.length;b++)r(P.lines[b]);for(b=0;b<P.points.length;b++)h(P.points[b])}function $a(h,a){var r="Assertion failed: "+a;if(!h)throw console.log(r),v(),"undefined"!==typeof alert&&
alert(r),Error(r);}function Ya(){Ua.set(ya);Pb(!1);for(var h=Ua.length,a=Math.abs,r=0;r<h;r+=2)a(Ua[r])>1E12*a(Ua[r+1])&&(Ua[r+1]=0)}function zb(){if(cb)Ja=!0;else throw Qb;}function Rb(h,a,r,b,c){return J.add(b,J.mult(r,J.sub(c,b)))}function cc(){X&&(X.currentMouseAndScripts=[]);Ab=!0;Ja=!1;ya.set(Ua);if(xa){var h=xa.mover,a=n.realVector([oa.x+xa.offset.x,oa.y+xa.offset.y,1]);Bb(h,a,"mouse");xa.prev.x=oa.x;xa.prev.y=oa.y}I(Ca.move);I(Ca.draw);Ja||Ya();Ab=!1;X&&(X.fullLog.push(n.turnIntoCSList([n.turnIntoCSList(X.currentMouseAndScripts)])),
X.length>X.logLength&&X.splice(0,X.length-X.logLength),X.currentMouseAndScripts=null,X.postMouseHooks.forEach(function(h){h()}))}function Cb(h,a,r){Ab?Bb(h,a,r):(Ya(),Ja=!1,Bb(h,a,r),Ya())}function Bb(h,a,r){X&&X.currentMouseAndScripts&&(X.currentMover=[]);La.set(ya);var b=1E4,c;c=Sb[h.name];if(!c){var d={},e=0;c=[];d[h.name]=h;for(var f=P.gslp,g=0;g<f.length;++g){var k=f[g],l=k.args;if(l)for(var m=0;m<l.length;++m)d.hasOwnProperty(l[m])&&(d[k.name]=k,c[e++]=k)}Sb[h.name]=c}var d=-1,e=.9,q,t,u,f=
F[h.type],g=f.parameterPath||Rb;Ba=h.stateIdx;k=f.getParamFromState(h);Ba=Ga=h.stateIdx;l=f.getParamForInput(h,a,r);for(m=d+e;d!==m;){var v=m*m,w=.5/(1+v),w=p.complex(2*m*w+.5,(1-v)*w);cb=d+.5*e<=d||0===b;0===b&&console.log("tracing limit Reached");v=!1;X&&X.currentMouseAndScripts&&(X.currentStep=[]);try{Ba=Ga=h.stateIdx;var x=g(h,m,w,k,l);X&&(X.currentParam=x);w=La;La=ya;f.putParamToState(t,x);La=w;Ga=h.stateIdx;X&&(X.currentElement=h);f.updatePosition(h,!0);$a(Ba===h.stateIdx+f.stateSize,"State fully consumed");
$a(Ga===h.stateIdx+f.stateSize,"State fully updated");for(q=0;q<c.length;++q)t=c[q],u=F[t.type],Ba=Ga=t.stateIdx,X&&(X.currentElement=t),u.updatePosition(t,!1),$a(Ba===t.stateIdx+u.stateSize,"State fully consumed"),$a(Ga===t.stateIdx+u.stateSize,"State fully updated");X&&(X.currentElement=null);d=m;e*=1.25;m+=e;1<=m&&(m=1);La=ya;ya=w}catch(y){if(y!==Qb)throw y;e*=.5;m=d+e;--b;v=!0}X&&X.currentMouseAndScripts&&(X.currentMover.push(n.turnIntoCSList([n.turnIntoCSList(X.currentStep),J.wrap(v),J.wrap(d),
J.wrap(m),J.wrap(X.currentParam)])),X.currentStep=null,X.currentParam=null)}Pb(Ja);for(q=0;q<c.length;++q)t=c[q],u=F[t.type],yb(t,u);X&&X.currentMouseAndScripts&&(X.currentMouseAndScripts.push(n.turnIntoCSList([n.turnIntoCSList(X.currentMover),J.wrap(Ja),J.wrap(h.name),a,J.wrap(r),k,l])),X.currentMover=null)}function ac(){Ya();cb=!0;for(var h=P.gslp,a=0;a<h.length;a++){var r=h[a],b=F[r.type];Ba=Ga=r.stateIdx;b.updatePosition(r,!1);yb(r,b)}h=La;La=ya;ya=h;Ya()}function Pb(h){var b=a.tracingStateReport;
"string"===typeof b&&(document.getElementById(b).textContent=h?"BAD":"GOOD")}function kc(){return n.turnIntoCSList(X.fullLog.slice())}function lc(h){var a=JSON.stringify(X.fullLog);h=new Blob([a],{type:h?"application/octet-stream":"application/json"});return window.URL.createObjectURL(h)}function fb(){var h=Ba;Ba+=2;return p.complex(ya[h],ya[h+1])}function wa(h){for(var a=Array(h),r=0;r<h;++r)a[r]=fb();return n.turnIntoCSList(a)}function ab(h){La[Ga]=h.value.real;La[Ga+1]=h.value.imag;Ga+=2}function qa(h){for(var a=
0,r=h.value.length;a<r;++a)ab(h.value[a])}function Na(h,a){var r=wa(3),b=wa(3),r=Tb(h,a,r,b);qa(r[0]);qa(r[1]);return n.turnIntoCSList(r)}function Tb(h,a,r,b){if(Za)return[h,a];var c=n.projectiveDistMinScal(r,h),d=n.projectiveDistMinScal(r,a),e=n.projectiveDistMinScal(b,h),f=n.projectiveDistMinScal(b,a),g=n.projectiveDistMinScal(r,b),k=n.projectiveDistMinScal(h,a),l=c+f,m=d+e,p;l>m?(p=[a,h],l=m):p=[h,a];m=function(){};if(X&&X.currentStep){var q=[X.labelTracing2,J.wrap(X.currentElement.name),n.turnIntoCSList(p),
n.turnIntoCSList([r,b]),n.realMatrix([[c,d],[e,f]]),J.wrap(l),J.wrap(g),J.wrap(k),y];X.currentStep.push(n.turnIntoCSList(q));m=function(h){X.hasOwnProperty(h)||(X[h]=J.wrap(h));q[q.length-1]=X[h]}}n._helper.isNaN(h)||n._helper.isNaN(a)?(m("Tracing failed due to NaNs."),Ja=!0):g>3*l&&k>3*l?m("Normal case, everything all right."):1E-5>k?1E-5>g?m("Staying inside singularity."):(m("Moved into singularity."),Ja=!0):1E-5>g?m("Moved out of singularity."):(cb?m("Reached refinement limit, giving up."):m("Need to refine."),
zb());return p}function Db(h,a,r,b){var c=wa(3),d=wa(3),e=wa(3),f=wa(3);h=mc(h,a,r,b,c,d,e,f);qa(h[0]);qa(h[1]);qa(h[2]);qa(h[3]);return n.turnIntoCSList(h)}function mc(h,a,r,b,c,d,e,f){var g=function(){};c=[c,d,e,f];h=[h,a,r,b];if(Za)return h;d=0;b=Array(4);for(r=0;4>r;r++)for(b[r]=Array(4),f=0;4>f;f++)e=n.projectiveDistMinScal(c[r],h[f]),b[r][f]=e;e=ha(b);a=Array(4);for(r=0;4>r;++r)a[r]=h[e[r]],d+=b[r][e[r]];var k=1*d,l=Infinity,m=Infinity;for(r=0;4>r;r++){if(n._helper.isNaN(h[r]))return g("Tracing failed due to NaNs."),
Ja=!0,a;for(f=r+1;4>f;f++)e=n.projectiveDistMinScal(c[r],c[f]),l>e&&(l=e),e=n.projectiveDistMinScal(a[r],a[f]),m>e&&(m=e)}if(X&&X.currentStep){var p=[X.labelTracing4,J.wrap(X.currentElement.name),n.turnIntoCSList(a),n.turnIntoCSList(c),n.realMatrix(b),J.wrap(d),J.wrap(l),J.wrap(m),y];X.currentStep.push(n.turnIntoCSList(p));g=function(h){X.hasOwnProperty(h)||(X[h]=J.wrap(h));p[p.length-1]=X[h]}}l>k&&m>k||(1E-5>m?1E-5>l?g("Staying inside singularity."):(g("Moved into singularity."),Ja=!0):1E-5>l?g("Moved out of singularity."):
(cb?g("Reached refinement limit, giving up."):g("Need to refine."),zb()));return a}function Ub(h){var a=h.length,r,b;if(Za){for(r=0;r<a;++r)Ba+=2*h[r].value.length,qa(h[r]);return h}var c=Array(a),d=Array(a),e=Array(a),f=99,g=99,k=Array(a);for(r=0;r<a;++r)c[r]=wa(h[r].value.length),d[r]=n.normSquared(c[r]).value.real,e[r]=n.normSquared(h[r]).value.real,k[r]=Array(a);var l;for(r=0;r<a;++r){for(b=0;b<a;++b)l=n.sesquilinearproduct(c[r],h[b]).value,l=(l.real*l.real+l.imag*l.imag)/(d[r]*e[b]),k[r][b]=
1-l;for(b=r+1;b<a;++b)l=n.sesquilinearproduct(c[r],c[b]).value,l=(l.real*l.real+l.imag*l.imag)/(d[r]*d[b]),f>1-l&&(f=1-l),l=n.sesquilinearproduct(h[r],h[b]).value,l=(l.real*l.real+l.imag*l.imag)/(e[r]*e[b]),g>1-l&&(g=1-l)}l=ha(k);b=Array(a);d=0;e=!1;for(r=0;r<a;++r){var d=d+k[r][l[r]],m=b[r]=h[l[r]];qa(m);e|=n._helper.isNaN(m)}e|=isNaN(d);h=function(){};if(X&&X.currentStep){var p=[X.labelTracingSesq,J.wrap(X.currentElement.name),n.turnIntoCSList(b),n.turnIntoCSList(c),n.realMatrix(k),J.wrap(d),J.wrap(f),
J.wrap(g),y];X.currentStep.push(n.turnIntoCSList(p));h=function(h){X.hasOwnProperty(h)||(X[h]=J.wrap(h));p[p.length-1]=X[h]}}e?(h("Tracing failed due to NaNs."),Ja=!0):f>3*d&&g>3*d?h("Normal case, everything all right."):1E-5>g?1E-5>f?h("Staying inside singularity."):(h("Moved into singularity."),Ja=!0):1E-5>f?h("Moved out of singularity."):(cb?h("Reached refinement limit, giving up."):h("Need to refine."),zb());return b}function bc(h){Ea.forEach(function(h){ba[h.behavior.type].init(h.behavior,P.csnames[h.name])})}
function rb(h){sb=0!==h.length;Ea=h;ra=[];Ea.forEach(function(h){if(h.name){var a=h.name;P.csnames[a]&&(P.csnames[a].behavior=h.behavior,ba[h.behavior.type].init(h.behavior,P.csnames[a]),"Mass"===h.behavior.type&&ra.push(P.csnames[a]))}else ba[h.behavior.type].init(h.behavior)})}var Xa=this,gb,Ca={},Ra=!1,jb=!0,kb=!1,ib=1,Sa=0,Ib,Vb=!1,eb,M,Aa,ua,P,za,Wa=null,bb=[],tb=!1,Ma={config:a,startup:function(){void 0!==a.csconsole&&(gb=a.csconsole);eb=[100,100];var h,c=null,r=a.transform;a.ports&&0<a.ports.length&&
(h=a.ports[0],(c=h.element)||(c=document.getElementById(h.id)),"window"===h.fill?(c.setAttribute("width",window.innerWidth),c.setAttribute("height",window.innerHeight)):h.width&&h.height&&(c.setAttribute("width",h.width),c.setAttribute("height",h.height)),h.background&&(c.style.backgroundColor=h.background),void 0!==h.transform&&(r=h.transform));c||(c=a.canvas)||"undefined"===typeof document||(c=document.getElementById(a.canvasname));c&&(M=c.getContext("2d"),M.setLineDash||(M.setLineDash=function(){}));
h=db("           #drawgrid(s):=(              regional(b,xmin,xmax,ymin,ymax,nx,ny);              b=screenbounds();              xmin=b_4_1-s;              xmax=b_2_1+s;              ymin=b_4_2-s;              ymax=b_2_2+s;              nx=round((xmax-xmin)/s);              ny=round((ymax-ymin)/s);              xmin=floor(xmin/s)*s;              ymin=floor(ymin/s)*s;              repeat(nx,x,                 draw((xmin+x*s,ymin),(xmin+x*s,ymax),color->(1,1,1)*.9,size->1);              );              repeat(ny,y,                 draw((xmin,ymin+y*s),(xmax,ymin+y*s),color->(1,1,1)*.9,size->1);              )            );");
h=Fa(h,!1);I(h);var ia=a.scripts,f=null;"string"===typeof ia&&ia.search(/\*/)&&(f=ia);"object"!==typeof ia&&(ia=null);"move keydown mousedown mouseup mousedrag init tick draw simulationstep cssimulationstart cssimulationstop".split(" ").forEach(function(h){var r;if(null!==ia&&ia[h])r=ia[h];else{r=h+"script";if(a[r])r=document.getElementById(a[r]);else if(f){if(r=document.getElementById(f.replace(/\*/,h)),!r)return}else return;r=r.text}r=db(r);Ca[h]=Fa(r,!1)});a.grid&&0!==a.grid&&(Sa=a.grid,Ib=Fa("#drawgrid("+
Sa+")",!1));a.snap&&(Vb=a.snap);c&&(Aa=c.width,ua=c.height,b(r),B.drawingstate.matrix.ty-=ua,B.drawingstate.initialmatrix.ty-=ua,r=1,"undefined"!==typeof window&&window.devicePixelRatio&&(r=window.devicePixelRatio),h=M.webkitBackingStorePixelRatio||M.mozBackingStorePixelRatio||M.msBackingStorePixelRatio||M.oBackingStorePixelRatio||M.backingStorePixelRatio||1,r!==h&&(r/=h,c.width=Aa*r,c.height=ua*r,c.style.width||(c.style.width=Aa+"px"),c.style.height||(c.style.height=ua+"px"),M.scale(r,r)));P={};
r=0;za={};a.geometry||(a.geometry=[]);hc(a.geometry);a.behavior||(a.behavior=[]);"function"===typeof rb&&rb(a.behavior);for(var k in a.images)r=a.images[k],za[k]=new Image,za[k].ready=!1,za[k].onload=function(){za[k].ready=!0;E()},za[k].src=r;Ma.canvas=c;if(a.oninit)a.oninit(Ma);if(a.exclusive)for(r=Xa.instances.length;0<r;)Xa.instances[--r].shutdown();Xa.instances.push(Ma);I(Ca.init);a.autoplay&&d();c&&C(c,a)},shutdown:v,evokeCS:function(h){h=db(h);h=Fa(h,!1);console.log(h);I(h);E()},play:d,pause:m,
stop:u,evalcs:function(h){return I(Fa(db(h),!1))},niceprint:z,canvas:null},oa={},xa,Jb="",Kb=0,nc=[].slice,Eb,Wb=function(h){return nc.call(h)};if(!a.isNode){var oc=document.documentElement;Eb=window;try{Wb(oc.childNodes)[0].nodeType}catch(pc){Wb=function(h){for(var a=h.length,r=Array(a);a--;)r[a]=h[a];return r}}}var Lb="webkit ms moz Moz o O".split(" "),ub={},nb,ob,mb,lb,Ta,Mb=!a.isNode&&Eb[L(Eb,"requestAnimationFrame")]||function(h){setTimeout(h,17)};ub.timer=function(h,a,r){var b=arguments.length;
2>b&&(a=0);3>b&&(r=Date.now());b={c:h,t:r+a,f:!1,n:null};ob?ob.n=b:nb=b;ob=b;mb||(lb=clearTimeout(lb),mb=1,Mb(H))};ub.timer.flush=function(){S();O()};var y=new Y,Fb=new Y,ca=new function(){this.vars={pi:{ctype:"variable",stack:[{ctype:"number",value:{real:Math.PI,imag:0}}],name:"pi"},i:{ctype:"variable",stack:[{ctype:"number",value:{real:0,imag:1}}],name:"i"},"true":{ctype:"variable",stack:[{ctype:"boolean",value:!0}],name:"true"},"false":{ctype:"variable",stack:[{ctype:"boolean",value:!1}],name:"false"},
"#":{ctype:"variable",stack:[y],name:"#"}};this.isVariable=function(h){return void 0!==this.vars[h]};this.isVariableName=function(h){if("#"===h||"#1"===h||"#2"===h)return!0;var a=/^[a-z,A-Z]+$/.test(h[0]);h=/^[0-9,a-z,A-Z]+$/.test(h);return a&&h};this.create=function(h){var a={ctype:"variable",stack:[Fb],name:h};return this.vars[h]=a};this.newvar=function(h){h=this.vars[h];h.stack.push(y);return h};this.removevar=function(h){var a=this.vars[h].stack;0===a.length&&console.error("Removing non-existing "+
h);a.pop();0===a.length&&console.warn("Removing last "+h)};this.setvar=function(h,a){var r=this.vars[h].stack;0===r.length&&console.error("Setting non-existing variable "+h);void 0===a&&(console.error("Setting variable "+h+" to undefined value"),a=y);if("undefined"===a.ctype)r[r.length-1]=a;else{var b=a;b===Fb&&(b=y);r[r.length-1]=b}};this.undefinedWarning={};this.getvar=function(h){var a=this.vars[h].stack;0===a.length&&console.error("Getting non-existing variable "+h);a=a[a.length-1];if(a===Fb){if(void 0!==
P.csnames[h])return{ctype:"geo",value:P.csnames[h]};console&&console.log&&void 0===this.undefinedWarning[h]&&(this.undefinedWarning[h]=!0,console.log("Warning: Accessing undefined variable: "+h));return y}return a};this.dump=function(h){var a=this.vars[h].stack;console.log("*** Dump "+h);for(h=0;h<a.length;h++)console.log(h+":> "+z(a[h]))};this.vstack=[];this.pushVstack=function(h){this.vstack.push(h)};this.popVstack=function(){this.vstack.pop()};this.cleanVstack=function(){for(var h=this.vstack;0<
h.length&&"*"!==h[h.length-1];)this.removevar(h[h.length-1]),h.pop();0<h.length&&h.pop()}},Ha={generalFields:{color:"color",colorhsb:"",size:"size",alpha:"alpha",isshowing:"isshowing",visible:"visible",name:"name",caption:"caption",trace:"trace",tracelength:"",selected:""},getGeoField:function(h,a){return"undefined"!==typeof P.csnames[h]?Ha.getField(P.csnames[h],a):y},setGeoField:function(h,a,r){return"undefined"!==typeof P.csnames[h]?Ha.setField(P.csnames[h],a,r):y},getField:function(h,a){var r;
if("P"===h.kind){if("xy"===a){r=p.div(h.homog.value[0],h.homog.value[2]);var b=p.div(h.homog.value[1],h.homog.value[2]);r=n.turnIntoCSList([r,b]);return J.withUsage(r,"Point")}if("homog"===a)return J.withUsage(h.homog,"Point");if("x"===a)return p.div(h.homog.value[0],h.homog.value[2]);if("y"===a)return p.div(h.homog.value[1],h.homog.value[2])}if("L"===h.kind){if("homog"===a)return J.withUsage(h.homog,"Line");if("angle"===a)return r=n.eucangle(n.ey,h.homog),J.withUsage(r,"Angle")}if("Tr"===h.kind&&
"matrix"===a)return h.matrix;if("C"===h.kind&&"radius"===a){var c=h.matrix;r=c.value[0].value[0];var d=c.value[0].value[2],b=c.value[1].value[2],c=c.value[2].value[2];p.mult(r,r);d=p.div(d,r);b=p.div(b,r);r=p.div(c,r);return r=p.sqrt(p.sub(p.add(p.mult(d,d),p.mult(b,b)),r))}if(Ha.generalFields[a])return(r=h[Ha.generalFields[a]])?r:y;if(h.behavior){if("mass"===a&&"Mass"===h.behavior.type)return p.real(h.behavior.mass);if("radius"===a&&"Mass"===h.behavior.type)return p.real(h.behavior.radius);if("charge"===
a&&"Mass"===h.behavior.type)return p.real(h.behavior.charge);if("friction"===a&&"Mass"===h.behavior.type)return p.real(h.behavior.friction);if("vx"===a&&"Mass"===h.behavior.type)return p.real(h.behavior.vx);if("vy"===a&&"Mass"===h.behavior.type)return p.real(h.behavior.vy);if("v"===a&&"Mass"===h.behavior.type)return n.realVector([h.behavior.vx,h.behavior.vy]);if("fx"===a&&"Mass"===h.behavior.type)return p.real(h.behavior.fx);if("fy"===a&&"Mass"===h.behavior.type)return p.real(h.behavior.fy);if("f"===
a&&"Mass"===h.behavior.type)return n.realVector([h.behavior.fx,h.behavior.fy])}return y},setField:function(h,a,r){"color"===a&&(h.color=r);"size"===a&&(h.size=r);"alpha"===a&&(h.alpha=r);"visible"===a&&"boolean"===r.ctype&&(h.visible=r.value);"pinned"===a&&"boolean"===r.ctype&&(h.pinned=r.value);"xy"===a&&"P"===h.kind&&h.movable&&n._helper.isNumberVecN(r,2)&&Cb(h,n.turnIntoCSList([r.value[0],r.value[1],p.real(1)]),"homog");"homog"===a&&"P"===h.kind&&h.movable&&n._helper.isNumberVecN(r,3)&&Cb(h,r,
"homog");if("angle"===a&&"Through"===h.type){var b=p.cos(r),c=p.sin(r),b=n.turnIntoCSList([b,c,p.real(0)]);Cb(h,b,"dir")}h.behavior&&("mass"===a&&"Mass"===h.behavior.type&&"number"===r.ctype&&(h.behavior.mass=r.value.real),"mass"===a&&"Sun"===h.behavior.type&&"number"===r.ctype&&(h.behavior.mass=r.value.real),"friction"===a&&"Mass"===h.behavior.type&&"number"===r.ctype&&(h.behavior.friction=r.value.real),"charge"===a&&"Mass"===h.behavior.type&&"number"===r.ctype&&(h.behavior.charge=r.value.real),
"radius"===a&&"Mass"===h.behavior.type&&"number"===r.ctype&&(h.behavior.radius=r.value.real),"vx"===a&&"Mass"===h.behavior.type&&"number"===r.ctype&&(h.behavior.vx=r.value.real),"vy"===a&&"Mass"===h.behavior.type&&"number"===r.ctype&&(h.behavior.vy=r.value.real),"v"===a&&"Mass"===h.behavior.type&&n._helper.isNumberVecN(r,2)&&(h.behavior.vx=r.value[0].value.real,h.behavior.vy=r.value[1].value.real))}},p={niceprint:function(h){return 0===h.value.imag?""+h.value.real:0<h.value.imag?""+h.value.real+" + i*"+
h.value.imag:""+h.value.real+" - i*"+-h.value.imag},complex:function(h,a){return{ctype:"number",value:{real:h,imag:a}}},real:function(h){return{ctype:"number",value:{real:h,imag:0}}}};p.zero=p.real(0);p.one=p.real(1);p.argmax=function(h,a){return h.value.real*h.value.real+h.value.imag*h.value.imag<a.value.real*a.value.real+a.value.imag*a.value.imag?a:h};p.max=function(h,a){return{ctype:"number",value:{real:Math.max(h.value.real,a.value.real),imag:Math.max(h.value.imag,a.value.imag)}}};p.min=function(h,
a){return{ctype:"number",value:{real:Math.min(h.value.real,a.value.real),imag:Math.min(h.value.imag,a.value.imag)}}};p.add=function(h,a){return{ctype:"number",value:{real:h.value.real+a.value.real,imag:h.value.imag+a.value.imag}}};p.sub=function(h,a){return{ctype:"number",value:{real:h.value.real-a.value.real,imag:h.value.imag-a.value.imag}}};p.neg=function(h){return{ctype:"number",value:{real:-h.value.real,imag:-h.value.imag}}};p.re=function(h){return{ctype:"number",value:{real:h.value.real,imag:0}}};
p.im=function(h){return{ctype:"number",value:{real:h.value.imag,imag:0}}};p.conjugate=function(h){return{ctype:"number",value:{real:h.value.real,imag:-h.value.imag}}};p.round=function(h){return{ctype:"number",value:{real:Math.round(h.value.real),imag:Math.round(h.value.imag)}}};p.ceil=function(h){return{ctype:"number",value:{real:Math.ceil(h.value.real),imag:Math.ceil(h.value.imag)}}};p.floor=function(h){return{ctype:"number",value:{real:Math.floor(h.value.real),imag:Math.floor(h.value.imag)}}};p.mult=
function(h,a){return{ctype:"number",value:{real:h.value.real*a.value.real-h.value.imag*a.value.imag,imag:h.value.real*a.value.imag+h.value.imag*a.value.real}}};p.realmult=function(h,a){return{ctype:"number",value:{real:h*a.value.real,imag:h*a.value.imag}}};p.multiMult=function(h){var a=h[0];if("number"!==a.ctype)return y;for(var r=1;r<h.length;r++){if("number"!==h[r].ctype)return y;a=p.mult(a,h[r])}return a};p.abs2=function(h,a){return{ctype:"number",value:{real:h.value.real*h.value.real+h.value.imag*
h.value.imag,imag:0}}};p.abs=function(h){return p.sqrt(p.abs2(h))};p.inv=function(h){var a=h.value.real*h.value.real+h.value.imag*h.value.imag;0===a&&console.log("DIVISION BY ZERO");return{ctype:"number",value:{real:h.value.real/a,imag:-h.value.imag/a}}};p.div=function(h,a){return p.mult(h,p.inv(a))};p.eps=1E-7;p.snap=function(h){var a=h.value.real;h=h.value.imag;Math.floor(a+p.eps)!==Math.floor(a-p.eps)&&(a=Math.round(a));Math.floor(h+p.eps)!==Math.floor(h-p.eps)&&(h=Math.round(h));return{ctype:"number",
value:{real:a,imag:h}}};p.exp=function(h){var a=Math.exp(h.value.real),r=a*Math.cos(h.value.imag);h=a*Math.sin(h.value.imag);return{ctype:"number",value:{real:r,imag:h}}};p.cos=function(h){var a=h.value.real,r=h.value.imag,b=Math.exp(r);h=b*Math.sin(-a);var c=b*Math.cos(-a),b=Math.exp(-r),r=b*Math.sin(a),a=b*Math.cos(a);return{ctype:"number",value:{real:(c+a)/2,imag:(h+r)/2}}};p.sin=function(h){var a=h.value.real,r=h.value.imag,b=Math.exp(r);h=b*Math.sin(-a);var c=b*Math.cos(-a),b=Math.exp(-r),r=
b*Math.sin(a),a=b*Math.cos(a);return{ctype:"number",value:{real:-(h-r)/2,imag:(c-a)/2}}};p.tan=function(h){var a=p.sin(h);h=p.cos(h);return p.div(a,h)};p.arccos=function(h){var a=p.mult(h,p.neg(h)),a=p.sqrt(p.add(p.real(1),a));h=p.add(p.mult(h,p.complex(0,1)),a);h=p.add(p.mult(p.log(h),p.complex(0,1)),p.real(.5*Math.PI));return J.withUsage(h,"Angle")};p.arcsin=function(h){var a=p.mult(h,p.neg(h)),a=p.sqrt(p.add(p.real(1),a));h=p.add(p.mult(h,p.complex(0,1)),a);h=p.mult(p.log(h),p.complex(0,-1));return J.withUsage(h,
"Angle")};p.arctan=function(h){var a=p.log(p.add(p.mult(h,p.complex(0,-1)),p.real(1)));h=p.log(p.add(p.mult(h,p.complex(0,1)),p.real(1)));a=p.mult(p.sub(a,h),p.complex(0,.5));return J.withUsage(a,"Angle")};p.arctan2=function(h,a){var r=p.real(Math.atan2(a.value.real,h.value.real));return J.withUsage(r,"Angle")};p.sqrt=function(h){var a=h.value.real,r=h.value.imag;h=Math.sqrt(Math.sqrt(a*a+r*r));a=Math.atan2(r,a);r=h*Math.sin(a/2);return{ctype:"number",value:{real:h*Math.cos(a/2),imag:r}}};p.pow2=
function(h,a){var r=h.value.real,b=h.value.imag,c=Math.pow(Math.sqrt(r*r+b*b),a),r=Math.atan2(b,r),b=c*Math.sin(r*a);return{ctype:"number",value:{real:c*Math.cos(r*a),imag:b}}};p.log=function(h){var a=h.value.real,r=h.value.imag,b=Math.sqrt(a*a+r*r);h=Math.atan2(r,a);0>r&&(h+=2*Math.PI);0===r&&0>a&&(h=Math.PI);h>Math.PI&&(h-=2*Math.PI);a=Math.log(b);return p.snap({ctype:"number",value:{real:a,imag:h}})};p.pow=function(h,a){if(a.value.real===Math.round(a.value.real)&&0===a.value.imag){for(var r={ctype:"number",
value:{real:1,imag:0}},b=0;b<Math.abs(a.value.real);b++)r=p.mult(r,h);return 0>a.value.real?p.inv(r):r}return p.exp(p.mult(p.log(h),a))};p.mod=function(h,a){var r=h.value.real,b=a.value.real,c=h.value.imag,d=a.value.imag,r=r-Math.floor(r/b)*b,c=c-Math.floor(c/d)*d;0===b&&(r=0);0===d&&(c=0);return p.snap({ctype:"number",value:{real:r,imag:c}})};p._helper={};p._helper.seed="NO";p.eps=1E-10;p.epsbig=1E-6;p._helper.seedrandom=function(h){h-=Math.floor(h);p._helper.seed=.8*h+.1};p._helper.rand=function(){if("NO"===
p._helper.seed)return Math.random();var h=p._helper.seed,h=1E3*Math.sin(1E3*h),h=h-Math.floor(h);return p._helper.seed=h};p._helper.randnormal=function(){var h=p._helper.rand(),a=p._helper.rand();return Math.sqrt(-2*Math.log(h))*Math.cos(2*Math.PI*a)};p._helper.isEqual=function(h,a){return h.value.real===a.value.real&&h.value.imag===a.value.imag};p._helper.isLessThan=function(h,a){return h.value.real<a.value.real||h.value.real===a.value.real&&h.value.imag<a.value.imag};p._helper.compare=function(h,
a){return p._helper.isLessThan(h,a)?-1:p._helper.isEqual(h,a)?0:1};p._helper.isAlmostEqual=function(h,a,r){var b=p.eps;"undefined"!==typeof r&&(b=r);r=h.value.real-a.value.real;h=h.value.imag-a.value.imag;return r<b&&r>-b&&h<b&&h>-b};p._helper.isZero=function(h){return 0===h.value.real&&0===h.value.imag};p._helper.isAlmostZero=function(h){var a=h.value.real;h=h.value.imag;return a<p.eps&&a>-p.eps&&h<p.eps&&h>-p.eps};p._helper.isReal=function(h){return 0===h.value.imag};p._helper.isAlmostReal=function(h){h=
h.value.imag;return h<p.epsbig&&h>-p.epsbig};p._helper.isNaN=function(h){return isNaN(h.value.real)||isNaN(h.value.imag)};p._helper.isAlmostImag=function(h){h=h.value.real;return h<p.epsbig&&h>-p.epsbig};p._helper.z3a=p.complex(-.5,.5*Math.sqrt(3));p._helper.z3b=p.complex(-.5,-.5*Math.sqrt(3));p._helper.cub1={ctype:"list",value:[p.one,p.one,p.one]};p._helper.cub2={ctype:"list",value:[p._helper.z3a,p.one,p._helper.z3b]};p._helper.cub3={ctype:"list",value:[p._helper.z3b,p.one,p._helper.z3a]};p.solveCubic=
function(h,a,r,b){h=p._helper.solveCubicHelper(h,a,r,b);return[n.scalproduct(p._helper.cub1,h),n.scalproduct(p._helper.cub2,h),n.scalproduct(p._helper.cub3,h)]};p._helper.solveCubicHelper=function(h,a,r,b){var c=h.value.real;h=h.value.imag;var d=a.value.real;a=a.value.imag;var e=r.value.real,f=r.value.imag,g=b.value.real,k=b.value.imag;r=c*e-h*f;b=c*f+h*e;var l=4*r-(d*d-a*a),m=4*b-2*d*a,q=c*d-h*a,t=c*a+h*d,u=l*e-m*f-18*(q*g-t*k),m=l*f+m*e-18*(q*k+t*g),v=27*(c*c-h*h),w=54*h*c,l=v*g-w*k,x=v*k+w*g,y=
d*d-a*a,v=2*d*a,z=y*d-v*a,A=y*a+v*d,w=l+4*z,B=x+4*A,z=-2*z+9*(q*e-t*f),A=-2*A+9*(q*f+t*e),z=z-l,A=A-x,l=27*(u*e-m*f+w*g-B*k),m=27*(u*f+m*e+w*k+B*g),w=Math.sqrt(Math.sqrt(l*l+m*m)),B=Math.atan2(m,l),m=w*Math.sin(B/2),l=w*Math.cos(B/2),z=z+(l*c-m*h),A=A+(l*h+m*c),e=Math.exp(Math.log(Math.sqrt(z*z+A*A))/3),m=Math.atan2(A,z),w=e*Math.sin(m/3),B=e*Math.cos(m/3),e=e*e,m=2*m,l=e*Math.sin(m/3),e=e*Math.cos(m/3);r=2*y-6*r;b=2*v-6*b;v=-1.5874010519681996*(d*B-a*w);d=-1.5874010519681996*(d*w+a*B);a=1.2599210498948732*
e;y=1.2599210498948732*l;l=4.762203155904599*(B*c-w*h);m=4.762203155904599*(B*h+w*c);c=l*l+m*m;w=(r*l+b*m)/c;B=(-r*m+b*l)/c;r=w;b=B;w=(v*l+d*m)/c;B=(-v*m+d*l)/c;v=w;d=B;w=(a*l+y*m)/c;B=(-a*m+y*l)/c;a=w;y=B;return n.turnIntoCSList([p.complex(r,b),p.complex(v,d),p.complex(a,y)])};var n={_helper:{},turnIntoCSList:function(h){return{ctype:"list",value:h}},realVector:function(h){for(var a=[],r=0;r<h.length;r++)a[r]={ctype:"number",value:{real:h[r],imag:0}};return{ctype:"list",value:a}},println:function(h){for(var a=
[],r=0;r<h.value.length;r++)if("number"===h.value[r].ctype)a[r]=p.niceprint(h.value[r]);else if("list"===h.value[r].ctype)n.println(h.value[r]);else return y;"number"===h.value[0].ctype&&console.log(a)},realMatrix:function(h){for(var a=h.length,r=Array(a),b=0;b<a;b++)r[b]=n.realVector(h[b]);return n.turnIntoCSList(r)}};n.ex=n.realVector([1,0,0]);n.ey=n.realVector([0,1,0]);n.ez=n.realVector([0,0,1]);n.linfty=n.realVector([0,0,1]);n.ii=n.turnIntoCSList([p.complex(1,0),p.complex(0,1),p.complex(0,0)]);
n.jj=n.turnIntoCSList([p.complex(1,0),p.complex(0,-1),p.complex(0,0)]);n.fundDual=n.realMatrix([[1,0,0],[0,1,0],[0,0,0]]);n.fund=n.realMatrix([[0,0,0],[0,0,0],[0,0,1]]);n.sequence=function(h,a){for(var r=[],b=0,c=Math.round(h.value.real);c<Math.round(a.value.real)+1;c++)r[b]={ctype:"number",value:{real:c,imag:0}},b++;return{ctype:"list",value:r}};n.pairs=function(h){for(var a=[],r=0;r<h.value.length-1;r++)for(var b=r+1;b<h.value.length;b++)a.push({ctype:"list",value:[h.value[r],h.value[b]]});return{ctype:"list",
value:a}};n.triples=function(h){for(var a=[],r=0;r<h.value.length-2;r++)for(var b=r+1;b<h.value.length-1;b++)for(var c=b+1;c<h.value.length;c++)a.push({ctype:"list",value:[h.value[r],h.value[b],h.value[c]]});return{ctype:"list",value:a}};n.triples=function(h){for(var a=[],r=0;r<h.value.length-2;r++)for(var b=r+1;b<h.value.length-1;b++)for(var c=b+1;c<h.value.length;c++)a.push({ctype:"list",value:[h.value[r],h.value[b],h.value[c]]});return{ctype:"list",value:a}};n.cycle=function(h){for(var a=[],r=
0;r<h.value.length-1;r++)a[r]={ctype:"list",value:[h.value[r],h.value[r+1]]};a.push({ctype:"list",value:[h.value[h.value.length-1],h.value[0]]});return{ctype:"list",value:a}};n.consecutive=function(h){for(var a=[],r=0;r<h.value.length-1;r++)a[r]={ctype:"list",value:[h.value[r],h.value[r+1]]};return{ctype:"list",value:a}};n.reverse=function(h){for(var a=[],r=h.value.length-1;0<=r;r--)a.push(h.value[r]);return{ctype:"list",value:a}};n.directproduct=function(h,a){for(var r=[],b=0;b<h.value.length;b++)for(var c=
0;c<a.value.length;c++)r.push({ctype:"list",value:[h.value[b],a.value[c]]});return{ctype:"list",value:r}};n.concat=function(h,a){for(var r=[],b=0;b<h.value.length;b++)r.push(h.value[b]);for(b=0;b<a.value.length;b++)r.push(a.value[b]);return{ctype:"list",value:r}};n.prepend=function(h,a){var r=[];r[0]=h;for(var b=0;b<a.value.length;b++)r[b+1]=a.value[b];return{ctype:"list",value:r}};n.append=function(h,a){for(var r=[],b=0;b<h.value.length;b++)r[b]=h.value[b];r.push(a);return{ctype:"list",value:r}};
n.contains=function(h,a){for(var r=0;r<h.value.length;r++)if(R.equals(h.value[r],a).value)return{ctype:"boolean",value:!0};return{ctype:"boolean",value:!1}};n.common=function(h,a){for(var r=[],b=0,c=0;c<h.value.length;c++){for(var d=!1,e=h.value[c],f=0;f<a.value.length;f++)d=d||R.equals(e,a.value[f]).value;d&&(r[b]=h.value[c],b++)}return{ctype:"list",value:r}};n.remove=function(h,a){for(var r=[],b=0,c=0;c<h.value.length;c++){for(var d=!1,e=h.value[c],f=0;f<a.value.length;f++)d=d||R.equals(e,a.value[f]).value;
d||(r[b]=h.value[c],b++)}return{ctype:"list",value:r}};n._helper.compare=function(h,a){return"number"===h.ctype&&"number"===a.ctype?h.value.real-a.value.real:-1};n.sort1=function(h){h=h.value.sort(J.compare);return n.turnIntoCSList(h)};n._helper.isEqual=function(h,a){return n.equals(h,a).value};n._helper.isLessThan=function(h,a){for(var r=h.value.length,b=a.value.length,c=0;!(c>=r||c>=b)&&J.isEqual(h.value[c],a.value[c]);)c++;return c===r&&c<b?!0:c===b&&c<r||c===r&&c===b?!1:J.isLessThan(h.value[c],
a.value[c])};n._helper.compare=function(h,a){return n._helper.isLessThan(h,a)?-1:n._helper.isEqual(h,a)?0:1};n.equals=function(h,a){if(h.value.length!==a.value.length)return{ctype:"boolean",value:!1};for(var r=!0,b=0;b<h.value.length;b++)var c=h.value[b],d=a.value[b],r="list"===c.ctype&&"list"===d.ctype?r&&n.equals(c,d).value:r&&W([c,d],[]).value;return{ctype:"boolean",value:r}};n.almostequals=function(h,a){if(h.value.length!==a.value.length)return{ctype:"boolean",value:!1};for(var r=!0,b=0;b<h.value.length;b++)var c=
h.value[b],d=a.value[b],r="list"===c.ctype&&"list"===d.ctype?r&&n.comp_almostequals(c,d).value:r&&Z([c,d],[]).value;return{ctype:"boolean",value:r}};n._helper.isAlmostReal=function(h){for(var a=!0,r=0;r<h.value.length;r++)var b=h.value[r],a="list"===b.ctype?a&&n._helper.isAlmostReal(b):a&&p._helper.isAlmostReal(b);return a};n._helper.isAlmostZero=function(h){for(var a=0;a<h.value.length;a++){var r=h.value[a];if("list"===r.ctype){if(!n._helper.isAlmostZero(r))return!1}else if(!p._helper.isAlmostZero(r))return!1}return!0};
n._helper.isNaN=function(h){for(var a=!1,r=0;r<h.value.length;r++)var b=h.value[r],a="list"===b.ctype?a||n._helper.isNaN(b):a||p._helper.isNaN(b);return a};n.set=function(h){var a=[],r=0;h=h.value.sort(J.compare);for(var b=0;b<h.length;b++)0!==b&&W([a[a.length-1],h[b]],[]).value||(a[r]=h[b],r++);return{ctype:"list",value:a}};n.maxval=function(h){for(var a=p.zero,b=0;b<h.value.length;b++){var c=h.value[b];"number"===c.ctype&&(a=p.argmax(a,c));"list"===c.ctype&&(a=p.argmax(a,n.maxval(c)))}return a};
n.maxIndex=function(h,a){for(var b=0,c=a(h.value[0]).value.real,d=1;d<h.value.length;++d){var e=a(h.value[d]).value.real;e>c&&(b=d,c=e)}return b};n.normalizeMax=function(h){var a=p.inv(n.maxval(h));return n.scalmult(a,h)};n.normalizeZ=function(h){var a=p.inv(h.value[2]);return n.scalmult(a,h)};n.normalizeAbs=function(h){var a=p.inv(n.abs(h));return n.scalmult(a,h)};n.max=function(h,a){if(h.value.length!==a.value.length)return y;for(var b=[],c=0;c<h.value.length;c++)b[c]=J.max(h.value[c],a.value[c]);
return{ctype:"list",value:b}};n.min=function(h,a){if(h.value.length!==a.value.length)return y;for(var b=[],c=0;c<h.value.length;c++)b[c]=J.min(h.value[c],a.value[c]);return{ctype:"list",value:b}};n.scaldiv=function(h,a){if("number"!==h.ctype)return y;for(var b=[],c=0;c<a.value.length;c++){var d=a.value[c];b[c]="number"===d.ctype?J.div(d,h):"list"===d.ctype?n.scaldiv(h,d):y}return{ctype:"list",value:b}};n.scalmult=function(h,a){if("number"!==h.ctype)return y;for(var b=[],c=0;c<a.value.length;c++){var d=
a.value[c];b[c]="number"===d.ctype?J.mult(d,h):"list"===d.ctype?n.scalmult(h,d):y}return{ctype:"list",value:b}};n.add=function(h,a){if(h.value.length!==a.value.length)return y;for(var b=[],c=0;c<h.value.length;c++){var d=h.value[c],e=a.value[c];b[c]="number"===d.ctype&&"number"===e.ctype?J.add(d,e):"list"===d.ctype&&"list"===e.ctype?n.add(d,e):y}return{ctype:"list",value:b}};n.sub=function(h,a){if(h.value.length!==a.value.length)return y;for(var b=[],c=0;c<h.value.length;c++){var d=h.value[c],e=a.value[c];
b[c]="number"===d.ctype&&"number"===e.ctype?p.sub(d,e):"list"===d.ctype&&"list"===e.ctype?n.sub(d,e):y}return{ctype:"list",value:b}};n.abs2=function(h){for(var a=0,b=0;b<h.value.length;b++){var c=h.value[b];if("number"===c.ctype)a+=p.abs2(c).value.real;else if("list"===c.ctype)a+=n.abs2(c).value.real;else return y}return{ctype:"number",value:{real:a,imag:0}}};n.abs=function(h){return p.sqrt(n.abs2(h))};n.normalizeMaxXX=function(h){for(var a=-1E4,b=p.real(1),c=0;c<h.value.length;c++){var d=p.abs(h.value[c]);
d.value.real>a&&(b=h.value[c],a=d.value.real)}return n.scaldiv(b,h)};n.recursive=function(h,a){for(var b=[],c=0;c<h.value.length;c++){var d=N(h.value[c]);b[c]="number"===d.ctype?p[a](d):"list"===d.ctype?n[a](d):y}return{ctype:"list",value:b}};n.re=function(h){return n.recursive(h,"re")};n.neg=function(h){return n.recursive(h,"neg")};n.im=function(h){return n.recursive(h,"im")};n.conjugate=function(h){return n.recursive(h,"conjugate")};n.round=function(h){return n.recursive(h,"round")};n.ceil=function(h){return n.recursive(h,
"ceil")};n.floor=function(h){return n.recursive(h,"floor")};n._helper.colNumb=function(h){if("list"!==h.ctype)return-1;for(var a=-1,b=0;b<h.value.length;b++){if("list"!==h.value[b].ctype)return-1;if(0===b)a=h.value[b].value.length;else if(a!==h.value[b].value.length)return-1}return a};n._helper.isNumberVecN=function(h,a){if("list"!==h.ctype||h.value.length!==a)return!1;for(var b=0;b<h.value.length;b++)if("number"!==h.value[b].ctype)return!1;return!0};n.isNumberVector=function(h){if("list"!==h.ctype)return{ctype:"boolean",
value:!1};for(var a=0;a<h.value.length;a++)if("number"!==h.value[a].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};n.isNumberVectorN=function(h,a){if("list"!==h.ctype)return{ctype:"boolean",value:!1};if(h.value)for(var b=0;b<h.value.length;b++)if("number"!==h.value[b].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};n.isNumberMatrix=function(h){if(-1===n._helper.colNumb(h))return{ctype:"boolean",value:!1};for(var a=0;a<h.value.length;a++)if(!n.isNumberVector(h.value[a]).value)return{ctype:"boolean",
value:!1};return{ctype:"boolean",value:!0}};n.scalproduct=function(h,a){if(h.value.length!==a.value.length)return y;for(var b={ctype:"number",value:{real:0,imag:0}},c=0;c<a.value.length;c++){var d=h.value[c],e=a.value[c];if("number"===d.ctype&&"number"===e.ctype)b=p.add(p.mult(d,e),b);else return y}return b};n.sesquilinearproduct=function(h,a){if(h.value.length!==a.value.length)return y;for(var b=0,c=0,d=0;d<a.value.length;d++)var e=h.value[d].value,f=a.value[d].value,b=b+(e.real*f.real+e.imag*f.imag),
c=c+(e.real*f.imag-e.imag*f.real);return p.complex(b,c)};n.normSquared=function(h){for(var a=0,b=0;b<h.value.length;b++)var c=h.value[b].value,a=a+(c.real*c.real+c.imag*c.imag);return p.real(a)};n.productMV=function(h,a){if(h.value[0].value.length!==a.value.length)return y;for(var b=[],c=0;c<h.value.length;c++){for(var d={ctype:"number",value:{real:0,imag:0}},e=h.value[c],f=0;f<a.value.length;f++){var g=e.value[f],k=a.value[f];if("number"===g.ctype&&"number"===k.ctype)d=p.add(p.mult(g,k),d);else return y}b[c]=
d}return n.turnIntoCSList(b)};n.productVM=function(h,a){if(h.value.length!==a.value.length)return y;for(var b=[],c=0;c<a.value[0].value.length;c++){for(var d={ctype:"number",value:{real:0,imag:0}},e=0;e<h.value.length;e++){var f=h.value[e],g=a.value[e].value[c];if("number"===f.ctype&&"number"===g.ctype)d=p.add(p.mult(f,g),d);else return y}b[c]=d}return n.turnIntoCSList(b)};n.productMM=function(h,a){if(h.value[0].value.length!==a.value.length)return y;for(var b=[],c=0;c<h.value.length;c++){var d=n.productVM(h.value[c],
a);b[c]=d}return n.turnIntoCSList(b)};n.mult=function(h,a){return h.value.length===a.value.length&&n.isNumberVector(h).value&&n.isNumberVector(a).value?n.scalproduct(h,a):n.isNumberMatrix(h).value&&a.value.length===h.value[0].value.length&&n.isNumberVector(a).value?n.productMV(h,a):n.isNumberMatrix(a).value&&h.value.length===a.value.length&&n.isNumberVector(h).value?n.productVM(h,a):n.isNumberMatrix(h).value&&n.isNumberMatrix(a)&&a.value.length===h.value[0].value.length?n.productMM(h,a):y};n.projectiveDistMinScal=
function(h,a){var b=n.abs(h),c=n.abs(a);if(0===b.value.real||0===c.value.real)return 0;var d=n.conjugate(a),d=n.scalproduct(h,d),d=p.div(d,p.abs(d)),b=n.scaldiv(b,h),c=n.scaldiv(c,a),c=n.scalmult(d,c),d=n.abs(n.add(b,c)),c=n.abs(n.sub(b,c));return Math.min(d.value.real,c.value.real)};n.crossOperator=function(h){var a=h.value[0],b=h.value[1];h=h.value[2];return n.turnIntoCSList([n.turnIntoCSList([p.zero,p.neg(h),b]),n.turnIntoCSList([h,p.zero,p.neg(a)]),n.turnIntoCSList([p.neg(b),a,p.zero])])};n.cross=
function(h,a){var b=p.sub(p.mult(h.value[1],a.value[2]),p.mult(h.value[2],a.value[1])),c=p.sub(p.mult(h.value[2],a.value[0]),p.mult(h.value[0],a.value[2])),d=p.sub(p.mult(h.value[0],a.value[1]),p.mult(h.value[1],a.value[0]));return n.turnIntoCSList([b,c,d])};n.crossratio3harm=function(h,a,b,c,d){var e=n.det3(h,b,d),f=n.det3(a,c,d);h=n.det3(h,c,d);a=n.det3(a,b,d);e=p.mult(e,f);f=p.mult(h,a);return n.turnIntoCSList([e,f])};n.crossratio3=function(h,a,b,c,d){h=n.crossratio3harm(h,a,b,c,d);return p.div(h.value[0],
h.value[1])};n.veronese=function(h){var a=p.mult(h.value[0],h.value[0]),b=p.mult(h.value[1],h.value[1]),c=p.mult(h.value[2],h.value[2]),d=p.mult(h.value[0],h.value[1]),e=p.mult(h.value[0],h.value[2]);h=p.mult(h.value[1],h.value[2]);return n.turnIntoSCList([a,b,c,d,e,h])};n.matrixFromVeronese=function(h){var a=h.value[0],b=h.value[1],c=h.value[2],d=p.realmult(.5,h.value[3]),e=p.realmult(.5,h.value[4]);h=p.realmult(.5,h.value[5]);return n.turnIntoCSList([n.turnIntoCSList([a,d,e]),n.turnIntoCSList([d,
b,h]),n.turnIntoCSList([e,h,c])])};n.det2=function(h,a){var b=p.mult(h.value[0],a.value[1]);return b=p.sub(b,p.mult(h.value[1],a.value[0]))};n.det3=function(h,a,b){return p.complex(h.value[0].value.real*a.value[1].value.real*b.value[2].value.real-h.value[0].value.imag*a.value[1].value.imag*b.value[2].value.real-h.value[0].value.imag*a.value[1].value.real*b.value[2].value.imag-h.value[0].value.real*a.value[1].value.imag*b.value[2].value.imag+h.value[2].value.real*a.value[0].value.real*b.value[1].value.real-
h.value[2].value.imag*a.value[0].value.imag*b.value[1].value.real-h.value[2].value.imag*a.value[0].value.real*b.value[1].value.imag-h.value[2].value.real*a.value[0].value.imag*b.value[1].value.imag+h.value[1].value.real*a.value[2].value.real*b.value[0].value.real-h.value[1].value.imag*a.value[2].value.imag*b.value[0].value.real-h.value[1].value.imag*a.value[2].value.real*b.value[0].value.imag-h.value[1].value.real*a.value[2].value.imag*b.value[0].value.imag-h.value[0].value.real*a.value[2].value.real*
b.value[1].value.real+h.value[0].value.imag*a.value[2].value.imag*b.value[1].value.real+h.value[0].value.imag*a.value[2].value.real*b.value[1].value.imag+h.value[0].value.real*a.value[2].value.imag*b.value[1].value.imag-h.value[2].value.real*a.value[1].value.real*b.value[0].value.real+h.value[2].value.imag*a.value[1].value.imag*b.value[0].value.real+h.value[2].value.imag*a.value[1].value.real*b.value[0].value.imag+h.value[2].value.real*a.value[1].value.imag*b.value[0].value.imag-h.value[1].value.real*
a.value[0].value.real*b.value[2].value.real+h.value[1].value.imag*a.value[0].value.imag*b.value[2].value.real+h.value[1].value.imag*a.value[0].value.real*b.value[2].value.imag+h.value[1].value.real*a.value[0].value.imag*b.value[2].value.imag,-h.value[0].value.imag*a.value[1].value.imag*b.value[2].value.imag+h.value[0].value.imag*a.value[1].value.real*b.value[2].value.real+h.value[0].value.real*a.value[1].value.real*b.value[2].value.imag+h.value[0].value.real*a.value[1].value.imag*b.value[2].value.real-
h.value[2].value.imag*a.value[0].value.imag*b.value[1].value.imag+h.value[2].value.imag*a.value[0].value.real*b.value[1].value.real+h.value[2].value.real*a.value[0].value.real*b.value[1].value.imag+h.value[2].value.real*a.value[0].value.imag*b.value[1].value.real-h.value[1].value.imag*a.value[2].value.imag*b.value[0].value.imag+h.value[1].value.imag*a.value[2].value.real*b.value[0].value.real+h.value[1].value.real*a.value[2].value.real*b.value[0].value.imag+h.value[1].value.real*a.value[2].value.imag*
b.value[0].value.real+h.value[0].value.imag*a.value[2].value.imag*b.value[1].value.imag-h.value[0].value.imag*a.value[2].value.real*b.value[1].value.real-h.value[0].value.real*a.value[2].value.real*b.value[1].value.imag-h.value[0].value.real*a.value[2].value.imag*b.value[1].value.real+h.value[2].value.imag*a.value[1].value.imag*b.value[0].value.imag-h.value[2].value.imag*a.value[1].value.real*b.value[0].value.real-h.value[2].value.real*a.value[1].value.real*b.value[0].value.imag-h.value[2].value.real*
a.value[1].value.imag*b.value[0].value.real+h.value[1].value.imag*a.value[0].value.imag*b.value[2].value.imag-h.value[1].value.imag*a.value[0].value.real*b.value[2].value.real-h.value[1].value.real*a.value[0].value.real*b.value[2].value.imag-h.value[1].value.real*a.value[0].value.imag*b.value[2].value.real)};n.eucangle=function(h,a){var b=n.cross(h,n.linfty),c=n.cross(a,n.linfty),d=n.det3(n.ez,b,n.ii),b=n.det3(n.ez,b,n.jj),e=n.det3(n.ez,c,n.ii),c=n.det3(n.ez,c,n.jj),d=p.div(p.mult(d,c),p.mult(e,b)),
d=p.log(d);return d=p.mult(d,p.complex(0,.5))};n.zerovector=function(h){h=Math.floor(h.value.real);for(var a=Array(h),b=0;b<h;b++)a[b]=0;return n.realVector(a)};n.zeromatrix=function(h,a){for(var b=Math.floor(h.value.real),c=Array(b),d=0;d<b;d++)c[d]=n.zerovector(a);return n.turnIntoCSList(c)};n.vandermonde=function(h){for(var a=h.value.length,b=n.zeromatrix(a,a),c=0;c<a;c++)for(var d=0;d<a;d++)b.value[c].value[d]=p.pow(h.value[c],p.real(d-1));return b};n.transpose=function(h){for(var a=[],b=h.value[0].value.length,
c=h.value.length,d=0;d<b;d++){for(var e=[],f=0;f<c;f++)e[f]=h.value[f].value[d];a[d]=n.turnIntoCSList(e)}return n.turnIntoCSList(a)};n.column=function(h,a){for(var b=[],c=h.value.length,d=Math.floor(a.value.real-1),e=0;e<c;e++)b[e]=h.value[e].value[d];return n.turnIntoCSList(b)};n.row=function(h,a){for(var b=[],c=h.value[0].value.length,d=Math.floor(a.value.real-1),e=0;e<c;e++)b[e]=h.value[d].value[e];return n.turnIntoCSList(b)};n.adjoint3=function(h){var a,b,c,d,e,f,g,k,l,n,m,p,q,t,u,v,w;a=h.value[0].value;
b=a[0].value;c=b.real;d=b.imag;b=a[1].value;e=b.real;f=b.imag;b=a[2].value;g=b.real;k=b.imag;a=h.value[1].value;b=a[0].value;l=b.real;n=b.imag;b=a[1].value;m=b.real;p=b.imag;b=a[2].value;q=b.real;t=b.imag;a=h.value[2].value;b=a[0].value;h=b.real;u=b.imag;b=a[1].value;v=b.real;w=b.imag;b=a[2].value;a=b.real;b=b.imag;return{ctype:"list",value:[{ctype:"list",value:[{ctype:"number",value:{real:m*a-q*v-p*b+t*w,imag:m*b-q*w-v*t+a*p}},{ctype:"number",value:{real:-e*a+g*v+f*b-k*w,imag:-e*b+g*w+v*k-a*f}},
{ctype:"number",value:{real:e*q-g*m-f*t+k*p,imag:e*t-g*p-m*k+q*f}}]},{ctype:"list",value:[{ctype:"number",value:{real:-l*a+q*h+n*b-t*u,imag:-l*b+q*u+h*t-a*n}},{ctype:"number",value:{real:c*a-g*h-d*b+k*u,imag:c*b-g*u-h*k+a*d}},{ctype:"number",value:{real:-c*q+g*l+d*t-k*n,imag:-c*t+g*n+l*k-q*d}}]},{ctype:"list",value:[{ctype:"number",value:{real:l*v-m*h-n*w+p*u,imag:l*w-m*u-h*p+v*n}},{ctype:"number",value:{real:-c*v+e*h+d*w-f*u,imag:-c*w+e*u+h*f-v*d}},{ctype:"number",value:{real:c*m-e*l-d*p+f*n,imag:c*
p-e*n-l*f+m*d}}]}]}};n.inverse=function(h){var a=n.LUdecomp(h);h=h.value.length;var b=p.real(0),c=p.real(1),d=n.zerovector(p.real(h));d.value[0]=c;for(var e=Array(h),f=0;f<h;f++)e[f]=n._helper.LUsolve(a,d),d.value[f]=b,d.value[f+1]=c;e=n.turnIntoCSList(e);return e=n.transpose(e)};n.linearsolve=function(h,a){return 2===h.value.length?n.linearsolveCramer2(h,a):3===h.value.length?n.linearsolveCramer3(h,a):n.LUsolve(h,a)};n.LUdecomp=function(h){h=JSON.parse(JSON.stringify(h));var a,b,c,d,e,f=0,g,k=h.value.length,
l=k-1,n=Array(k);for(c=0;c<k;++c){e=c;d=h.value[c];g=p.abs(d.value[c]).value.real;for(b=c+1;b<k;++b)a=p.abs(h.value[b].value[c]),g<a.value.real&&(g=a.value.real,e=b);n[c]=e;e!==c&&(h.value[c]=h.value[e],h.value[e]=d,d=h.value[c],f++);b=d.value[c];for(a=c+1;a<k;++a)h.value[a].value[c]=p.div(h.value[a].value[c],b);for(a=c+1;a<k;++a){e=h.value[a];for(b=c+1;b<l;++b)e.value[b]=p.sub(e.value[b],p.mult(e.value[c],d.value[b])),++b,e.value[b]=p.sub(e.value[b],p.mult(e.value[c],d.value[b]));b===l&&(e.value[b]=
p.sub(e.value[b],p.mult(e.value[c],d.value[b])))}}return{LU:h,P:n,TransPos:f}};n.LUsolve=function(h,a){var b=n.LUdecomp(h);return n._helper.LUsolve(b,a)};n._helper.LUsolve=function(h,a){var b=JSON.parse(JSON.stringify(a)),c,d,e=h.LU,f=e.value.length,g=h.P,k;for(c=f-1;-1!==c;--c)b.value[c]=b.value[c];for(c=0;c<f;++c)for(d=g[c],g[c]!==c&&(k=b.value[c],b.value[c]=b.value[d],b.value[d]=k),k=e.value[c],d=0;d<c;++d)b.value[c]=p.sub(b.value[c],p.mult(b.value[d],k.value[d]));for(c=f-1;0<=c;--c){k=e.value[c];
for(d=c+1;d<f;++d)b.value[c]=p.sub(b.value[c],p.mult(b.value[d],k.value[d]));b.value[c]=p.div(b.value[c],k.value[c])}return b};n.linearsolveCramer2=function(h,a){var b=n.column(h,p.real(1)),c=n.column(h,p.real(2)),d=n.det2(b,c);p._helper.isZero(d)&&console.log("A is not regular!");c=n.det2(a,c);c=p.div(c,d);b=n.det2(b,a);b=p.div(b,d);return n.turnIntoCSList([c,b])};n.linearsolveCramer3=function(h,a){var b=n.column(h,p.real(1)),c=n.column(h,p.real(2)),d=n.column(h,p.real(3)),e=n.det3(b,c,d);p._helper.isZero(e)&&
console.log("A is not regular!");var f=n.det3(a,c,d),d=n.det3(b,a,d),b=n.det3(b,c,a),f=n.turnIntoCSList([f,d,b]);return f=n.scaldiv(e,f)};n.linearsolveCGNR=function(h,a){var b=n.transpose(h),c=J.mult(b,h),b=J.mult(b,a);return n.linearsolveCG(c,b)};n.linearsolveCG=function(h,a){var b,c,d,e,f,g;e=a;c=b=n.sub(a,J.mult(h,a));for(var k=Math.ceil(1.2*h.value.length),l=0;l<k;){l++;f=J.mult(h,c);g=d=n.scalproduct(b,b);d=p.div(d,n.scalproduct(c,f));e=n.add(e,J.mult(d,c));b=n.sub(b,J.mult(d,f));if(n.abs(b).value.real<
p.eps)break;d=n.scalproduct(b,b);d=p.div(d,g);c=n.add(b,J.mult(d,c))}l>=k&&console.log("CG did not converge");return e};n.det=function(h){if(1===h.value.length)return h.value[0].value[0];if(2===h.value.length)return n.det2(h.value[0],h.value[1]);if(3===h.value.length)return n.det3(h.value[0],h.value[1],h.value[2]);var a=h.value.length,b=p.real(1),c,d,e=JSON.parse(JSON.stringify(h)),f,g,k,l;for(h=0;h<a-1;h++){d=h;for(c=h+1;c<a;c++)p.abs(e.value[c].value[h]).value.real>p.abs(e.value[d].value[h]).value.real&&
(d=c);d!==h&&(c=e.value[d],e.value[d]=e.value[h],e.value[h]=c,b=p.neg(b));f=e.value[h];for(c=h+1;c<a;c++){g=e.value[c];k=p.div(g.value[h],f.value[h]);for(d=h+1;d<a-1;d+=2)l=d+1,g.value[d]=p.sub(g.value[d],p.mult(f.value[d],k)),g.value[l]=p.sub(g.value[l],p.mult(f.value[l],k));d!==a&&(g.value[d]=p.sub(g.value[d],p.mult(f.value[d],k)))}if(p._helper.isZero(f.value[h]))return p.real(0);b=p.mult(b,f.value[h])}return p.mult(b,e.value[h].value[h])};n.LUdet=function(h){h=n.LUdecomp(h);for(var a=h.LU,b=a.value.length,
c=a.value[0].value[0],d=1;d<b;d++)c=p.mult(c,a.value[d].value[d]);1===h.TransPos%2&&(c=p.neg(c));return c};n.inversereal=function(h){var a,b,c=[],d=[],e=h.value.length;for(a=0;a<e;a++){var f=[],g=[];for(b=0;b<e;b++)f[b]=h.value[a].value[b].value.real,g[b]=h.value[a].value[b].value.imag;c[a]=f;d[a]=g}a=new numeric.T(c,d);h=a.inv(a);c=[];for(a=0;a<e;a++){d=[];for(b=0;b<e;b++)d[b]=p.complex(h.x[a][b],h.y[a][b]);c[a]=n.turnIntoCSList(d)}return n.turnIntoCSList(c)};n.linearsolvereal=function(h,a){for(var b=
[],c=[],d=h.value.length,e=0;e<d;e++){for(var f=[],g=0;g<d;g++)f[g]=h.value[e].value[g].value.real;b[e]=f;c[e]=a.value[e].value.real}b=numeric.solve(b,c);return n.realVector(b)};n.detreal=function(h){for(var a=[],b=[],c=h.value.length,d=0;d<c;d++){for(var e=[],f=[],g=0;g<c;g++)e[g]=h.value[d].value[g].value.real,f[g]=h.value[d].value[g].value.imag;a[d]=e;b[d]=f}new numeric.T(a,b);h=numeric.det(a);return p.real(h)};n.getField=function(h,a){var b;if("homog"===a){if(n._helper.isNumberVecN(h,3))return h;
if(n._helper.isNumberVecN(h,2))return n.turnIntoCSList([h.value[0],h.value[1],p.real(1)])}if("xy"===a){if(n._helper.isNumberVecN(h,2))return h;if(n._helper.isNumberVecN(h,3))return n.turnIntoCSList([p.div(h.value[0],h.value[2]),p.div(h.value[1],h.value[2])])}if("x"===a&&n.isNumberVector(h)){b=h.value.length;if(0<b&&3!==b)return h.value[0];if(3===b)return"Point"===h.usage?p.div(h.value[0],h.value[2]):h.value[0]}if("y"===a&&n.isNumberVector(h)){b=h.value.length;if(1<b&&3!==b)return h.value[1];if(3===
b)return"Point"===h.usage?p.div(h.value[1],h.value[2]):h.value[1]}return"z"===a&&n.isNumberVector(h)&&(b=h.value.length,2<b)?h.value[2]:y};var qb={":":20,".":25,"\u00b0":25,_:50,"^":50,"*":100,"/":100,"+":200,"-":200,"!":200,"==":300,"~=":300,"~<":300,"~>":300,"=:=":300,">=":300,"<=":300,"~>=":300,"~<=":300,">":300,"<":300,"<>":300,"&":350,"%":350,"!=":350,"~!=":350,"..":350,"++":370,"--":370,"~~":370,":>":370,"<:":370,"=":400,":=":400,":=_":400,"::=":400,"->":400,",":500,";":500},la={};la["+"]=f;
la["-"]=t;la["*"]=V;la["/"]=na;la["^"]=ma;la["\u00b0"]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"void"===c.ctype?p.mult(b,p.real(Math.PI/180)):y};la[";"]=function(h,a){var b="void"===h[0].ctype,c="void"===h[1].ctype;if(b&&c)return y;if(!b&&c)return I(h[0]);b||c||I(h[0]);return c?y:I(h[1])};la["="]=U;la[".."]=function(h,a){var b=I(h[0]),c=I(h[1]);return"number"===b.ctype&&"number"===c.ctype?n.sequence(b,c):y};la[":="]=function(h,a){var b="undefined"===h[1].ctype;if("undefined"===
h[0].ctype||b)return y;"function"===h[0].ctype&&(b=h[0].oper,Q[b]={oper:b,body:h[1],arglist:h[0].args});return y};la["=="]=W;la["!="]=function(h,a){return J.not(W(h,a))};la["~="]=Z;la["~!="]=function(h,a){return J.not(Z(h,a))};la[">"]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real>c.value.real}:"string"===b.ctype&&"string"===c.ctype?{ctype:"boolean",value:b.value>c.value}:
y};la["<"]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real<c.value.real}:"string"===b.ctype&&"string"===c.ctype?{ctype:"boolean",value:b.value<c.value}:y};la[">="]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real>=c.value.real}:"string"===b.ctype&&"string"===
c.ctype?{ctype:"boolean",value:b.value>=c.value}:y};la["<="]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real<=c.value.real}:"string"===b.ctype&&"string"===c.ctype?{ctype:"boolean",value:b.value<=c.value}:y};la["~>"]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real>
c.value.real+p.eps}:y};la["~<"]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real<c.value.real-p.eps}:y};la["~>="]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real>c.value.real-p.eps}:y};la["~<="]=function(h,a){var b=N(h[0]),c=N(h[1]);return"number"===b.ctype&&
"number"===c.ctype&&p._helper.isAlmostReal(b)&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:b.value.real<c.value.real+p.eps}:y};la["&"]=T;la["%"]=sa;la["!"]=function(h,a){var b=N(h[0]),c=N(h[1]);return"void"===b.ctype&&"boolean"===c.ctype?{ctype:"boolean",value:!c.value}:y};la._=ta;la["++"]=pa;la["~~"]=ja;la["--"]=va;la[":>"]=Qa;la["<:"]=Pa;var A={},R={evaluate:function(h,a,b){if(Q.hasOwnProperty(h))return Q(h,a,b);var c=A[h];if(c)return c(a,b);var d=h.lastIndexOf("$");if(-1!==d&&(d=h.substr(0,
d),c=A[d]))return c(a,b);console.log("Called undefined function "+d+" (as "+h+")");return y},equals:function(h,a){return"number"===h.ctype&&"number"===a.ctype?{ctype:"boolean",value:h.value.real===a.value.real&&h.value.imag===a.value.imag}:"string"===h.ctype&&"string"===a.ctype||"boolean"===h.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:h.value===a.value}:"list"===h.ctype&&"list"===a.ctype?n.equals(h,a):{ctype:"boolean",value:!1}}},J={_helper:{},order:{undefined:0,boolean:1,number:2,term:3,atomic:4,
variable:5,geo:6,string:7,list:8},string:function(h){return{ctype:"string",value:h}},bool:function(h){return{ctype:"boolean",value:h}},not:function(h){return J.bool(!h.value)},isLessThan:function(h,a){return-1===J.compare(h,a)},isEqual:function(h,a){return 0===J.compare(h,a)},compareResults:function(h,a){return J.compare(h.result,a.result)},compare:function(h,a){if(h.ctype!==a.ctype)return J.order[h.ctype]-J.order[a.ctype];if("number"===h.ctype)return p._helper.compare(h,a);if("list"===h.ctype)return n._helper.compare(h,
a);if("string"===h.ctype)return h.value===a.value?0:h.value<a.value?-1:1;if("boolean"===h.ctype)return h.value===a.value?0:!1===h.value?-1:1},add:function(a,b){return"void"===a.ctype&&"number"===b.ctype?b:"number"===a.ctype&&"number"===b.ctype?p.add(a,b):"string"===a.ctype||"string"===b.ctype?{ctype:"string",value:z(a)+z(b)}:"list"===a.ctype&&"list"===b.ctype?n.add(a,b):y},sub:function(a,b){return"void"===a.ctype&&"number"===b.ctype?p.neg(b):"void"===a.ctype&&"list"===b.ctype?n.neg(b):"number"===
a.ctype&&"number"===b.ctype?p.sub(a,b):"list"===a.ctype&&"list"===b.ctype?n.sub(a,b):y},mult:function(a,b){return"number"===a.ctype&&"number"===b.ctype?p.mult(a,b):"number"===a.ctype&&"list"===b.ctype?n.scalmult(a,b):"list"===a.ctype&&"number"===b.ctype?n.scalmult(b,a):"list"===a.ctype&&"list"===b.ctype?n.mult(a,b):y},div:function(a,b){return"number"===a.ctype&&"number"===b.ctype?p.div(a,b):"list"===a.ctype&&"number"===b.ctype?n.scaldiv(b,a):y},max:function(a,b){return"number"===a.ctype&&"number"===
b.ctype?p.max(a,b):"list"===a.ctype&&"list"===b.ctype?n.max(a,b):y},min:function(a,b){return"number"===a.ctype&&"number"===b.ctype?p.min(a,b):"list"===a.ctype&&"list"===b.ctype?n.min(a,b):y},wrap:function(a){if("number"===typeof a)return p.real(a);if("object"===typeof a&&void 0!==a.length){for(var b=[],c=0;c<a.length;c++)b[c]=J.wrap(a[c]);return n.turnIntoCSList(b)}return"string"===typeof a?{ctype:"string",value:a}:"boolean"===typeof a?{ctype:"boolean",value:a}:y},withUsage:function(a,b){return{ctype:a.ctype,
value:a.value,usage:b}}};A.err$1=function(a,b){"undefined"===typeof gb&&(gb=window.open("","","width=200,height=100"));var c="",d;"variable"===a[0].ctype?(c=a[0].name,d=ca.getvar(a[0].name)):d=a[0];d=c+" ===> "+z(I(d));console&&console.log&&console.log(d);gb&&gb.document.write(d+"<br>");return y};A.errc$1=function(a,b){var c;"variable"===a[0].ctype?(c=I(ca.getvar(a[0].name)),console.log(a[0].name+" ===> "+z(c))):(c=I(a[0]),console.log(" ===> "+z(c)));return y};A.println$1=function(a,b){console.log(z(I(a[0])))};
A.dump$1=function(a,b){console.log(JSON.stringify(a[0]));return y};A.repeat$2=function(a,b){return A.repeat$3([a[0],null,a[1]],b)};A.repeat$3=function(a,b){var c=N(a[0]),d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);if("number"!==c.ctype)return y;var c=Math.round(c.value.real),e=1,f=1,g=c+1,k=!1,l=!1,n=!1,m;void 0!==b.start&&(m=I(b.start),"number"===m.ctype&&(k=!0,f=m.value.real));void 0!==b.step&&(m=I(b.step),"number"===m.ctype&&(n=!0,e=m.value.real));void 0!==b.stop&&(m=I(b.stop),"number"===
m.ctype&&(l=!0,g=m.value.real));!k||l||n||(g=e*c+f);k||!l||n||(f=-e*(c-1)+g,g+=e);k||l||!n||(g=e*c+f);k&&l&&!n&&(e=(g-f)/(c-1),g+=e);k&&!l&&n&&(g=e*c+f);!k&&l&&n&&(f=-e*(c-1)+g,g+=e);k&&l&&n&&(g+=e);(f<=g&&0<e||f>=g&&0>e)&&k&&l&&n&&(c=Math.floor((g-f)/e));ca.newvar(d);g=y;for(k=0;k<c;k++)ca.setvar(d,{ctype:"number",value:{real:k*e+f,imag:0}}),g=I(a[2]);ca.removevar(d);return g};A.while$2=function(a,b){for(var c=a[1],d=a[0],e=I(d),f=y;"list"!==e.ctype&&e.value;)f=I(c),e=I(d);return f};A.apply$2=function(a,
b){return A.apply$3([a[0],null,a[1]],b)};A.apply$3=function(a,b){var c=N(a[0]);if("list"!==c.ctype)return y;var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);var c=c.value,e=[];ca.newvar(d);for(var f=0;f<c.length;f++)ca.setvar(d,c[f]),e[f]=I(a[2]);ca.removevar(d);return{ctype:"list",value:e}};A.forall$2=function(a,b){return A.forall$3([a[0],null,a[1]],b)};A.forall$3=function(a,b){var c=N(a[0]);if("list"!==c.ctype)return y;var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);c=
c.value;ca.newvar(d);for(var e,f=0;f<c.length;f++)ca.setvar(d,c[f]),e=I(a[2]);ca.removevar(d);return e};A.select$2=function(a,b){return A.select$3([a[0],null,a[1]],b)};A.select$3=function(a,b){var c=N(a[0]);if("list"!==c.ctype)return y;var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);var c=c.value,e=[];ca.newvar(d);for(var f=0,g=0;g<c.length;g++){ca.setvar(d,c[g]);var k=I(a[2]);"boolean"===k.ctype&&!0===k.value&&(e[f]=c[g],f++)}ca.removevar(d);return{ctype:"list",value:e}};A.flatten$1=
function(a,b){function c(a,h){return-1===h||"list"!==a.ctype?a:[].concat.apply([],a.value.map(function(a){return c(a,h-1)}))}var d=N(a[0]);if("list"!==d.ctype)return d;var e=b.levels;void 0===e?e=1:(e=I(e),e="number"===e.ctype?e.value.real:"string"===e.ctype&&"all"===e.value?-2:1);return{ctype:"list",value:c(d,e)}};A.createvar$1=function(a,b){"variable"===a[0].ctype&&ca.newvar(a[0].name);return y};A.local=function(a,b){for(var c=0;c<a.length;c++)"variable"===a[c].ctype&&ca.newvar(a[c].name);return y};
A.removevar$1=function(a,b){var c=I(a[0]);"variable"===a[0].ctype&&ca.removevar(a[0].name);return c};A.release=function(a,b){if(0===a.length)return y;for(var c=I(a[a.length-1]),d=0;d<a.length;d++)"variable"===a[d].ctype&&ca.removevar(a[d].name);return c};A.regional=function(a,b){for(var c=0;c<a.length;c++)if("variable"===a[c].ctype){var d=a[c].name;ca.newvar(d);ca.pushVstack(d)}return y};A.genList=function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=I(a[d]);return{ctype:"list",value:c}};R.assigntake=
function(a,b){var c=a.args[0],d=I(c),e=N(a.args[1]),f=y;if("list"===d.ctype||"string"===d.ctype)e=Math.floor(e.value.real),0>e&&(e=d.value.length+e+1),0<e&&e<=d.value.length&&("list"===d.ctype?(d=d.value.slice(),d[e-1]=I(b),f=n.turnIntoCSList(d)):(d=d.value,d=d.substring(0,e-1)+z(I(b))+d.substring(e,d.length),f=J.string(d)));U([c,f])};R.assigndot=function(a,b){var c=I(a.obj),d=a.key;c&&d&&Ha.setField(c.value,d,b);return y};R.assignlist=function(a,b){var c=a.length,d=b.length;d<c&&(c=d);for(d=0;d<
c;d++)U([a[d],b[d]],[])};A.if$2=function(a,b){return A.if$3(a,b)};A.if$3=function(a,b){var c=N(a[0]);if("boolean"===c.ctype){if(!0===c.value)return I(a[1]);if(3===a.length)return I(a[2])}return y};A.and$2=T;A.or$2=sa;A.xor$2=function(a,b){var c=N(a[0]),d=N(a[1]);return"boolean"===c.ctype&&"boolean"===d.ctype?{ctype:"boolean",value:c.value!==d.value}:y};R.genericListMathGen=function(a,b,c){A[a+"$1"]=function(a,h){var d=I(a[0]);if("list"!==d.ctype)return y;d=d.value;if(0===d.length)return c;for(var e=
d[0],f=1;f<d.length;f++)e=b(e,d[f]);return e};var d=a+"$3";A[a+"$2"]=function(a,h){return A[d]([a[0],null,a[1]])};A[d]=function(a,h){var d=N(a[0]);if("list"!==d.ctype)return y;d=d.value;if(0===d.length)return c;var e="#";null!==a[1]&&"variable"===a[1].ctype&&(e=a[1].name);ca.newvar(e);ca.setvar(e,d[0]);for(var f=I(a[2]),g=1;g<d.length;g++){ca.setvar(e,d[g]);var k=I(a[2]),f=b(f,k)}ca.removevar(e);return f}};R.genericListMathGen("product",J.mult,p.real(1));R.genericListMathGen("sum",J.add,p.real(0));
R.genericListMathGen("max",J.max,y);R.genericListMathGen("min",J.min,y);A.max$2=function(a,b){var c=N(a[0]);if("list"===c.ctype)return A.max$3([c,null,a[1]]);var d=N(a[1]);return A.max$1([n.turnIntoCSList([c,d])])};A.min$2=function(a,b){var c=N(a[0]);if("list"===c.ctype)return A.min$3([c,null,a[1]]);var d=N(a[1]);return A.min$1([n.turnIntoCSList([c,d])])};A.add$2=f;A.sub$2=t;A.mult$2=V;A.div$2=na;A.mod$2=function(a,b){var c=N(a[0]),d=N(a[1]);return"number"===c.ctype&&"number"===d.ctype?p.mod(c,d):
y};A.pow$2=ma;A.exp$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.exp(c):y};A.sin$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.sin(c):y};A.sqrt$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.sqrt(c):y};R.laguerre=function(a,b,c){if("list"!==a.ctype)return y;var d=a.value.length-1,e;for(e=0;e<=d;e++)if("number"!==a.value[e].ctype)return y;if("number"!==b.ctype)return y;for(var f=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288],g,k,l,n=1;n<=c;n++){l=p.real(0);
k=p.real(0);g=a.value[d];for(e=d-1;0<=e;e--)l=p.add(k,p.mult(l,b)),k=p.add(g,p.mult(k,b)),g=p.add(a.value[e],p.mult(g,b));if(p._helper.isLessThan(p.abs(g),p.real(1E-14)))break;e=p.div(k,g);k=p.mult(e,e);g=p.sub(k,p.div(p.mult(p.real(2),l),g));l=p.sqrt(p.mult(p.real(d-1),p.sub(p.mult(p.real(d),g),k)));g=p.add(e,l);e=p.sub(e,l);p._helper.isLessThan(p.abs(g),p.abs(e))&&(g=e);e=p._helper.isLessThan(p.real(1E-14),p.abs(g))?p.div(p.real(d),g):p.mult(p.add(p.abs(b),p.real(1)),p.complex(Math.cos(n),Math.sin(n)));
if(p._helper.isLessThan(p.abs(e),p.real(1E-14)))break;0===n%20&&(e=p.mult(e,p.real(f[n/20])));b=p.sub(b,e)}return b};A.roots$1=function(a,b){var c=N(a[0]);if("list"===c.ctype){var d;for(d=0;d<c.value.length;d++)if("number"!==c.value[d].ctype)return y;var e=[],f=c,g=c.value.length-1;for(d=0;d<g;d++){e[d]=R.laguerre(c,p.zero,200);e[d]=R.laguerre(f,e[d],1);var k=[];k[g-d]=c.value[g-d];for(var l=g-d;0<l;l--)k[l-1]=p.add(c.value[l-1],p.mult(k[l],e[d]));k.shift();c=n.turnIntoCSList(k)}return n.sort1(n.turnIntoCSList(e))}return y};
A.autodiff$3=function(a,b){var c="x",d;if("function"===a[0].ctype)d=Q[a[0].oper].body,c=a[0].args[0].name;else if("function"===typeof a[0].impl)d=a[0];else return console.log("could not parse function"),y;var e=N(a[1]),f=N(a[2]);if(1>f.value.real)return console.log("grade cant be < 1"),y;f=p.add(f,p.real(1));return da.autodiff(d,c,e,f)};A.cos$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.cos(c):y};A.tan$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.tan(c):y};A.arccos$1=function(a,
b){var c=N(a[0]);return"number"===c.ctype?p.arccos(c):y};A.arcsin$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.arcsin(c):y};A.arctan$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.arctan(c):y};A.arctan2$2=function(a,b){var c=N(a[0]),d=N(a[1]);return"number"===c.ctype&&"number"===d.ctype?p.arctan2(c,d):y};A.arctan2$1=function(a,b){var c=N(a[0]);return"list"===c.ctype&&2===c.value.length&&(c=c.value,"number"===c[0].ctype&&"number"===c[1].ctype)?A.arctan2$2(c,b):y};A.log$1=function(a,
b){var c=N(a[0]);return"number"===c.ctype?p.log(c):y};R.recursiveGen=function(a){var b=p[a],c=n[a];A[a+"$1"]=function(a,h){var d=N(a[0]);return"number"===d.ctype?b(d):"list"===d.ctype?c(d):y}};R.recursiveGen("im");R.recursiveGen("re");R.recursiveGen("conjugate");R.recursiveGen("round");R.recursiveGen("ceil");R.recursiveGen("floor");R.recursiveGen("abs");A.abs_infix=A.abs$1;A.random$0=function(a,b){return p.real(p._helper.rand())};A.random$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?p.complex(c.value.real*
p._helper.rand(),c.value.imag*p._helper.rand()):y};A.seedrandom$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&p._helper.seedrandom(c.value.real);return y};A.randomnormal$0=function(a,b){return p.real(p._helper.randnormal())};A.randominteger$1=function(a,b){var c=N(a[0]);if("number"===c.ctype){var d=c.value.real|0,c=c.value.imag|0,d=d*p._helper.rand()|0,c=c*p._helper.rand()|0;return p.complex(d,c)}return y};A.randomint$1=A.randominteger$1;A.randombool$0=function(a,b){return.5<p._helper.rand()?
{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.isreal$1=function(a,b){var c=I(a[0]);return"number"===c.ctype&&p._helper.isAlmostReal(c)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.isinteger$1=function(a,b){var c=I(a[0]);return"number"===c.ctype&&p._helper.isAlmostReal(c)&&c.value.real===Math.floor(c.value.real)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.iseven$1=function(a,b){var c=I(a[0]);return"number"===c.ctype&&p._helper.isAlmostReal(c)&&c.value.real/2===Math.floor(c.value.real/
2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.isodd$1=function(a,b){var c=I(a[0]);return"number"===c.ctype&&p._helper.isAlmostReal(c)&&(c.value.real-1)/2===Math.floor((c.value.real-1)/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.iscomplex$1=function(a,b){return"number"===I(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.isstring$1=function(a,b){return"string"===I(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.islist$1=function(a,
b){return"list"===I(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.ismatrix$1=function(a,b){var c=I(a[0]);return-1!==n._helper.colNumb(c)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.isnumbermatrix$1=function(a,b){var c=I(a[0]);return n.isNumberMatrix(c).value?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.isnumbervector$1=function(a,b){var c=I(a[0]);return n.isNumberVector(c).value?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};A.matrixrowcolumn$1=
function(a,b){var c=I(a[0]);return-1!==n._helper.colNumb(c)?n.realVector([c.value.length,c.value[0].value.length]):y};A.rowmatrix$1=function(a,b){var c=I(a[0]);return"list"===c.ctype?n.turnIntoCSList([c]):y};A.columnmatrix$1=function(a,b){var c=I(a[0]);return"list"===c.ctype?n.turnIntoCSList(c.value.map(function(a){return n.turnIntoCSList([a])})):y};A.submatrix$3=function(a,b){var c=I(a[0]),d=I(a[1]),e=I(a[2]);if("list"===c.ctype&&"number"===d.ctype&&"number"===e.ctype){var f=Math.round(d.value.real),
d=Math.round(e.value.real),c=c.value.slice();0<d&&d<=c.length&&c.splice(d-1,1);var g=!0,c=c.map(function(a){if("list"!==a.ctype)g=!1;else return a=a.value.slice(),0<f&&f<=a.length&&a.splice(f-1,1),n.turnIntoCSList(a)});return g?n.turnIntoCSList(c):y}return y};A.complex$1=function(a,b){var c,d,e;e=N(a[0]);if("list"===e.ctype&&n.isNumberVector(e)){if(2===e.value.length)return c=e.value[0],d=e.value[1],p.complex(c.value.real-d.value.imag,d.value.real+c.value.imag);if(3===e.value.length)return c=e.value[0],
d=e.value[1],e=e.value[2],c=p.div(c,e),d=p.div(d,e),p.complex(c.value.real-d.value.imag,d.value.real+c.value.imag)}return y};A.gauss$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?n.realVector([c.value.real,c.value.imag]):y};A.cross$2=function(a,b){var c=ga(a[0]),d=ga(a[1]);if(c!==y&&d!==y){var e=n.cross(c,d);"Point"===c.usage&&"Point"===d.usage&&(e=J.withUsage(e,"Line"));"Line"===c.usage&&"Line"===d.usage&&(e=J.withUsage(e,"Point"));return e}return y};A.para$2=function(a,b){var c=N(a[0]),
d=N(a[1]),e=ga(c),f=ga(d);if(c!==y&&d!==y){var d=d.usage,g=e,k=f;if("Line"===c.usage||"Point"===d)g=f,k=e;c=n.cross(n.cross(n.linfty,k),g);return J.withUsage(c,"Line")}return y};A.perp$2=function(a,b){var c=N(a[0]),d=N(a[1]),e=ga(c),f=ga(d);if(c!==y&&d!==y){var g=d.usage||f.usage,d=e,k=f;if("Line"===(c.usage||e.usage)||"Point"===g)d=f,k=e;c=n.turnIntoCSList([k.value[0],k.value[1],p.zero]);c=n.cross(c,d);return J.withUsage(c,"Line")}};A.perp$1=function(a,b){var c=N(a[0]);return n._helper.isNumberVecN(c,
2)?n.turnIntoCSList([p.neg(c.value[1]),c.value[0]]):y};A.parallel$2=A.para$2;A.perpendicular$2=A.perp$2;A.perpendicular$1=A.perp$1;A.meet$2=function(a,b){var c=ga(a[0]),d=ga(a[1]);return c!==y&&d!==y?(c=n.cross(c,d),J.withUsage(c,"Point")):y};A.join$2=function(a,b){var c=ga(a[0]),d=ga(a[1]);return c!==y&&d!==y?(c=n.cross(c,d),J.withUsage(c,"Line")):y};A.dist$2=function(a,b){var c=N(a[0]),d=N(a[1]),c=t([c,d],[]);return A.abs$1([c],[])};A.dist_infix=A.dist$2;A.point$1=function(a,b){var c=I(a[0]);return n._helper.isNumberVecN(c,
3)||n._helper.isNumberVecN(c,2)?J.withUsage(c,"Point"):c};A.line$1=function(a,b){var c=I(a[0]);return n._helper.isNumberVecN(c,3)?J.withUsage(c,"Line"):c};A.det$3=function(a,b){var c=ga(a[0]),d=ga(a[1]),e=ga(a[2]);if(c!==y&&d!==y&&e!==y)return n.det3(c,d,e)};A.det$1=function(a,b){var c=N(a[0]);if("list"===c.ctype){var d=n._helper.colNumb(c);if(-1!==d&&d===c.value.length)return n.det(c)}return y};A.area$3=function(a,b){var c=ga(a[0]),d=ga(a[1]),e=ga(a[2]);if(c!==y&&d!==y&&e!==y){var f=c.value[2],g=
d.value[2],k=e.value[2];if(!p._helper.isAlmostZero(f)&&!p._helper.isAlmostZero(g)&&!p._helper.isAlmostZero(k))return c=n.scaldiv(f,c),d=n.scaldiv(g,d),e=n.scaldiv(k,e),c=n.det3(c,d,e),p.realmult(.5,c)}return y};A.inverse$1=function(a,b){var c=N(a[0]);if("list"===c.ctype){var d=n._helper.colNumb(c);if(-1!==d&&d===c.value.length)return n.inverse(c)}return y};A.linearsolve$2=function(a,b){var c=N(a[0]),d=N(a[1]);if("list"===c.ctype){var e=n._helper.colNumb(c);if(-1!==e&&e===c.value.length&&n._helper.isNumberVecN(d,
e))return n.linearsolve(c,d)}return y};var ec=[[[]],[[0]],[[0,1],[1,0]],[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],[[0,1,2,3],[0,1,3,2],[0,2,1,3],[0,2,3,1],[0,3,1,2],[0,3,2,1],[1,0,2,3],[1,0,3,2],[1,2,0,3],[1,2,3,0],[1,3,0,2],[1,3,2,0],[2,0,1,3],[2,0,3,1],[2,1,0,3],[2,1,3,0],[2,3,0,1],[2,3,1,0],[3,0,1,2],[3,0,2,1],[3,1,0,2],[3,1,2,0],[3,2,0,1],[3,2,1,0]]];A.mincostmatching$1=function(a,b){var c=I(a[0]);if(n.isNumberMatrix(c)){var d=c.value.length,e=n._helper.colNumb(c),f=d<e?e:d,g,k,l=Array(f);
for(g=0;g<f;++g)for(l[g]=Array(f),k=0;k<f;++k)l[g][k]=g<d&&k<e?c.value[g].value[k].value.real:0;c=ha(l);f=Array(d);for(g=0;g<d;++g)k=c[g],f[g]=k<e?p.real(k+1):p.real(0);return n.turnIntoCSList(f)}return y};A.length$1=function(a,b){var c=I(a[0]);return"list"===c.ctype||"string"===c.ctype?p.real(c.value.length):y};A.pairs$1=function(a,b){var c=I(a[0]);return"list"===c.ctype?n.pairs(c):y};A.triples$1=function(a,b){var c=I(a[0]);return"list"===c.ctype?n.triples(c):y};A.cycle$1=function(a,b){var c=I(a[0]);
return"list"===c.ctype?n.cycle(c):y};A.consecutive$1=function(a,b){var c=I(a[0]);return"list"===c.ctype?n.consecutive(c):y};A.reverse$1=function(a,b){var c=I(a[0]);return"list"===c.ctype?n.reverse(c):y};A.directproduct$2=function(a,b){var c=I(a[0]),d=I(a[1]);return"list"===c.ctype&&"list"===d.ctype?n.directproduct(c,d):y};A.concat$2=pa;A.common$2=ja;A.remove$2=va;A.append$2=Qa;A.prepend$2=Pa;A.contains$2=function(a,b){var c=I(a[0]),d=I(a[1]);return"list"===c.ctype?n.contains(c,d):y};A.sort$2=function(a,
b){return A.sort$3([a[0],null,a[1]],b)};A.sort$3=function(a,b){var c=N(a[0]);if("list"!==c.ctype)return y;var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);var c=c.value,e=[];ca.newvar(d);var f;for(f=0;f<c.length;f++)ca.setvar(d,c[f]),e[f]={val:c[f],result:I(a[2])};ca.removevar(d);e.sort(J.compareResults);d=[];for(f=0;f<c.length;f++)d[f]=e[f].val;return{ctype:"list",value:d}};A.sort$1=function(a,b){var c=I(a[0]);return"list"===c.ctype?n.sort1(c):y};A.set$1=function(a,b){var c=I(a[0]);
return"list"===c.ctype?n.set(c):y};A.combinations$2=function(a,b){function c(a,h){a===g?l.push(n.turnIntoCSList(k.slice())):h<f&&(k[a]=d.value[h],c(a+1,h+1),c(a,h+1))}var d=I(a[0]),e=I(a[1]),f,g,k,l;if("number"===e.ctype){g=e.value.real|0;if("number"===d.ctype){f=d.value.real|0;f-g<g&&(g=f-g);if(0>g)return p.real(0);if(0===g)return p.real(1);if(1===g)return d;for(var m=e=1,q=1;q<=g;++q)var t=f-g+q|0,u=q|0,v=Va(t,u)|0,t=t/v|0,u=u/v|0,v=Va(e,u)|0,e=e/v|0,u=u/v|0,v=Va(t,m)|0,t=t/v|0,m=m/v|0,e=e*t|0,
m=m*u|0;return p.real(e/m)}if("list"===d.ctype){f=d.value.length;if(0>g||g>f)return n.turnIntoCSList([]);if(0===g)return n.turnIntoCSList([n.turnIntoCSList([])]);if(g===f)return n.turnIntoCSList([d]);l=[];k=Array(g);c(0,0);return n.turnIntoCSList(l)}}return y};A.zeromatrix$2=function(a,b){var c=N(a[0]),d=N(a[1]);return"number"===c.ctype&&"number"===d.ctype?n.zeromatrix(c,d):y};A.zerovector$1=function(a,b){var c=N(a[0]);return"number"===c.ctype?n.zerovector(c):y};A.transpose$1=function(a,b){var c=
N(a[0]);return"list"===c.ctype&&-1!==n._helper.colNumb(c)?n.transpose(c):y};A.row$2=function(a,b){var c=N(a[0]),d=N(a[1]);return"number"===d.ctype&&"list"===c.ctype&&-1!==n._helper.colNumb(c)?n.row(c,d):y};A.column$2=function(a,b){var c=N(a[0]),d=N(a[1]);return"number"===d.ctype&&"list"===c.ctype&&-1!==n._helper.colNumb(c)?n.column(c,d):y};A.red$1=function(a,b){var c=I(a[0]);return"number"===c.ctype?(c=Math.min(1,Math.max(0,c.value.real)),n.realVector([c,0,0])):y};A.green$1=function(a,b){var c=I(a[0]);
return"number"===c.ctype?(c=Math.min(1,Math.max(0,c.value.real)),n.realVector([0,c,0])):y};A.blue$1=function(a,b){var c=I(a[0]);return"number"===c.ctype?(c=Math.min(1,Math.max(0,c.value.real)),n.realVector([0,0,c])):y};A.gray$1=function(a,b){var c=I(a[0]);return"number"===c.ctype?(c=Math.min(1,Math.max(0,c.value.real)),n.realVector([c,c,c])):y};A.grey$1=A.gray$1;R.HSVtoRGB=function(a,b,c){var d,e,f,g,k,l;a&&void 0===b&&void 0===c&&(b=a.s,c=a.v,a=a.h);g=Math.floor(6*a);k=6*a-g;a=c*(1-b);l=c*(1-k*b);
b=c*(1-(1-k)*b);switch(g%6){case 0:d=c;e=b;f=a;break;case 1:d=l;e=c;f=a;break;case 2:d=a;e=c;f=b;break;case 3:d=a;e=l;f=c;break;case 4:d=b;e=a;f=c;break;case 5:d=c,e=a,f=l}return n.realVector([d,e,f])};A.hue$1=function(a,b){var c=I(a[0]);return"number"===c.ctype?(c=c.value.real,c-=Math.floor(c),R.HSVtoRGB(c,1,1)):y};R.shapeconvert=function(a){var b,c;if("circle"===a.type){b=a.value.value[0];b=J.div(b,b.value[2]);var d=b.value[0].value.real,e=b.value[1].value.real;a=a.value.value[1].value.real;c=[];
var f=2*Math.PI/36;for(b=0;36>b;b++)c[b]={X:d+Math.cos(b*f)*a,Y:e+Math.sin(b*f)*a};return[c]}if("polygon"===a.type){d=[];for(b=0;b<a.value.length;b++){e=a.value[b];c=[];for(f=0;f<e.length;f++)c[f]={X:e[f].X,Y:e[f].Y};d[b]=c}return d}};R.shapeop=function(a,b,c){a=R.shapeconvert(a);var d=R.shapeconvert(b);ClipperLib.JS.ScaleUpPaths(a,1E3);ClipperLib.JS.ScaleUpPaths(d,1E3);b=new ClipperLib.Clipper;b.AddPaths(a,ClipperLib.PolyType.ptSubject,!0);b.AddPaths(d,ClipperLib.PolyType.ptClip,!0);var d=a=ClipperLib.PolyFillType.pftNonZero,
e=new ClipperLib.Paths;b.Execute(c,e,a,d);ClipperLib.JS.ScaleDownPaths(e,1E3);return{ctype:"shape",type:"polygon",value:e}};R.shapecommon=function(a,b){return R.shapeop(a,b,ClipperLib.ClipType.ctIntersection)};R.shaperemove=function(a,b){return R.shapeop(a,b,ClipperLib.ClipType.ctDifference)};R.shapeconcat=function(a,b){return R.shapeop(a,b,ClipperLib.ClipType.ctUnion)};A.key$0=function(a,b){return{ctype:"string",value:Jb}};A.keycode$0=function(a,b){return p.real(Kb)};A.mouse$0=function(a,b){return n.realVector([eb[0],
eb[1]])};A.mover$0=function(a,b){if(xa&&xa.mover)return{ctype:"geo",value:xa.mover,type:"P"};console.log("Not moving anything at the moment");return y};A.translate$1=function(a,b){var c=N(a[0]);"list"===c.ctype&&n.isNumberVector(c)&&2===c.value.length&&B.translate(c.value[0].value.real,c.value[1].value.real);return y};A.rotate$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&B.rotate(c.value.real);return y};A.scale$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&B.scale(c.value.real);return y};
A.greset$0=function(a,b){var c=Oa.stack.length;B.greset();for(var d=0;d<c;d++)M.restore();return y};A.gsave$0=function(a,b){B.gsave();M.save();return y};A.grestore$0=function(a,b){B.grestore();M.restore();return y};A.color$1=function(a,b){var c=N(a[0]);"list"===c.ctype&&n.isNumberVector(c).value&&B.setcolor(c);return y};A.linecolor$1=function(a,b){var c=N(a[0]);"list"===c.ctype&&n.isNumberVector(c).value&&B.setlinecolor(c);return y};A.pointcolor$1=function(a,b){var c=N(a[0]);"list"===c.ctype&&n.isNumberVector(c).value&&
B.setpointcolor(c);return y};A.alpha$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&B.setalpha(c);return y};A.pointsize$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&B.setpointsize(c);return y};A.linesize$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&B.setlinesize(c);return y};A.textsize$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&B.settextsize(c);return y};A.playanimation$0=function(a,b){d();return y};A.pauseanimation$0=function(a,b){m();return y};A.stopanimation$0=function(a,b){u();
return y};A.replace$3=function(a,b){var c=I(a[0]),d=I(a[1]),e=I(a[2]);if("string"===c.ctype&&"string"===d.ctype&&"string"===e.ctype)return c=c.value,c=c.replace(new RegExp(d.value,"g"),e.value),{ctype:"string",value:c}};A.replace$2=function(a,b){function c(a,h,b){var f="";e=d=-1;for(var r=0;r<h.length;r++){var g=h[r][0],k=a.indexOf(g,b);-1!==k&&(-1===d?(f=g,d=k,e=r):k<d&&(f=g,d=k,e=r))}return f}var d,e,f,g=I(a[0]);f=I(a[1]);if("string"===g.ctype&&"list"===f.ctype){for(var g=g.value,k=[],l=0;l<f.value.length;l++){var n=
f.value[l];"list"===n.ctype&&2===n.value.length&&"string"===n.value[0].ctype&&"string"===n.value[1].ctype&&(k[k.length]=[n.value[0].value,n.value[1].value])}d=-1;for(f=c(g,k,0);-1!==d;)g=g.substring(0,d)+k[e][1]+g.substring(d+f.length,g.length),f=d+k[e][1].length,f=c(g,k,f);return{ctype:"string",value:g}}return y};A.substring$3=function(a,b){var c=I(a[0]),d=N(a[1]),e=N(a[2]);return"string"===c.ctype&&"number"===d.ctype&&"number"===e.ctype?{ctype:"string",value:c.value.substring(Math.floor(d.value.real),
Math.floor(e.value.real))}:y};A.tokenize$2=function(a,b){var c,d;c=I(a[0]);var e=I(a[1]);if("string"===c.ctype&&"string"===e.ctype){var f=!0;void 0!==b.autoconvert&&(d=I(b.autoconvert),"boolean"===d.ctype&&(f=d.value));e=c.value.split(e.value);c=[];for(d=0;d<e.length;d++){var g=e[d];if(f){var k=parseFloat(g);isNaN(k)||(g=k)}c[d]={ctype:"string",value:g}}return n.turnIntoCSList(c)}if("string"===c.ctype&&"list"===e.ctype){if(0===e.value.length)return c;c=e.value[0];f=n.turnIntoCSList(f);g=A.tokenize$2([a[0],
c],b).value;c=[];for(d=0;d<g.length;d++){f=[];for(k=1;k<e.value.length;k++)f[k-1]=e.value[k];f=n.turnIntoCSList(f);c[d]=A.tokenize$2([g[d],f],b)}return n.turnIntoCSList(c)}return y};A.indexof$2=function(a,b){var c=I(a[0]),d=I(a[1]);return"string"===c.ctype&&"string"===d.ctype?(c=c.value.indexOf(d.value),p.real(c+1)):y};A.indexof$3=function(a,b){var c=I(a[0]),d=I(a[1]),e=I(a[2]);return"string"===c.ctype&&"string"===d.ctype&&"number"===e.ctype?(c=c.value,d=d.value,e=Math.round(e.value.real),e=c.indexOf(d,
e-1),p.real(e+1)):y};A.parse$1=function(a,b){var c=I(a[0]);return"string"===c.ctype?(c=db(c.value),c=Fa(c),I(c)):y};A.unicode$1=function(a,b){var c;c=I(a[0]);var d=16;if(b.base){var e=I(b.base);"number"===e.ctype&&(d=e.value.real)}if("string"===c.ctype)c=parseInt(c.value,d);else if("number"===c.ctype)c=c.value.real;else return y;"undefined"!==typeof String.fromCodePoint?c=String.fromCodePoint(c):65535>=c?c=String.fromCharCode(c):(c-=65536,c=String.fromCharCode((c>>10)+55296,(c&1023)+56320));return J.string(c)};
A.international$1=function(a,b){return A.international$2([a[0],null],b)};A.international$2=function(h,b){var c=I(h[0]);if("string"!==c.ctype)return y;var d=(a.translations||{})[a.language||"en"]||{};if(!d.hasOwnProperty(c.value))return c;var e=d[c.value];if("string"===typeof e)return J.string(e);if(null===h[1])return c;var f=I(h[1]),f="number"===f.ctype?f.value.real:0,d=(d._pluralFormFunction||Ka)(f);return d<e.length?J.string(e[d]):c};A.currentlanguage$0=function(h,b){return J.string(a.language||
"en")};R.basismap=function(a,b,c,d){var e=n.turnIntoCSList([a,b,c]),e=n.inverse(n.transpose(e));d=J.mult(e,d);e=n.turnIntoCSList([J.mult(d.value[0],a),J.mult(d.value[1],b),J.mult(d.value[2],c)]);return n.transpose(e)};A.map$8=function(a,b){var c=ga(a[0]),d=ga(a[1]),e=ga(a[2]),f=ga(a[3]),g=ga(a[4]),k=ga(a[5]),l=ga(a[6]),m=ga(a[7]);return g!==y&&k!==y&&l!==y&&m!==y&&c!==y&&d!==y&&e!==y&&f!==y?(g=R.basismap(g,k,l,m),c=R.basismap(c,d,e,f),c=J.mult(g,n.inverse(c)),n.normalizeMax(c)):y};A.map$6=function(a,
b){var c=ga(a[0]),d=ga(a[1]),e=ga(a[2]),f=n.realVector([0,0,1]),g=n.cross,k=g(g(e,g(f,g(c,d))),g(d,g(f,g(c,e)))),l=ga(a[3]),m=ga(a[4]),p=ga(a[5]),f=g(g(p,g(f,g(l,m))),g(m,g(f,g(l,p))));return l!==y&&m!==y&&p!==y&&f!==y&&c!==y&&d!==y&&e!==y&&k!==y?(l=R.basismap(l,m,p,f),c=R.basismap(c,d,e,k),c=J.mult(l,n.inverse(c)),n.normalizeMax(c)):y};A.map$4=function(a,b){var c=n.ii,d=n.jj,e=ga(a[0]),f=ga(a[1]),g=ga(a[2]),k=ga(a[3]);return g!==y&&k!==y&&e!==y&&f!==y?(g=R.basismap(g,k,c,d),c=R.basismap(e,f,c,d),
c=J.mult(g,n.inverse(c)),n.normalizeMax(c)):y};A.map$2=function(a,b){var c=n.ii,d=n.jj,e=ga(a[0]),f=J.add(n.realVector([1,0,0]),e),g=ga(a[1]),k=J.add(n.realVector([1,0,0]),g);return g!==y&&k!==y&&e!==y&&f!==y?(g=R.basismap(g,k,c,d),c=R.basismap(e,f,c,d),c=J.mult(g,n.inverse(c)),n.normalizeMax(c)):y};A.pointreflect$1=function(a,b){var c=n.ii,d=n.jj,e=ga(a[0]),f=J.add(n.realVector([1,0,0]),e),g=J.add(n.realVector([-1,0,0]),e);return g!==y&&e!==y&&f!==y?(g=R.basismap(e,g,c,d),c=R.basismap(e,f,c,d),c=
J.mult(g,n.inverse(c)),n.normalizeMax(c)):y};A.linereflect$1=function(a,b){var c=n.ii,d=n.jj,e=ga(a[0]),f=n.realVector([Math.random(),Math.random(),Math.random()]),g=n.realVector([Math.random(),Math.random(),Math.random()]),f=n.cross(f,e),g=n.cross(g,e);return e!==y&&f!==y?(e=R.basismap(f,g,c,d),c=R.basismap(f,g,d,c),c=J.mult(e,n.inverse(c)),n.normalizeMax(c)):y};R.extractPointVec=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=Ha.getField(c,"x"),b.y=Ha.getField(c,
"y"),b.z=p.real(1),b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a,b.y=c,b.z=p.real(1),b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(b.x=p.div(a,d),b.y=p.div(c,d),b.z=p.real(1),b.ok=!0));return b};A.polygon$1=function(a,b){var c=I(a[0]);if("list"===c.ctype){for(var d=[],e=0;e<c.value.length;e++){var f=R.extractPoint(c.value[e]);if(!f.ok)return y;d[e]=
{X:f.x,Y:f.y}}return{ctype:"shape",type:"polygon",value:[d]}}return y};A.circle$2=function(a,b){var c=N(a[0]),d=N(a[1]),c=R.extractPointVec(c);if(!c.ok||"number"!==d.ctype)return y;c=n.turnIntoCSList([c.x,c.y,c.z]);return{ctype:"shape",type:"circle",value:n.turnIntoCSList([c,d])}};A.screen$0=function(a,b){var c=B.drawingstate.initialmatrix,d=function(a,h){var b=a-c.tx,d=h+c.ty;return{X:(b*c.d-d*c.b)/c.det,Y:-(-b*c.c+d*c.a)/c.det}};return{ctype:"shape",type:"polygon",value:[[d(0,0),d(Aa,0),d(Aa,ua),
d(0,ua)]]}};A.allpoints$0=function(a,b){for(var c=[],d=0;d<P.points.length;d++)c[d]={ctype:"geo",value:P.points[d],type:"P"};return{ctype:"list",value:c}};A.allmasses$0=function(a,b){for(var c=[],d=0;d<ra.length;d++)c[d]={ctype:"geo",value:ra[d],type:"P"};return{ctype:"list",value:c}};A.alllines$0=function(a,b){for(var c=[],d=0;d<P.lines.length;d++)c[d]={ctype:"geo",value:P.lines[d],type:"L"};return{ctype:"list",value:c}};A.halfplane$2=function(a,b){var c=N(a[0]),d=N(a[1]),e=ga(c),f=ga(d);if(c!==
y&&d!==y){var g=d.usage,d=f;if("Line"===c.usage||"Point"===g)e=f,d=c;c=n.turnIntoCSList([d.value[0],d.value[1],p.zero]);c=n.cross(c,e);f=n.cross(d,c);f=J.div(f,f.value[2]);e=J.div(e,e.value[2]);e=n.sub(e,f);c=n.abs(e);e=J.div(e,c);c=f.value[0].value.real;f=f.value[1].value.real;d=1E3*e.value[0].value.real;e=1E3*e.value[1].value.real;return{ctype:"shape",type:"polygon",value:[[{X:c+e/2,Y:f-d/2},{X:c+e/2+d,Y:f-d/2+e},{X:c-e/2+d,Y:f+d/2+e},{X:c-e/2,Y:f+d/2}]]}}return y};A.convexhull3d$1=function(a,b){var c=
I(a[0]);if("list"===c.ctype){var d=c.value;if(4>d.length)return console.error("Less than four input points specified"),y;for(var e=[],f,c=0;c<d.length;c++)if(n._helper.isNumberVecN(d[c],3))for(f=0;3>f;f++)e.push(d[c].value[f].value.real);f=convexhull(e);d=f[0];e=[];for(c=0;c<d.length;c+=3)e.push(n.realVector([d[c],d[c+1],d[c+2]]));for(var d=n.turnIntoCSList(e),e=f[1],g=[],c=0;c<e.length;c++){for(f=0;f<e[c].length;f++)e[c][f]++;g.push(n.realVector(e[c]))}c=n.turnIntoCSList(g);return n.turnIntoCSList([d,
c])}return y};A.javascript$1=function(a,b){var c=I(a[0]);"string"===c.ctype&&(new Function(c.value)).call(Ma);return y};A.use$1=function(h,b){function c(a,h,b){var d=A[a];A[a]=function(c,e){if(c.length===h)return b(c,e);if(d)return d(c,e);throw"No implementation for "+a+"("+h+")";}}var d=I(h[0]);if("string"===d.ctype){var d=d.value,e;a.plugins&&(e=a.plugins[d]);e||(e=Xa._pluginRegistry[d]);if(e)return e({instance:Ma,config:a,nada:y,evaluate:I,evaluateAndVal:N,defineFunction:c,addShutdownHook:bb.push.bind(bb),
addAutoCleaningEventListener:x,getVariable:ca.getvar.bind(ca),getInitialMatrix:function(){return B.drawingstate.initialmatrix}}),{ctype:"boolean",value:!0};console.log("Plugin "+d+" not found");return{ctype:"boolean",value:!1}}return y};A.format$2=function(a,b){function c(a){a=a.toFixed(g);var h;do h=a,a=a.substring(0,a.length-1);while(""!==a&&"-"!==a&&+a===+h);return""+h}function d(a){var h;return"number"===a.ctype?(h=c(a.value.real),a=c(a.value.imag),h="0"===a?h:"-"===a.substring(0,1)?h+" - i*"+
a.substring(1):h+" + i*"+a,{ctype:"string",value:h}):"list"===a.ctype?{ctype:"list",value:a.value.map(d)}:{ctype:"string",value:z(a).toString()}}var e=N(a[0]),f=N(a[1]),g;return"number"!==e.ctype&&"list"!==e.ctype||"number"!==f.ctype?y:(g=Math.round(f.value.real),d(e))};Date.now||(Date.now=function(){return(new Date).getTime()});var Xb=0;A.seconds$0=function(a,b){return{ctype:"number",value:{real:(Date.now()-Xb)/1E3,imag:0}}};A.resetclock$0=function(a,b){Xb=Date.now();return y};A.time$0=function(a,
b){var c=new Date;return n.realVector([c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()])};A.date$0=function(a,b){var c=new Date;return n.realVector([c.getFullYear(),c.getMonth(),c.getDay()])};A.setTimeout$2=function(a,b){function c(){I(e);E()}var d=I(a[0]),e=a[1];"number"===d.ctype&&"undefined"!==typeof window&&window.setTimeout(c,1E3*d.value.real);return y};R.formatForWebGL=function(a){return a.toFixed(10)};A.generateWebGL$2=function(a,b){var c=R.formatForWebGL,d=a[0],e=I(a[1]);console.log(e);
if("list"!==e.ctype)return y;for(var f=[],g=0;g<e.value.length;g++)"string"===e.value[g].ctype&&f.push(e.value[g].value);console.log("***********");console.log(f);e=R.plotvars(d);console.log(e);-1===e.indexOf("a")&&-1===e.indexOf("b")&&-1===e.indexOf("c")&&-1===e.indexOf("d")&&-1===e.indexOf("e")&&-1===e.indexOf("f")&&(d=N(d));if("number"===d.ctype)return{ctype:"string",value:"vec2("+c(d.value.real)+","+c(d.value.imag)+")"};if("variable"===d.ctype)return{ctype:"string",value:d.name};if("string"===
d.ctype||"void"===d.ctype)return d;if(2===d.args.length&&("infix"===d.ctype||"function"===d.ctype)){c=A.compileToWebGL$1([d.args[0]],{});e=A.compileToWebGL$1([d.args[1]],{});if("+"===d.oper||"add"===d.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:e.value}:{ctype:"string",value:"addc("+c.value+","+e.value+")"};if("*"===d.oper||"mult"===d.oper)return{ctype:"string",value:"multc("+c.value+","+e.value+")"};if("/"===d.oper||"div"===d.oper)return{ctype:"string",value:"divc("+c.value+
","+e.value+")"};if("-"===d.oper||"sub"===d.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:"negc("+e.value+")"}:{ctype:"string",value:"subc("+c.value+","+e.value+")"};if("^"===d.oper||"pow"===d.oper)return{ctype:"string",value:"powc("+c.value+","+e.value+")"}}if("function"===d.ctype&&1===d.args.length){c=A.compileToWebGL$1([d.args[0]],{});if("sin"===d.oper)return{ctype:"string",value:"sinc("+c.value+")"};if("cos"===d.oper)return{ctype:"string",value:"cosc("+c.value+")"};if("tan"===
d.oper)return{ctype:"string",value:"tanc("+c.value+")"};if("exp"===d.oper)return{ctype:"string",value:"expc("+c.value+")"};if("log"===d.oper)return{ctype:"string",value:"logc("+c.value+")"};if("arctan"===d.oper)return{ctype:"string",value:"arctanc("+c.value+")"};if("arcsin"===d.oper)return{ctype:"string",value:"arcsinc("+c.value+")"};if("arccos"===d.oper)return{ctype:"string",value:"arccosc("+c.value+")"};if("sqrt"===d.oper)return{ctype:"string",value:"sqrtc("+c.value+")"}}return y};A.compileToWebGL$1=
function(a,c){var b,d;b=R.formatForWebGL;var e=a[0];d=R.plotvars(e);-1===d.indexOf("a")&&-1===d.indexOf("b")&&-1===d.indexOf("c")&&-1===d.indexOf("d")&&-1===d.indexOf("e")&&-1===d.indexOf("f")&&(e=N(e));if("number"===e.ctype)return{ctype:"string",value:"vec2("+b(e.value.real)+","+b(e.value.imag)+")"};if("variable"===e.ctype)return{ctype:"string",value:e.name};if("string"===e.ctype||"void"===e.ctype)return e;if(2===e.args.length&&("infix"===e.ctype||"function"===e.ctype)){b=A.compileToWebGL$1([e.args[0]],
{});d=A.compileToWebGL$1([e.args[1]],{});if("+"===e.oper||"add"===e.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:d.value}:{ctype:"string",value:"addc("+b.value+","+d.value+")"};if("*"===e.oper||"mult"===e.oper)return{ctype:"string",value:"multc("+b.value+","+d.value+")"};if("/"===e.oper||"div"===e.oper)return{ctype:"string",value:"divc("+b.value+","+d.value+")"};if("-"===e.oper||"sub"===e.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:"negc("+d.value+
")"}:{ctype:"string",value:"subc("+b.value+","+d.value+")"};if("^"===e.oper||"pow"===e.oper)return{ctype:"string",value:"powc("+b.value+","+d.value+")"}}if("function"===e.ctype&&1===e.args.length){b=A.compileToWebGL$1([e.args[0]],{});if("sin"===e.oper)return{ctype:"string",value:"sinc("+b.value+")"};if("cos"===e.oper)return{ctype:"string",value:"cosc("+b.value+")"};if("tan"===e.oper)return{ctype:"string",value:"tanc("+b.value+")"};if("exp"===e.oper)return{ctype:"string",value:"expc("+b.value+")"};
if("log"===e.oper)return{ctype:"string",value:"logc("+b.value+")"};if("arctan"===e.oper)return{ctype:"string",value:"arctanc("+b.value+")"};if("arcsin"===e.oper)return{ctype:"string",value:"arcsinc("+b.value+")"};if("arccos"===e.oper)return{ctype:"string",value:"arccosc("+b.value+")"};if("sqrt"===e.oper)return{ctype:"string",value:"sqrtc("+b.value+")"}}return y};A.setsimulationspeed$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&"undefined"!==typeof ba&&"undefined"!==typeof ba.env&&(ba.env.deltat=
c.value.real);return y};A.setsimulationaccuracy$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&"undefined"!==typeof ba&&"undefined"!==typeof ba.env&&(ba.env.accuracy=c.value.real);return y};A.setsimulationquality$1=function(a,b){var c=N(a[0]);"number"===c.ctype&&"undefined"!==typeof ba&&"undefined"!==typeof ba.env&&(c=c.value.real,0===c&&(ba.env.errorbound=.01,ba.env.lowestdeltat=1E-5,ba.env.slowdownfactor=2),1===c&&(ba.env.errorbound=.001,ba.env.lowestdeltat=1E-7,ba.env.slowdownfactor=2),2===
c&&(ba.env.errorbound=1E-5,ba.env.lowestdeltat=1E-10,ba.env.slowdownfactor=4),3===c&&(ba.env.errorbound=1E-6,ba.env.lowestdeltat=1E-12,ba.env.slowdownfactor=4));return y};R.extractPoint=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=Ha.getField(c,"x").value.real,b.y=Ha.getField(c,"y").value.real,b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a.value.real,b.y=c.value.real,
b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(a=p.div(a,d),c=p.div(c,d),b.x=a.value.real,b.y=c.value.real,b.ok=!0));return b};A.draw$1=function(a,b){var c=N(a[0]);if("shape"===c.ctype)R.drawshape(c,b);else if("Line"===c.usage)K.handleModifs(b,K.lineModifs),K.drawline(c);else{var d=R.extractPoint(c);if(!d.ok){if("undefined"!==typeof c.value&&2===c.value.length)return A.draw$2(c.value,b);return}null!==b&&K.handleModifs(b,K.pointModifs);K.drawpoint(d)}return y};
A.draw$2=function(a,b){var c=N(a[0]),d=N(a[1]),c=R.extractPoint(c),d=R.extractPoint(d);if(!c.ok||!d.ok)return y;null!==b&&K.handleModifs(b,K.lineModifs);K.drawsegcore(c,d);return y};A.drawcircle$2=function(a,b){return R.drawcircle(a,b,"D")};A.fillcircle$2=function(a,b){return R.drawcircle(a,b,"F")};R.drawcircle=function(a,b,c){var d=N(a[0]);a=N(a[1]);var e=R.extractPoint(d);if(!e.ok||"number"!==a.ctype)return y;var d=B.drawingstate.matrix,f=e.x*d.a-e.y*d.b+d.tx,e=e.x*d.c-e.y*d.d-d.ty;K.handleModifs(b,
K.conicModifs);b=4;null!==K.size&&(b=K.size);M.lineWidth=.4*b;M.beginPath();M.arc(f,e,a.value.real*d.sdet,0,2*Math.PI);"D"===c&&(M.strokeStyle=K.lineColor,M.stroke());"F"===c&&(M.fillStyle=K.lineColor,M.fill());"C"===c&&M.clip();return y};A.drawconic$1=function(a,b){var c={usage:"conic"},d=N(a[0]);if("list"!==d.ctype||3!==d.value.length&&6!==d.value.length)return console.error("could not parse conic"),y;if(6===d.value.length){for(var e=0;6>e;e++)if("number"!==d.value[e].ctype)return console.error("could not parse conic"),
y;var f=p.real(.5),e=d.value[0],g=d.value[2],g=p.mult(g,f),k=d.value[1],l=d.value[3],l=p.mult(l,f),m=d.value[4],m=p.mult(m,f),d=d.value[5],d=n.turnIntoCSList([n.turnIntoCSList([e,g,l]),n.turnIntoCSList([g,k,m]),n.turnIntoCSList([l,m,d])])}else{for(e=0;3>e;e++)for(g=0;3>g;g++)if("number"!==d.value[e].value[g].ctype)return console.error("could not parse conic"),y;n.equals(d,n.transpose(d)).value||(e=J.mult(d,p.real(.5)),d=J.mult(n.transpose(d),p.real(.5)),d=n.add(e,d))}c.matrix=d;return R.drawconic(c,
b)};R.drawconic=function(a,b){K.handleModifs(b,K.conicModifs);var c=4;null!==K.size&&(c=K.size);M.lineWidth=.4*c;for(var d=a.matrix,e=a.matrix,f=0;2>f;f++)for(var g=0;2>g;g++)if(1E-16<Math.abs(d.value[f].value[g].value.imag))return;f=n.turnIntoCSList([n.realVector([-1,-1,1]),n.realVector([1,0,0]),n.realVector([0,1,0])]);g=B.from(0,0,1);g[2]=1;var k=B.from(1,0,1);k[2]=1;var l=B.from(0,1,1);l[2]=1;var g=n.turnIntoCSList([n.realVector(g),n.realVector(k),n.realVector(l)]),g=n.transpose(g),f=J.mult(g,
f),f=n.inverse(f),d=J.mult(n.transpose(f),d),d=J.mult(d,f),f=d.value[0].value[0].value.real,g=d.value[1].value[0].value.real,k=d.value[1].value[1].value.real,l=d.value[2].value[0].value.real,m=d.value[2].value[1].value.real,p=d.value[2].value[2].value.real,d=[[f,g,l],[g,k,m],[l,m,p]],q=1E-16>Math.abs(f*k*p-f*m*m-g*g*p+2*g*l*m-k*l*l),t=Aa>ua?Aa:ua,u=-1.5*t,v=1.5*t,w=-1.5*t,x=1.5*t,z=1;q&&(z=0);if(z)var l=0,l=1E-16<Math.abs(f-g)?Math.atan(g/f-k)/2:Math.PI/4,C=function(a){var b=Math.cos(a);a=Math.sin(a);
return[[b,-a,0],[a,b,0],[0,0,1]]}(l),f=numeric.transpose(C),d=numeric.dot(d,C),d=numeric.dot(f,d),f=d[0][0],g=d[1][0],k=d[1][1],l=d[2][0],m=d[2][1],p=d[2][2];var d=[f,g,k,l,m,p],f=function(){var a=F._helper.splitDegenConic(e);if(a!==y){var c=a[1],a=[a[0]];A.draw$1(a,b);a[0]=c;A.draw$1(a,b)}},D=function(a){"undefined"!==a&&6===a.length||console.error("this does not define a Conic");if(q)return"degenerate";a=a[0]*a[2]-a[1]*a[1];return 1E-16>Math.abs(a)?"parabola":1E-16<a?"ellipsoid":"hyperbola"};D(d);
var E=function(a,b){return 0<a&&a<Aa&&0<b&&b<ua},G=[],H=[],I=[],L=[],N=[],O=[],P=function(){G=[];H=[];I=[];L=[];N=[];O=[]},Q=function(a,b){M.strokeStyle=K.lineColor;M.lineWidth=c;M.beginPath();M.moveTo(a[0],b[0]);for(var h=1;h<a.length;h++)M.lineTo(a[h],b[h]);M.stroke()},R=function(a,b,c){var h,d,e=D(a);if(6!==a.length)console.error("Conic needs 6 Parameters");else{var f=a[0],g=a[1],k=a[2],r=a[3],l=a[4];a=a[5];var n;h=c-b;for(var m=.05*h+b,p=c-.05*h,ka=b;ka<=c;ka+=n){n=ka<m||ka>p||100>Math.abs(c-
b)?.5:0>ka||ka>ua?10:3;d=-f*k*Math.pow(ka,2)-2*f*l*ka-f*a+Math.pow(g,2)*Math.pow(ka,2)+2*g*r*ka+Math.pow(r,2);d=Math.sqrt(d);h=1/f*(-g*ka-r+d);d=-1/f*(g*ka+r+d);var q,ia;z?(q=[h,ka,1],ia=[d,ka,1],q=numeric.dot(C,q),ia=numeric.dot(C,ia),h=q[0],d=ia[0],q=q[1],ia=ia[1]):ia=q=ka;isNaN(h)||"ellipsoid"!==e?!isNaN(h)&&h>=u&&h<=v&&(G.push(h),I.push(q)):(G.push(h),I.push(q));isNaN(d)||"ellipsoid"!==e?!isNaN(d)&&d>=u&&d<=v&&(H.push(d),L.push(ia)):(H.push(d),L.push(ia))}}},g=function(a){var b,c,h;D(a);if(6!==
a.length)console.error("Conic needs 6 Parameters");else{c=a[0];h=a[1];var d=a[2],e=a[3],f=a[4],g=a[5];b=-c*f+h*e;e=Math.sqrt(c*(-c*d*g+c*Math.pow(f,2)+Math.pow(h,2)*g-2*h*e*f+d*Math.pow(e,2)));h=c*d-Math.pow(h,2);c=(b-e)/h;h=(b+e)/h;!isNaN(c)&&c>w&&c<x||(c=w);!isNaN(h)&&h>w&&h<x||(h=w);b=c<h?c:h;c=c>h?c:h;R(a,w,b);N=G.concat(H.reverse());O=I.concat(L.reverse());Q(N,O);P();R(a,c,x);Q(G,I);if(E(G[0],I[1])||E(H[0],L[0]))M.beginPath(),M.moveTo(G[0],I[0]),M.lineTo(H[0],L[0]),M.stroke();Q(H,L);P();R(a,
b,c);Q(G,I);M.beginPath();M.moveTo(G[0],I[0]);M.lineTo(H[0],L[0]);M.stroke();M.beginPath();M.moveTo(G[G.length-1],I[I.length-1]);M.lineTo(H[H.length-1],L[L.length-1]);M.stroke();Q(H,L);P()}};q?f():g(d)};A.drawall$1=function(a,b){var c=I(a[0]);if("list"===c.ctype){K.handleModifs(b,K.pointAndLineModifs);for(var d=0;d<c.value.length;d++)A.draw$1([c.value[d]],null)}return y};A.connect$1=function(a,c){return R.drawpolygon(a,c,"D",!1)};A.drawpoly$1=function(a,c){return R.drawpolygon(a,c,"D",!0)};A.fillpoly$1=
function(a,c){return R.drawpolygon(a,c,"F",!0)};A.drawpolygon$1=function(a,c){return R.drawpolygon(a,c,"D",!0)};A.fillpolygon$1=function(a,c){return R.drawpolygon(a,c,"F",!0)};R.drawpolygon=function(a,c,b,d){function e(){for(var a=k.value,c=0;c<a.length;c++){var b=a[c],h;for(h=0;h<b.length;h++){var d=b[h],f=d.X*g.a-d.Y*g.b+g.tx,d=d.X*g.c-d.Y*g.d-g.ty;0===h?M.moveTo(f,d):M.lineTo(f,d)}M.closePath()}}function f(){var a;for(a=0;a<k.value.length;a++){var c=R.extractPoint(k.value[a]);if(!c.ok)return;var b=
c.x*g.a-c.y*g.b+g.tx,c=c.x*g.c-c.y*g.d-g.ty;0===a?M.moveTo(b,c):M.lineTo(b,c)}d&&M.closePath()}K.handleModifs(c,K.conicModifs);c=4;null!==K.size&&(c=K.size);M.lineWidth=.4*c;M.mozFillRule="evenodd";M.lineJoin="round";var g=B.drawingstate.matrix,k=I(a[0]);M.beginPath();"list"===k.ctype&&f();"shape"===k.ctype&&e();"D"===b&&(M.strokeStyle=K.lineColor,M.stroke());"F"===b&&(M.fillStyle=K.lineColor,M.fill());"C"===b&&M.clip();return y};A.drawtext$2=function(a,c){var b=N(a[0]),d=I(a[1]),e=R.extractPoint(b);
if(!e.ok)return y;var f=B.drawingstate.matrix,b=e.x*f.a-e.y*f.b+f.tx,e=e.x*f.c-e.y*f.d-f.ty;K.handleModifs(c,K.textModifs);f=B.drawingstate.textsize;null!==K.size&&(f=K.size);M.fillStyle=K.textColor;M.font=K.bold+K.italics+Math.round(10*f)/10+"px "+K.family;d=z(d);f=M.measureText(d).width;M.fillText(d,b-f*K.align+K.xOffset,e-K.yOffset);return y};R.drawshape=function(a,c){return"polygon"===a.type?R.drawpolygon([a],c,"D",1):"circle"===a.type?R.drawcircle([a.value.value[0],a.value.value[1]],c,"D"):y};
R.fillshape=function(a,c){return"polygon"===a.type?R.drawpolygon([a],c,"F",1):"circle"===a.type?R.drawcircle([a.value.value[0],a.value.value[1]],c,"F"):y};R.clipshape=function(a,c){return"polygon"===a.type?R.drawpolygon([a],c,"C",1):"circle"===a.type?R.drawcircle([a.value.value[0],a.value.value[1]],c,"C"):y};A.fill$1=function(a,c){var b=I(a[0]);return"shape"===b.ctype?R.fillshape(b,c):y};A.clip$1=function(a,c){var b=I(a[0]);return"shape"===b.ctype?R.clipshape(b,c):"list"===b.ctype?(b=A.polygon$1(a,
[]),A.clip$1([b],[])):y};A.plot$1=function(a,c){return A.plot$2([a[0],null],c)};A.plot$2=function(a,c){function b(a){return"number"===a.ctype&&p._helper.isAlmostReal(a)}function d(a,c,b,h,e){k++;c=+c.value.real;e=+h.value.real;h=c*z.a-e*z.b+z.tx;c=c*z.c-e*z.d-z.ty;a=+a.value.real;e=+b.value.real;b=a*z.a-e*z.b+z.tx;a=a*z.c-e*z.d-z.ty;l?(M.lineTo(b,a),M.lineTo(h,c)):(M.beginPath(),M.moveTo(b,a),M.lineTo(h,c),l=!0)}function e(a,c,h,k,n){var m=b(h),q=b(k);if(.001>n)!f&&l&&(M.stroke(),l=!1);else if(m||
q){var ka=p.real((a.value.real+c.value.real)/2);ca.setvar(w,ka);var t=I(v),u=b(t);if(m&&q&&u){var x=h.value.real,q=t.value.real,u=k.value.real;if(m=1>Math.abs(x+u-2*q)/g){var y=p.real((a.value.real+ka.value.real)/2);ca.setvar(w,y);var y=I(v),z=p.real((ka.value.real+c.value.real)/2);ca.setvar(w,z);z=I(v).value.real;x=Math.abs(x+q-2*y.value.real)/g;q=Math.abs(q+u-2*z)/g;m=m&&1>x&&1>q}m?(d(a,ka,h,t,n/2),d(ka,c,t,k,n/2)):(e(a,ka,h,t,n/2),e(ka,c,t,k,n/2))}else e(a,ka,h,t,n/2),e(ka,c,t,k,n/2)}}var f=!1,
g=.2/ib,k=0,l=!1,m=-10,q=10,t=1,u=1E3,v=a[0],w;if(null!==a[1]&&"variable"===a[1].ctype)w=a[1].name;else{var x=R.plotvars(v);w="#";-1!==x.indexOf("t")&&(w="t");-1!==x.indexOf("z")&&(w="z");-1!==x.indexOf("y")&&(w="y");-1!==x.indexOf("x")&&(w="x")}ca.newvar(w);var z=B.drawingstate.matrix;K.handleModifs(c,{color:!0,alpha:!0,size:!0,dashpattern:!0,dashtype:!0,dashing:!0,connect:function(a){"boolean"===a.ctype&&(f=a.value)},start:function(a){"number"===a.ctype&&(m=a.value.real)},stop:function(a){"number"===
a.ctype&&(q=a.value.real)},steps:function(a){"number"===a.ctype&&(u=a.value.real)}});M.strokeStyle=K.lineColor;M.lineWidth=K.lsize;M.lineCap="round";M.lineJoin="round";var A,C,D,E,l=!1,x=p.real(14.32);ca.setvar(w,x);D=I(v);if("number"!==D.ctype){if(n.isNumberVector(D).value&&2===D.value.length){l=!1;t=(q-m)/u;for(x=m;x<q;x+=t)ca.setvar(w,p.real(x)),E=I(v),n.isNumberVector(E).value&&2===E.value.length&&(A=+E.value[0].value.real,C=+E.value[1].value.real,E=A*z.a-C*z.b+z.tx,A=A*z.c-C*z.d-z.ty,l?M.lineTo(E,
A):(M.beginPath(),M.moveTo(E,A),l=!0));M.stroke();ca.removevar(w)}return y}for(E=m;E<q+t;E+=t)x=p.real(E),ca.setvar(w,x),D=I(v),x.value.real>m&&e(A,x,C,D,t),A=x,C=D;ca.removevar(w);l&&M.stroke();return y};A.plotX$1=function(a,c){var b=a[0],d=R.plotvars(b),e="#";-1!==d.indexOf("t")&&(e="t");-1!==d.indexOf("z")&&(e="z");-1!==d.indexOf("y")&&(e="y");-1!==d.indexOf("x")&&(e="x");ca.newvar(e);d=B.drawingstate.matrix;M.fillStyle=B.drawingstate.linecolor;M.lineWidth=1;M.lineCap="round";for(var f=!1,g=-10;10>
g;g+=.01){ca.setvar(e,p.real(g));var k=I(b);if("number"===k.ctype){var l=+k.value.real,k=g*d.a-l*d.b+d.tx,l=g*d.c-l*d.d-d.ty;f?M.lineTo(k,l):(M.beginPath(),M.moveTo(k,l),f=!0)}}M.stroke();ca.removevar(e);return y};R.plotvars=function(a){function c(a,b){var h={},d;for(d=a.length-1;0<=d;--d)h[a[d]]=a[d];for(d=b.length-1;0<=d;--d)h[b[d]]=b[d];d=[];for(var e in h)h.hasOwnProperty(e)&&d.push(h[e]);return d}function b(a,c){for(var h=0;h<a.length;h++)a[h]===c&&(a.splice(h,1),h--);return a}var d,e,f,g;if("variable"===
a.ctype)return[a.name];if("infix"===a.ctype)return d=R.plotvars(a.args[0]),a=R.plotvars(a.args[1]),c(d,a);if("list"===a.ctype){f=a.value;e=[];for(g=0;g<f.length;g++)d=R.plotvars(f[g]),e=c(e,d);return e}if("function"===a.ctype){f=a.args;e=[];for(g=0;g<f.length;g++)d=R.plotvars(f[g]),e=c(e,d);"apply"!==a.oper&&"select"!==a.oper&&"forall"!==a.oper&&"sum"!==a.oper&&"product"!==a.oper&&"repeat"!==a.oper&&"min"!==a.oper&&"max"!==a.oper&&"sort"!==a.oper||"variable"!==a.args[1].ctype||(e=b(e,a.args[1].name));
return e}return[]};A.clrscr$0=function(a,c){"undefined"!==typeof Aa&&"undefined"!==typeof ua&&M.clearRect(0,0,Aa,ua);return y};A.repaint$0=function(a,c){E();return y};A.screenbounds$0=function(a,c){var b=J.withUsage(n.realVector(B.to(0,0)),"Point"),d=J.withUsage(n.realVector(B.to(Aa,0)),"Point"),e=J.withUsage(n.realVector(B.to(Aa,ua)),"Point"),f=J.withUsage(n.realVector(B.to(0,ua)),"Point");return n.turnIntoCSList([b,d,e,f])};A.createimage$3=function(a,c){var b=I(a[0]),d=N(a[1]),e=N(a[2]);if("number"!==
d.ctype||"number"!==e.ctype||"string"!==b.ctype)return y;var f=document.createElement("canvas");f.id=b.value;f.width=d.value.real;f.height=e.value.real;f.style.display="none";document.body.appendChild(f);za[b.value]=f;return y};A.clearimage$1=function(a,c){var b=I(a[0]);if("string"!==b.ctype)return y;b=document.getElementById(b.value);if("undefined"===typeof b||null===b)return y;var d=b.width,e=b.height;b.getContext("2d").clearRect(0,0,d,e);return y};A.canvas$4=function(a,c){var b=N(a[0]),d=N(a[1]),
e=I(a[2]),f=a[3],g=R.extractPoint(b),k=R.extractPoint(d);if(!g.ok||!k.ok||"string"!==e.ctype)return y;e=document.getElementById(e.value);if("undefined"===typeof e||null===e)return y;var b=e.width,d=e.height,l=k.x-g.x,n=k.y-g.y,m=g.x-n*d/b,p=g.y+l*d/b,n=k.x-n*d/b,l=k.y+l*d/b,k=B.from(g.x,g.y,1),m=B.from(m,p,1),n=B.from(n,l,1),g=k[0],p=k[1],l=m[0],q=m[1],t=n[0],u=n[1],m=b*(p-q)/((g-l)*(p-u)-(g-t)*(p-q)),b=b*(g-l)/((p-q)*(g-t)-(p-u)*(g-l)),n=-m*g-b*p,k=(d*(p-u)-d*(p-q))/((g-l)*(p-u)-(g-t)*(p-q)),l=(d*
(g-t)-d*(g-l))/((p-q)*(g-t)-(p-u)*(g-l)),d=d-k*g-l*p,e=e.getContext("2d"),g=M;M=e;M.save();M.transform(m,k,b,l,n,d);I(f);M.restore();M=g};A.canvas$5=function(a,c){var b=N(a[0]),d=N(a[1]),e=N(a[2]),f=I(a[3]),g=a[4],b=R.extractPoint(b),d=R.extractPoint(d),k=R.extractPoint(e);if(!b.ok||!d.ok||!k.ok||"string"!==f.ctype)return y;f=document.getElementById(f.value);if("undefined"===typeof f||null===f)return y;var l=f.width,e=f.height,n=B.from(b.x,b.y,1),m=B.from(d.x,d.y,1),d=B.from(k.x,k.y,1),b=n[0],k=n[1],
p=m[0],q=m[1],t=d[0],u=d[1],d=((0-l)*(k-u)-0*(k-q))/((b-p)*(k-u)-(b-t)*(k-q)),l=((0-l)*(b-t)-0*(b-p))/((k-q)*(b-t)-(k-u)*(b-p)),m=0-d*b-l*k,n=((e-e)*(k-u)-(e-0)*(k-q))/((b-p)*(k-u)-(b-t)*(k-q)),p=((e-e)*(b-t)-(e-0)*(b-p))/((k-q)*(b-t)-(k-u)*(b-p)),e=e-n*b-p*k,f=f.getContext("2d"),b=M;M=f;M.save();M.transform(d,n,l,p,m,e);I(g);M.restore();M=b};R.extractReferenceX=function(a,b){};A.imagesize$1=function(a,b){var c=N(a[0]);return"string"===c.ctype&&za[c.value]?n.realVector([za[c.value].width,za[c.value].height]):
y};A.drawimage$2=function(a,b){function c(){var a=1,h=1,d=1,f=1,g=0,l=1,r=R.extractPoint(e);if(!r.ok||"string"!==k.ctype)return y;M.save();var m;void 0!==b.angle&&(m=I(b.angle),"number"===m.ctype&&(g=m.value.real));void 0!==b.rotation&&(m=I(b.rotation),"number"===m.ctype&&(g=m.value.real));void 0!==b.scale&&(m=N(b.scale),"number"===m.ctype&&(h=a=m.value.real),n.isNumberVector(m).value&&2===m.value.length&&(a=m.value[0].value.real,h=m.value[1].value.real));void 0!==b.scalex&&(m=I(b.scalex),"number"===
m.ctype&&(a=m.value.real));void 0!==b.scaley&&(m=I(b.scaley),"number"===m.ctype&&(h=m.value.real));void 0!==b.flipx&&(m=I(b.flipx),"boolean"===m.ctype&&m.value&&(d=-1));void 0!==b.flipy&&(m=I(b.flipy),"boolean"===m.ctype&&m.value&&(f=-1));void 0!==b.alpha&&(m=I(b.alpha),"number"===m.ctype&&(l=m.value.real));var p=B.drawingstate.matrix,q=B.drawingstate.initialmatrix;m=za[k.value].width;var t=za[k.value].height,u=r.x*p.a-r.y*p.b+p.tx,ia=r.x*p.c-r.y*p.d-p.ty,v=(r.x+1)*p.a-r.y*p.b+p.tx-u,p=(r.x+1)*p.c-
r.y*p.d-p.ty-ia,w=(r.x+1)*q.a-r.y*q.b+q.tx-(r.x*q.a-r.y*q.b+q.tx),q=(r.x+1)*q.c-r.y*q.d-q.ty-(r.x*q.c-r.y*q.d-q.ty),r=Math.sqrt(v*v+p*p)/Math.sqrt(w*w+q*q),v=-Math.atan2(v,p)+Math.atan2(w,q);1!==l&&(M.globalAlpha=l);M.translate(u,ia);M.scale(a*d*r,h*f*r);M.rotate(g+v);M.translate(-u,-ia);M.translate(-m/2,-t/2);M.drawImage(za[k.value],u,ia);M.globalAlpha=1;M.restore()}function d(){var a=1,c=1,h=1,l=1,r=R.extractPoint(e),n=R.extractPoint(f),m;if(!r.ok||!n.ok||"string"!==k.ctype)return y;if(void 0!==
za&&"undefined"!==za[k.value]){var p=za[k.value].width,q=za[k.value].height;if(0===g)m={},m.x=r.x-(n.y-r.y),m.y=r.y+(n.x-r.x),l=q/p;else if(m=R.extractPoint(g),!r.ok)return y;M.save();var t;void 0!==b.alpha&&(t=I(b.alpha),"number"===t.ctype&&(a=t.value.real));void 0!==b.aspect&&(t=I(b.aspect),"number"===t.ctype&&(l=t.value.real));void 0!==b.flipx&&(t=I(b.flipx),"boolean"===t.ctype&&t.value&&(c=-1));void 0!==b.flipy&&(t=I(b.flipy),"boolean"===t.ctype&&t.value&&(h=-1));t=B.drawingstate.matrix;1!==a&&
(M.globalAlpha=a);a=r.x*t.a-r.y*t.b+t.tx;r=r.x*t.c-r.y*t.d-t.ty;M.transform(n.x*t.a-n.y*t.b+t.tx-a,n.x*t.c-n.y*t.d-t.ty-r,m.x*t.a-m.y*t.b+t.tx-a,m.x*t.c-m.y*t.d-t.ty-r,a,r);M.scale(1/p,-1/q*l);M.translate(p/2,-q/2);M.scale(c,h);M.translate(-p/2,q/2);M.translate(0,-q);M.drawImage(za[k.value],0,0);M.globalAlpha=1;M.restore()}}var e,f,g,k;return 2===a.length?(e=N(a[0]),k=N(a[1]),c()):3===a.length?(e=N(a[0]),f=N(a[1]),g=0,k=N(a[2]),d()):4===a.length?(e=N(a[0]),f=N(a[1]),g=N(a[2]),k=N(a[3]),d()):y};A.drawimage$3=
A.drawimage$2;A.drawimage$4=A.drawimage$2;var Gb;Gb=[0,0,0,0,0,0,0,0,0,0,0,0];A.playsin$1=function(a,b){var c=N(a[0]),d=0;if("number"===c.ctype){var e;void 0!==b.line&&(e=I(b.line),"number"===e.ctype&&(d=Math.floor(e.value.real),0>d&&(d=0),10<d&&(d=10)));c=c.value.real;0!==Gb[d]&&Gb[d].set({freq:c})}return y};var da={printArr:function(a){for(var b=a.value.length,c=[],d=[],e=!1,f=0;f<b;f++)c[f]=a.value[f].value.real,d[f]=a.value[f].value.imag,0!==d[f]&&(e=!0);console.log(c);e&&console.log(d)},zero:function(a){for(var b=
[],c=p.real(0),d=0;d<a.value.real;d++)b[d]=c;return n.turnIntoCSList(b)},number:function(a,b){var c=da.zero(b);c.value[0]=a;return c},variable:function(a,b){var c=da.zero(b);c.value[0]=a;c.value[1]=p.real(1);return c},add:function(a,b){return n.add(a,b)},sub:function(a,b){return n.sub(a,b)},mult:function(a,b){if(a.value.length!==b.value.length)return console.error("dims don't fit return nada"),y;for(var c=a.value.length,d=da.zero(p.real(c)),e=p.real(0),f=0;f<c;f++){for(var g=0;g<=f;g++)e=p.add(e,
p.mult(a.value[g],b.value[f-g]));d.value[f]=e;e=p.real(0)}return d},pow:function(a,b){if(0>b.value.real||b.value.real!==Math.floor(b.value.real))return da.root(a,b);for(var c=a,d=1;d<b.value.real;d++)c=da.mult(c,a);return c},root:function(a,b){var c=p.real(0),d=p.real(1),e=p.add(d,b),f=a.value.length,g=da.zero(p.real(f));g.value[0]=p.pow(a.value[0],b);for(var k=c,l,n,m=1;m<f;m++){n=p.real(m);for(var q=1;q<=m;q++)l=p.mult(e,p.real(q)),l=p.div(l,n),l=p.sub(l,d),l=p.mult(l,a.value[q]),l=p.mult(l,g.value[m-
q]),k=p.add(k,l);k=p.div(k,a.value[0]);g.value[m]=k;k=c}return g},findFirstNoneZero:function(a,b,c){for(var d=Infinity,e=Infinity,f=c;f<a.value.length;f++)if(1E-12<p.abs2(a.value[f]).value.real){d=f;break}for(a=c;a<b.value.length;a++)if(1E-12<p.abs2(b.value[a]).value.real){e=a;break}return[d,e]},div:function(a,b){if(a.value.length!==b.value.length)return console.log("dims don't fit - return nada"),y;for(var c=a.value.length,d=p.real(0),e=da.zero(p.real(c)),f=d,g=d,k=0;k<c;k++){g=da.findFirstNoneZero(a,
b,k);k<g[0]&&g[0]===g[1]&&Infinity!==g[0]&&(a.value.splice(k,g[0]),b.value.splice(k,g[0]),e.value.splice(k,g[0]),c-=g[0]);for(var g=a.value[k],l=0;l<k;l++)f=p.add(f,p.mult(e.value[l],b.value[k-l]));g=p.sub(g,f);g=p.div(g,b.value[0]);e.value[k]=g;f=d}return e},exp:function(a){var b=p.real(0),c=a.value.length,d=da.zero(p.real(c)),e=b,f;d.value[0]=p.exp(a.value[0]);for(var g=1;g<c;g++){for(var k=1;k<=g;k++)f=p.mult(p.real(k),a.value[k]),f=p.mult(f,d.value[g-k]),e=p.add(e,f);d.value[g]=p.div(e,p.real(g));
e=b}return d},log:function(a){var b=p.real(0),c=a.value.length,d=da.zero(p.real(c));d.value[0]=p.log(a.value[0]);for(var e=b,f,g,k=1;k<c;k++){f=a.value[k];for(var l=1;l<k;l++)g=p.mult(p.real(l),d.value[l]),g=p.mult(g,a.value[k-l]),e=p.add(e,g);e=p.div(e,p.real(k));f=p.sub(f,e);f=p.div(f,a.value[0]);d.value[k]=f;e=b}return d},sincos:function(a){var b=p.real(0),c=a.value.length,d=da.zero(p.real(c)),e=da.zero(p.real(c));d.value[0]=p.sin(a.value[0]);e.value[0]=p.cos(a.value[0]);for(var f=b,g=b,k,l,n,
m=1;m<c;m++){n=p.real(m);for(var q=1;q<=m;q++)l=p.mult(p.real(q),a.value[q]),k=p.mult(l,e.value[m-q]),l=p.mult(l,d.value[m-q]),g=p.add(g,k),f=p.add(f,l);g=p.div(g,n);f=p.div(f,p.neg(n));d.value[m]=g;e.value[m]=f;f=g=b}da.sinsave=d;da.cossave=e;return[d,e]},sin:function(a){return da.sincos(a)[0]},cos:function(a){return da.sincos(a)[1]},faculty:function(a){var b=[];b[0]=p.real(1);for(var c=1,d=1;d<=a.value.real;d++)c*=d,b[d]=p.real(c);return b=n.turnIntoCSList(b)},diff:function(a,b,c,d){var e;if("variable"===
a.ctype)e=a.name!==b?da.number(I(a),d):da.variable(c,d);else if("number"===a.ctype)e=da.number(a,d);else{if("infix"===a.ctype){if("*"===a.oper)return da.mult(da.diff(a.args[0],b,c,d),da.diff(a.args[1],b,c,d));if("^"===a.oper)return da.pow(da.diff(a.args[0],b,c,d),da.diff(a.args[1],b,c,d).value[0]);if("/"===a.oper)return da.div(da.diff(a.args[0],b,c,d),da.diff(a.args[1],b,c,d));if("+"===a.oper)return da.add(da.diff(a.args[0],b,c,d),da.diff(a.args[1],b,c,d));if("-"===a.oper)return da.sub(da.diff(a.args[0],
b,c,d),da.diff(a.args[1],b,c,d));console.log("infix not found",a.oper);return y}if("function"===a.ctype){if("exp$1"===a.oper)return da.exp(da.diff(a.args[0],b,c,d));if("log$1"===a.oper)return da.log(da.diff(a.args[0],b,c,d));if("sin$1"===a.oper)return da.sin(da.diff(a.args[0],b,c,d));if("cos$1"===a.oper)return da.cos(da.diff(a.args[0],b,c,d))}else return console.log("ctype not found",a.ctype),y}return e},adevaluate:function(a,b,c,d){a=da.diff(a,b,c,d);d=da.faculty(d);for(b=2;b<a.value.length;b++)a.value[b]=
p.mult(a.value[b],d.value[b]);return a},autodiff:function(a,b,c,d){for(var e=[],f=c.value.length,g,k=0;k<f;k++)g=da.adevaluate(a,b,c.value[k],d),e[k]=g;return e=n.turnIntoCSList(e)}},K={handleModifs:function(a,b){K.dashing&&K.unSetDash();K.colorraw=null;K.size=null;0>=K.psize&&(K.psize=0);0>=K.lsize&&(K.lsize=0);K.overhang=1;K.dashing=!1;K.isArrow=!1;K.arrowSides="==>";K.arrowposition=1;K.headlen=10;K.arrowShape="default";K.alpha=B.drawingstate.alpha;K.bold="";K.italics="";K.family="Arial";K.align=
0;K.xOffset=0;K.yOffset=0;var c,d;for(c in a)(d=b[c])?(!0===d&&(d=K.modifHandlers[c]),d(I(a[c]))):console.log("Modifier not supported: "+c);null!==K.size?K.psize=K.lsize=K.size:(K.psize=B.drawingstate.pointsize,K.lsize=B.drawingstate.linesize);null!==K.colorraw?K.pointColor=K.lineColor=K.textColor=K.makeColor(K.colorraw):1===K.alpha?(K.pointColor=B.drawingstate.pointcolor,K.lineColor=B.drawingstate.linecolor,K.textColor=B.drawingstate.textcolor):(K.pointColor=K.makeColor(B.drawingstate.pointcolorraw),
K.lineColor=K.makeColor(B.drawingstate.linecolorraw),K.textColor=K.makeColor(B.drawingstate.textcolorraw));K.black=1===K.alpha?"rgb(0,0,0)":"rgba(0,0,0,"+K.alpha+")"},sin30deg:.5};K.cos30deg=Math.sqrt(.75);K.modifHandlers={size:function(a){"number"===a.ctype&&(K.size=a.value.real,0>K.size&&(K.size=0),1E3<K.size&&(K.size=1E3))},color:function(a){n.isNumberVector(a).value&&3===a.value.length&&(K.colorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},alpha:function(a){"number"===
a.ctype&&(K.alpha=a.value.real)},dashpattern:function(a){if("list"===a.ctype){for(var b=[],c=0,d=0;c<a.value.length;c++)"number"===a.value[c].ctype&&(b[d++]=a.value[c].value.real);K.setDash(b,K.lsize);K.dashing=!0}},dashtype:function(a){"number"===a.ctype&&(K.setDashType(Math.floor(a.value.real),K.lsize),K.dashing=!0)},dashing:function(a){"number"===a.ctype&&(a=Math.floor(a.value.real),K.setDash([2*a,a],K.lsize),K.dashing=!0)},overhang:function(a){"number"===a.ctype&&(K.overhang=K.overhang*a.value.real+
(1-K.overhang)*(1-a.value.real))},arrow:function(a){"boolean"===a.ctype?K.isArrow=a.value:console.error("arrow needs to be of type boolean")},arrowshape:function(a){"string"===a.ctype?(K.arrowShape=a.value,K.isArrow=!0):console.error("arrowshape needs to be of type string")},arrowsides:function(a){"string"!==a.ctype?console.error("arrowsides is not of type string"):"==>"!==a.value&&"<==>"!==a.value&&"<=="!==a.value?console.error("arrowsides is unknows"):(K.arrowSides=a.value,K.isArrow=!0)},arrowposition:function(a){"number"!==
a.ctype?console.error("arrowposition is not of type number"):0>a.value.real?console.error("arrowposition has to be positive"):1<a.value.real?K.overhang=K.overhang*a.value.real+(1-K.overhang)*(1-a.value.real):(K.arrowposition=a.value.real,K.isArrow=!0)},arrowsize:function(a){"number"!==a.ctype?console.error("arrowsize is not of type number"):0>a.value.real?console.error("arrowsize has to be positive"):K.headlen*=a.value.real},bold:function(a){"boolean"===a.ctype&&a.value&&(K.bold="bold ")},italics:function(a){"boolean"===
a.ctype&&a.value&&(K.italics="italic ")},family:function(a){"string"===a.ctype&&(K.family=a.value)},align:function(a){"string"===a.ctype&&(a=a.value,"left"===a&&(K.align=0),"right"===a&&(K.align=1),"mid"===a&&(K.align=.5))},x_offset:function(a){"number"===a.ctype&&(K.xOffset=a.value.real)},y_offset:function(a){"number"===a.ctype&&(K.yOffset=a.value.real)},offset:function(a){"list"===a.ctype&&2===a.value.length&&"number"===a.value[0].ctype&&"number"===a.value[1].ctype&&(K.xOffset=a.value[0].value.real,
K.yOffset=a.value[1].value.real)}};K.lineModifs={size:!0,color:!0,alpha:!0,dashpattern:!0,dashtype:!0,dashing:!0,overhang:!0,arrow:!0,arrowshape:!0,arrowsides:!0,arrowposition:!0,arrowsize:!0};K.pointModifs={size:!0,color:!0,alpha:!0};K.pointAndLineModifs=K.lineModifs;K.conicModifs=K.pointModifs;K.textModifs={size:!0,color:!0,alpha:!0,bold:!0,italics:!0,family:!0,align:!0,x_offset:!0,y_offset:!0,offset:!0};K.makeColor=function(a){return"rgba("+Math.floor(255*a[0])+","+Math.floor(255*a[1])+","+Math.floor(255*
a[2])+","+K.alpha+")"};K.drawsegcore=function(a,b){function c(a,b,h){var d=a-h*w,e=b-h*y;M.beginPath();"full"===K.arrowShape&&(M.lineWidth=K.lsize/2);var f=a-h*x;h=b-h*z;M.moveTo(d,e);M.lineTo(a,b);M.lineTo(f,h);"full"===K.arrowShape?(M.fillStyle=K.lineColor,M.closePath(),M.fill()):"default"!==K.arrowShape&&console.error("arrowshape is unknown");M.stroke()}var d=B.drawingstate.matrix,e=a.x*d.a-a.y*d.b+d.tx,f=a.x*d.c-a.y*d.d-d.ty,g=b.x*d.a-b.y*d.b+d.tx,k=b.x*d.c-b.y*d.d-d.ty,l=K.overhang,n=1-l,d=l*
e+n*g,m=l*f+n*k,p=l*g+n*e,l=l*k+n*f;M.lineWidth=K.lsize;M.lineCap="round";M.lineJoin="miter";M.strokeStyle=K.lineColor;if(!K.isArrow||e===f&&g===k).01>K.lsize||(M.beginPath(),M.moveTo(d,m),M.lineTo(p,l),M.stroke());else{var e=g-e,f=k-f,g=Math.sqrt(e*e+f*f),n=e/g,q=f/g,k=K.arrowposition,t=1-k,f=k*d+t*p,e=k*m+t*l,g=k*p+t*d,k=k*l+t*m,t=K.headlen,u=K.sin30deg,v=K.cos30deg,w=t*(n*v+q*u),x=t*(n*v-q*u),y=t*(q*v-n*u),z=t*(q*v+n*u),n=K.arrowSides;M.beginPath();"full"===K.arrowShape?("<==>"===n||"<=="===n?
(q=f+w,t=e+y,u=f+x,v=e+z,1>K.arrowposition&&(M.moveTo(d,m),M.lineTo(f,e)),M.moveTo((q+u)/2,(t+v)/2)):M.moveTo(d,m),"==>"===n||"<==>"===n?(M.lineTo((g-w+(g-x))/2,(k-y+(k-z))/2),1>K.arrowposition&&(M.moveTo(g,k),M.lineTo(p,l))):M.lineTo(p,l)):(M.moveTo(d,m),M.lineTo(p,l));M.stroke();"==>"!==n&&"<==>"!==n||c(g,k,1);"<=="!==n&&"<==>"!==n||c(f,e,-1)}};K.drawpoint=function(a){var b=B.drawingstate.matrix,c=a.x*b.a-a.y*b.b+b.tx;a=a.x*b.c-a.y*b.d-b.ty;M.lineWidth=.3*K.psize;M.beginPath();M.arc(c,a,K.psize,
0,2*Math.PI);M.fillStyle=K.pointColor;M.fill();M.beginPath();M.arc(c,a,1.15*K.psize,0,2*Math.PI);M.fillStyle=K.black;M.strokeStyle=K.black;M.stroke()};K.drawline=function(a){var b=p.abs(a.value[0]).value.real,c=p.abs(a.value[1]).value.real,d=p.abs(a.value[2]).value.real,e;b>=c&&b>=d&&(e=a.value[0]);c>=b&&c>=d&&(e=a.value[1]);d>=c&&d>=b&&(e=a.value[2]);b=p.div(a.value[0],e);c=p.div(a.value[1],e);a=p.div(a.value[2],e);a=[b.value.real,c.value.real,a.value.real];Math.abs(a[0])<Math.abs(a[1])?(b=[1,0,
30],e=[-1,0,30]):(b=[0,1,30],e=[0,-1,30]);b=[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]];a=[a[1]*e[2]-a[2]*e[1],a[2]*e[0]-a[0]*e[2],a[0]*e[1]-a[1]*e[0]];K.drawsegcore({x:b[0]/b[2],y:b[1]/b[2]},{x:a[0]/a[2],y:a[1]/a[2]})};K.setDash=function(a,b){for(var c=Math.sqrt(b),d=0;d<a.length;d++)a[d]*=c;M.webkitLineDash=a;M.setLineDash(a);M.mozDash=a};K.unSetDash=function(){M.webkitLineDash=[];M.setLineDash([]);M.mozDash=[]};K.setDashType=function(a,b){0===a&&K.setDash([]);1===a&&K.setDash([10,
10],b);2===a&&K.setDash([10,4],b);3===a&&K.setDash([1,3],b);4===a&&K.setDash([10,5,1,5],b)};var Oa={},B={drawingstate:{}};B.drawingstate.linecolor="rgb(0,0,255)";B.drawingstate.linecolorraw=[0,0,1];B.drawingstate.pointcolor="rgb(255,200,0)";B.drawingstate.pointcolorraw=[1,.78,0];B.drawingstate.textcolor="rgb(0,0,0)";B.drawingstate.textcolorraw=[0,0,0];B.drawingstate.alpha=1;B.drawingstate.pointsize=4;B.drawingstate.linesize=1;B.drawingstate.textsize=20;B.drawingstate.matrix={};B.drawingstate.matrix.a=
25;B.drawingstate.matrix.b=0;B.drawingstate.matrix.c=0;B.drawingstate.matrix.d=25;B.drawingstate.matrix.tx=250;B.drawingstate.matrix.ty=250;B.drawingstate.matrix.det=B.drawingstate.matrix.a*B.drawingstate.matrix.d-B.drawingstate.matrix.b*B.drawingstate.matrix.c;B.drawingstate.matrix.sdet=Math.sqrt(B.drawingstate.matrix.det);B.drawingstate.initialmatrix={};B.drawingstate.initialmatrix.a=B.drawingstate.matrix.a;B.drawingstate.initialmatrix.b=B.drawingstate.matrix.b;B.drawingstate.initialmatrix.c=B.drawingstate.matrix.c;
B.drawingstate.initialmatrix.d=B.drawingstate.matrix.d;B.drawingstate.initialmatrix.tx=B.drawingstate.matrix.tx;B.drawingstate.initialmatrix.ty=B.drawingstate.matrix.ty;B.drawingstate.initialmatrix.det=B.drawingstate.matrix.det;B.drawingstate.initialmatrix.sdet=B.drawingstate.matrix.sdet;B.clone=function(a){if(null===a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)b[c]=B.clone(a[c]);return b};Oa.backup=B.clone(B.drawingstate);Oa.stack=[];B.clone(B.drawingstate);B.reset=function(){B.drawingstate.matrix.a=
B.drawingstate.initialmatrix.a;B.drawingstate.matrix.b=B.drawingstate.initialmatrix.b;B.drawingstate.matrix.c=B.drawingstate.initialmatrix.c;B.drawingstate.matrix.d=B.drawingstate.initialmatrix.d;B.drawingstate.matrix.tx=B.drawingstate.initialmatrix.tx;B.drawingstate.matrix.ty=B.drawingstate.initialmatrix.ty;B.drawingstate.matrix.det=B.drawingstate.initialmatrix.det;B.drawingstate.matrix.sdet=B.drawingstate.initialmatrix.sdet};B.from=function(a,b,c){a/=c;b/=c;c=B.drawingstate.matrix;return[a*c.a-
b*c.b+c.tx,a*c.c-b*c.d-c.ty]};B.to=function(a,b){var c=B.drawingstate.matrix,d=a-c.tx,e=b+c.ty;return[(d*c.d-e*c.b)/c.det,-(-d*c.c+e*c.a)/c.det,1]};B.dumpTrafo=function(){function a(b){return Math.round(1E3*b)/1E3}var b=B.drawingstate.matrix;console.log("a:"+a(b.a)+" b:"+a(b.b)+" c:"+a(b.c)+" d:"+a(b.d)+" tx:"+a(b.ty)+" ty:"+a(b.tx))};B.setMat=function(a,b,c,d,e,f){var g=B.drawingstate.matrix;g.a=a;g.b=b;g.c=c;g.d=d;g.tx=e;g.ty=f;g.det=a*d-b*c;g.sdet=Math.sqrt(g.det)};B.scaleAndOrigin=function(a,
b,c){B.setMat(a,0,0,a,b,c)};B.visibleRect=function(a,b,c,d){var e=c-a,f=b-d,e=Aa*f<ua*e?Aa/e:ua/f;B.setMat(e,0,0,e,(Aa-e*(a+c))/2,(ua-e*(b+d))/2)};B.applyMat=function(a,b,c,d,e,f){var g=B.drawingstate.matrix;B.setMat(g.a*a+g.c*b,g.b*a+g.d*b,g.a*c+g.c*d,g.b*c+g.d*d,g.a*e+g.c*f+g.tx,g.b*e+g.d*f+g.ty);a=B.to(0,-ua);b=B.to(Aa,0);console.log("{visibleRect: ["+a[0]+","+a[1]+","+b[0]+","+b[1]+"]}")};B.translate=function(a,b){B.applyMat(1,0,0,1,a,b)};B.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);B.applyMat(b,
a,-a,b,0,0)};B.scale=function(a){B.applyMat(a,0,0,a,0,0)};B.gsave=function(){Oa.stack.push(B.clone(B.drawingstate))};B.grestore=function(){0!==Oa.stack.length&&(B.drawingstate=Oa.stack.pop())};B.greset=function(){B.drawingstate=B.clone(Oa.backup);B.drawingstate.matrix.ty-=ua;B.drawingstate.initialmatrix.ty-=ua;Oa.stack=[]};B.createnewbackup=function(){B.drawingstate.initialmatrix.a=B.drawingstate.matrix.a;B.drawingstate.initialmatrix.b=B.drawingstate.matrix.b;B.drawingstate.initialmatrix.c=B.drawingstate.matrix.c;
B.drawingstate.initialmatrix.d=B.drawingstate.matrix.d;B.drawingstate.initialmatrix.tx=B.drawingstate.matrix.tx;B.drawingstate.initialmatrix.ty=B.drawingstate.matrix.ty;B.drawingstate.initialmatrix.det=B.drawingstate.matrix.det;B.drawingstate.initialmatrix.sdet=B.drawingstate.matrix.sdet;Oa.backup=B.clone(B.drawingstate)};B.makecolor=function(a,b,c){a=Math.floor(255*a);b=Math.floor(255*b);c=Math.floor(255*c);return 1===B.drawingstate.alpha?"rgb("+a+","+b+","+c+")":"rgba("+a+","+b+","+c+","+B.drawingstate.alpha+
")"};B.setcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;B.drawingstate.linecolor=B.drawingstate.pointcolor=B.makecolor(b,c,a);B.drawingstate.linecolorraw=B.drawingstate.pointcolorraw=[b,c,a]};B.setlinecolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;B.drawingstate.linecolor=B.makecolor(b,c,a);B.drawingstate.linecolorraw=[b,c,a]};B.settextcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;
a=a.value[2].value.real;B.drawingstate.textcolor=B.makecolor(b,c,a);B.drawingstate.textcolorraw=[b,c,a]};B.setpointcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;B.drawingstate.pointcolor=B.makecolor(b,c,a);B.drawingstate.pointcolorraw=[b,c,a]};B.setalpha=function(a){B.drawingstate.alpha=a.value.real;B.drawingstate.linecolor=B.makecolor(B.drawingstate.linecolorraw[0],B.drawingstate.linecolorraw[1],B.drawingstate.linecolorraw[2]);B.drawingstate.pointcolor=
B.makecolor(B.drawingstate.pointcolorraw[0],B.drawingstate.pointcolorraw[1],B.drawingstate.pointcolorraw[2]);B.drawingstate.textcolor=B.makecolor(B.drawingstate.textcolorraw[0],B.drawingstate.textcolorraw[1],B.drawingstate.textcolorraw[2])};B.setpointsize=function(a){B.drawingstate.pointsize=a.value.real};B.setlinesize=function(a){B.drawingstate.linesize=a.value.real};B.settextsize=function(a){B.drawingstate.textsize=a.value.real};var Ia={clip:"none",pointColor:[1,0,0],lineColor:[0,0,1],pointSize:5,
lineSize:2,alpha:1,overhangLine:1.1,overhangSeg:1,dimDependent:1};a.defaultAppearance?Nb(a.defaultAppearance):"undefined"!==typeof window&&window.defaultAppearance&&Nb(window.defaultAppearance);var Sb={},ya,La,Ua,Ba,Ga,Za,Ja,cb,Ab=!1,Qb={toString:function(){return"RefineException"}},X=null;a.enableTraceLog&&(X={logLength:Infinity,fullLog:[],currentMouseAndScripts:null,currentMover:null,currentStep:null,currentElement:null,currentParam:null,labelTracing2:J.wrap("tracing2"),labelTracing4:J.wrap("tracing4"),
labelTracingSesq:J.wrap("tracingSesq"),postMouseHooks:[]},"number"===typeof a.enableTraceLog&&(X.logLength=a.enableTraceLog),Ma.getTraceLog=kc,Ma.formatTraceLog=lc,Ma.addTraceHook=X.postMouseHooks.push.bind(X.postMouseHooks));Na.stateSize=12;Db.stateSize=24;var F={_helper:{},Join:{}};F.Join.kind="L";F.Join.updatePosition=function(a){a.homog=n.cross(P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Line")};F.Segment={};F.Segment.kind=
"S";F.Segment.updatePosition=function(a){var b=P.csnames[a.args[0]],c=P.csnames[a.args[1]];a.homog=n.cross(b.homog,c.homog);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Line");a.startpos=b.homog;a.endpos=c.homog;a.farpoint=n.cross(a.homog,n.linfty)};F.Meet={};F.Meet.kind="P";F.Meet.updatePosition=function(a){a.homog=n.cross(P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Point")};F.Meet.visiblecheck=function(a){var b=
!0,c=P.csnames[a.args[0]],d=P.csnames[a.args[1]];"Segment"===c.type&&(b=Ob(a,c));b&&"Segment"===c.type&&(b=Ob(a,d));a.isshowing=b};F.Mid={};F.Mid.kind="P";F.Mid.updatePosition=function(a){var b=P.csnames[a.args[0]].homog,c=P.csnames[a.args[1]].homog,d=n.cross(b,c),e=n.cross(d,n.linfty),f=n.det3(b,e,d),d=n.det3(c,e,d),b=n.scalmult(d,b),c=n.scalmult(f,c);a.homog=n.add(b,c);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Point")};F.Perp={};F.Perp.kind="L";F.Perp.updatePosition=function(a){var b=
P.csnames[a.args[0]].homog,c=P.csnames[a.args[1]].homog,b=n.turnIntoCSList([b.value[0],b.value[1],p.zero]);a.homog=n.cross(b,c);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Line")};F.Para={};F.Para.kind="L";F.Para.updatePosition=function(a){var b=P.csnames[a.args[1]].homog;a.homog=n.cross(n.cross(n.linfty,P.csnames[a.args[0]].homog),b);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Line")};F.Horizontal={};F.Horizontal.kind="L";F.Horizontal.updatePosition=function(a){a.homog=
n.cross(n.ex,P.csnames[a.args[0]].homog);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Line")};F.Vertical={};F.Vertical.kind="L";F.Vertical.updatePosition=function(a){a.homog=n.cross(n.ey,P.csnames[a.args[0]].homog);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Line")};F.Through={};F.Through.kind="L";F.Through.isMovable=!0;F.Through.initialize=function(a){a=a.dir?J.wrap(a.dir):n.realVector([a.pos[1],-a.pos[0],0]);qa(a)};F.Through.getParamForInput=function(a,b,c){a="mouse"===
c?n.cross(P.csnames[a.args[0]].homog,b):"homog"===c?b:n.turnIntoCSList([p.zero,p.zero,p.zero]);a=n.cross(n.linfty,a);return n.normalizeMax(a)};F.Through.getParamFromState=function(a){return wa(3)};F.Through.putParamToState=function(a,b){qa(b)};F.Through.updatePosition=function(a){var b=wa(3);qa(b);b=n.cross(P.csnames[a.args[0]].homog,b);b=n.normalizeMax(b);a.homog=J.withUsage(b,"Line")};F.Through.stateSize=6;F.Free={};F.Free.kind="P";F.Free.isMovable=!0;F.Free.initialize=function(a){a=F._helper.initializePoint(a);
qa(a)};F.Free.getParamForInput=function(a,b,c){if("mouse"===c&&Vb&&0!==Sa){b=n.normalizeZ(b);a=b.value[0].value.real;c=b.value[1].value.real;var d=Math.round(a/Sa)*Sa,e=Math.round(c/Sa)*Sa;.2>Math.abs(d-a)&&.2>Math.abs(e-c)&&(b=n.realVector([d,e,1]))}return n.normalizeMax(b)};F.Free.getParamFromState=function(a){return wa(3)};F.Free.putParamToState=function(a,b){qa(b)};F.Free.updatePosition=function(a){var b=wa(3);qa(b);a.homog=J.withUsage(b,"Point")};F.Free.stateSize=6;F._helper.projectPointToLine=
function(a,b){var c=n.turnIntoCSList([b.value[0],b.value[1],p.zero]),c=n.cross(c,a);return n.normalizeMax(n.cross(c,b))};F.PointOnLine={};F.PointOnLine.kind="P";F.PointOnLine.isMovable=!0;F.PointOnLine.initialize=function(a){var b=F._helper.initializePoint(a);a=P.csnames[a.args[0]].homog;var b=F._helper.projectPointToLine(b,a),b=n.normalizeMax(b),c=n.cross(n.linfty,b);n.normalizeMax(c);qa(b);qa(a);Za=!1};F.PointOnLine.updatePosition=function(a,b){var c,d=P.csnames[a.args[0]].homog;c=wa(3);wa(3);if(!b){Ba=
a.stateIdx;var e=ya;ya=Ua;var f=wa(3),g=wa(3);ya=e;e=n.cross(g,d);n._helper.isAlmostZero(e)&&(e=n.cross(n.linfty,d));f=F._helper.CircleMP(e,f);f=F._helper.IntersectLC(d,f);e=F._helper.pointReflection(e,c);c=Tb(f[0],f[1],c,e)[0]}c=n.normalizeMax(c);qa(c);qa(d);a.homog=J.withUsage(c,"Point")};F.PointOnLine.getParamForInput=function(a,b,c){return b=F._helper.projectPointToLine(b,P.csnames[a.args[0]].homog)};F.PointOnLine.getParamFromState=function(a){return wa(3)};F.PointOnLine.putParamToState=function(a,
b){return qa(b)};F.PointOnLine.stateSize=12;F.PointOnCircle={};F.PointOnCircle.kind="P";F.PointOnCircle.isMovable=!0;F.PointOnCircle.initialize=function(a){var b=P.csnames[a.args[0]];a=n.normalizeZ(F._helper.initializePoint(a));var c=n.normalizeZ(F._helper.CenterOfConic(b.matrix)),d=n.sub(a,c),d=n.turnIntoCSList([d.value[1],p.neg(d.value[0]),p.zero]),c=n.cross(a,c),b=F._helper.IntersectLC(c,b.matrix),c=n.projectiveDistMinScal(a,b[0]);n.projectiveDistMinScal(a,b[1])<c?(a=b[1],b=b[0]):(a=b[0],b=b[1]);
qa(d);qa(a);qa(b);Za=!1};F.PointOnCircle.putParamToState=function(a,b){qa(b)};F.PointOnCircle.getParamFromState=function(a){return wa(3)};F.PointOnCircle.getParamForInput=function(a,b,c){c=n.normalizeZ(F._helper.CenterOfConic(P.csnames[a.args[0]].matrix));b=n.sub(b,c);Ba=a.stateIdx;a=wa(3);var d=n.normalizeZ(wa(3));c=n.sub(d,c);0>p.sub(p.mult(a.value[0],c.value[1]),p.mult(a.value[1],c.value[0])).value.real&&(b=n.neg(b));return n.turnIntoCSList([b.value[1],p.neg(b.value[0]),p.zero])};F.PointOnCircle.parameterPath=
function(a,b,c,d,e){d=n.normalizeAbs(d);e=n.normalizeAbs(e);var f=n.scalproduct(d,e);if(0<=f.value.real)return Rb(a,b,c,d,e);a=n.turnIntoCSList([p.sub(d.value[1],e.value[1]),p.sub(e.value[0],d.value[0]),p.zero]);f=n.scalproduct(d,a);0>f.value.real&&(a=n.neg(a));0>b?(b=2*b+1,c=b*b,f=.25/(1+c),c=p.complex(2*b*f+.25,(1-c)*f)):(b=2*b-1,c=b*b,f=.25/(1+c),c=p.complex(2*b*f+.75,(1-c)*f));var g=p.sub(p.real(1),c);b=p.mult(c,c);f=p.mult(g,g);c=p.mult(c,g);d=n.scalmult(f,d);d=n.add(d,n.scalmult(c,a));return d=
n.add(d,n.scalmult(b,e))};F.PointOnCircle.updatePosition=function(a){var b=wa(3);qa(b);var c=P.csnames[a.args[0]],b=n.productMV(c.matrix,b),c=F._helper.IntersectLC(b,c.matrix),c=Na(c[0],c[1]),c=n.normalizeMax(c.value[0]);a.homog=J.withUsage(c,"Point")};F.PointOnCircle.stateSize=6+Na.stateSize;F.PointOnSegment={};F.PointOnSegment.kind="P";F.PointOnSegment.isMovable=!0;F.PointOnSegment.initialize=function(a){var b=F._helper.initializePoint(a);a=F.PointOnSegment.getParamForInput(a,b);ab(a)};F.PointOnSegment.getParamForInput=
function(a,b){var c=P.csnames[a.args[0]],d=c.homog,d=n.turnIntoCSList([d.value[0],d.value[1],p.zero]),c=n.crossratio3(c.farpoint,c.startpos,c.endpos,b,d);0>c.value.real&&(c=p.complex(0,c.value.imag));1<c.value.real&&(c=p.complex(1,c.value.imag));return c};F.PointOnSegment.getParamFromState=function(a){return fb()};F.PointOnSegment.putParamToState=function(a,b){ab(b)};F.PointOnSegment.updatePosition=function(a){var b=fb();ab(b);var c=P.csnames[a.args[0]],d=n.scalmult(c.endpos.value[2],c.startpos),
c=n.scalmult(c.startpos.value[2],c.endpos),c=n.sub(c,d),b=n.add(d,n.scalmult(b,c)),b=n.normalizeMax(b);a.homog=J.withUsage(b,"Point")};F.PointOnSegment.stateSize=2;F._helper.CenterOfConic=function(a){var b=F._helper.IntersectLC(n.linfty,a),c=J.mult(a,b[0]);a=J.mult(a,b[1]);return n.cross(c,a)};F.CenterOfConic={};F.CenterOfConic.kind="P";F.CenterOfConic.updatePosition=function(a){var b=F._helper.CenterOfConic(P.csnames[a.args[0]].matrix);a.homog=b;a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,
"Point")};F._helper.CircleMP=function(a,b){var c=a.value[0],d=a.value[1],e=p.neg(a.value[2]),f=p.zero,c=n.turnIntoCSList([n.turnIntoCSList([e,f,c]),n.turnIntoCSList([f,e,d]),n.turnIntoCSList([c,d,f])]),e=J.mult(J.mult(b,c),b),d=J.mult(J.mult(b,n.fund),b),e=J.mult(e,n.fund),c=J.mult(d,c);return n.sub(e,c)};F.CircleMP={};F.CircleMP.kind="C";F.CircleMP.updatePosition=function(a){a.matrix=F._helper.CircleMP(P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog);a.matrix=n.normalizeMax(a.matrix);a.matrix=
J.withUsage(a.matrix,"Circle")};F.CircleMr={};F.CircleMr.kind="C";F.CircleMr.isMovable=!0;F.CircleMr.initialize=function(a){ab(p.real(a.radius))};F.CircleMr.getParamForInput=function(a,b){var c=P.csnames[a.args[0]].homog,c=n.normalizeZ(c);b=n.normalizeZ(b);c=n.sub(c,b);return c=n.abs(c)};F.CircleMr.getParamFromState=function(a){return fb()};F.CircleMr.putParamToState=function(a,b){ab(b)};F.CircleMr.updatePosition=function(a){var b=fb();ab(b);var c=P.csnames[a.args[0]].homog,c=n.normalizeZ(c),d=n.turnIntoCSList([b,
p.zero,p.zero]),d=n.add(d,c),c=F._helper.CircleMP(c,d),c=n.normalizeMax(c);a.matrix=J.withUsage(c,"Circle");a.radius=b};F.CircleMr.stateSize=2;F._helper.getConicType=function(a){if(1E-16>p.abs(n.det(a)).value.real)return"degenerate";var b=p.mult(a.value[0].value[0],a.value[1].value[1]),b=p.sub(b,p.pow(a.value[0].value[1],p.real(2))),b=b.value.real;return 1E-16>Math.abs(b)?"parabola":1E-16<b?"ellipsoid":"hyperbola"};F._helper.ConicBy5=function(a,b,c,d,e,f){a=n.turnIntoCSList([n.cross(c,d)]);var g=
n.turnIntoCSList([n.cross(b,e)]);b=n.turnIntoCSList([n.cross(b,c)]);d=n.turnIntoCSList([n.cross(d,e)]);J.mult(n.transpose(g),a);return F._helper.conicFromTwoDegenerates(a,g,b,d,f)};F._helper.conicFromTwoDegenerates=function(a,b,c,d,e){a=J.mult(n.transpose(b),a);c=J.mult(n.transpose(d),c);a=n.add(a,n.transpose(a));c=n.add(c,n.transpose(c));d=J.mult(J.mult(e,a),e);e=J.mult(J.mult(e,c),e);c=J.mult(d,c);e=J.mult(e,a);return n.sub(c,e)};F.ConicBy5={};F.ConicBy5.kind="C";F.ConicBy5.updatePosition=function(a){var b=
F._helper.ConicBy5(a,P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog,P.csnames[a.args[2]].homog,P.csnames[a.args[3]].homog,P.csnames[a.args[4]].homog);a.matrix=b;a.matrix=n.normalizeMax(a.matrix);a.matrix=J.withUsage(a.matrix,"Conic")};F._helper.buildConicMatrix=function(a){var b=a[1],c=a[2],d=a[3],e=a[4],f=a[5];return n.turnIntoCSList([n.turnIntoCSList([a[0],b,d]),n.turnIntoCSList([b,c,e]),n.turnIntoCSList([d,e,f])])};F._helper.splitDegenConic=function(a){var b=n.adjoint3(a),c=0,d,e,f=p.abs2(b.value[0].value[0]).value.real;
for(d=1;3>d;d++)e=p.abs2(b.value[d].value[d]).value.real,e>f&&(c=d,f=e);d=p.sqrt(p.mult(p.real(-1),b.value[c].value[c]));c=p.real(c+1);e=n.column(b,c);if(1E-16>p.abs2(d).value.real)return y;e=n.scaldiv(d,e);d=e.value[0];f=e.value[1];e=e.value[2];d=n.turnIntoCSList([n.turnIntoCSList([p.real(0),e,p.mult(p.real(-1),f)]),n.turnIntoCSList([p.mult(p.real(-1),e),p.real(0),d]),n.turnIntoCSList([f,p.mult(p.real(-1),d),p.real(0)])]);a=n.add(a,d);var g=0;for(d=f=b=0;3>d;d++)for(c=0;3>c;c++)e=p.abs2(a.value[d].value[c]).value.real,
e>f&&(g=d,b=c,f=e);d=a.value[g];a=n.transpose(a);a=a.value[b];d=n.normalizeMax(d);a=n.normalizeMax(a);d=J.withUsage(d,"Line");a=J.withUsage(a,"Line");return[d,a]};F.SelectConic={};F.SelectConic.kind="C";F.SelectConic.updatePosition=function(a){a.matrix=P.csnames[a.args[0]].results[a.index-1];a.matrix=n.normalizeMax(a.matrix);a.matrix=J.withUsage(a.matrix,"Conic")};F._helper.ConicBy4p1l=function(a,b,c,d,e,f){var g=n.cross(n.cross(b,d),f),k=n.cross(n.cross(c,e),f),l=n.cross(n.cross(b,c),f),m=n.cross(n.cross(d,
e),f),q=n.realVector(B.to(100*Math.random(),100*Math.random()));f=p.mult(n.det3(q,k,l),n.det3(q,k,m));f=p.sqrt(f);l=p.mult(n.det3(q,g,l),n.det3(q,g,m));l=p.sqrt(l);g=n.scalmult(f,g);l=n.scalmult(l,k);k=n.add(g,l);g=n.sub(g,l);k=F._helper.ConicBy5(a,b,c,d,e,k);a=F._helper.ConicBy5(a,b,c,d,e,g);return[k,a]};F.ConicBy4p1l={};F.ConicBy4p1l.kind="Cs";F.ConicBy4p1l.updatePosition=function(a){var b=F._helper.ConicBy4p1l(a,P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog,P.csnames[a.args[2]].homog,P.csnames[a.args[3]].homog,
P.csnames[a.args[4]].homog);a.results=b};F._helper.ConicBy3p2l=function(a,b,c,d,e){function f(a,b,c,d){return p.sub(p.mult(a,d),p.mult(b,c))}var g=n.cross(a,b),k=n.cross(d,e);d=n.cross(d,g);e=n.cross(e,g);g=n.turnIntoCSList([d,e,k]);c=n.productVM(c,n.adjoint3(g));k=n.adjoint3(n.turnIntoCSList([n.scalmult(c.value[0],d),n.scalmult(c.value[1],e),n.scalmult(c.value[2],k)]));c=n.transpose(k);d=p.mult;e=n.productMV(c,a);a=e.value[0];e=e.value[1];g=n.productMV(c,b);b=g.value[0];var g=g.value[1],l=p.sqrt(d(a,
e)),m=p.sqrt(d(b,g)),q,t=Array(4);for(q=0;4>q;++q){var u=(q&2)-1,v=d(p.real(((q&1)<<1)-1),l),w=d(p.real(u),m),x=f(e,v,g,w),y=f(b,w,a,v),u=f(a,e,b,g),z=p.add(p.add(f(b,g,a,e),f(g,w,e,v)),f(w,b,v,a)),v=d(x,x),w=d(y,y),A=d(z,z),B=d(x,y),x=d(x,z),y=d(y,z),B=p.sub(B,d(p.real(.5),d(u,u))),u=n.turnIntoCSList([n.turnIntoCSList([v,B,x]),n.turnIntoCSList([B,w,y]),n.turnIntoCSList([x,y,A])]),u=n.productMM(k,n.productMM(u,c)),u=n.turnIntoCSList([u.value[0].value[0],u.value[0].value[1],u.value[0].value[2],u.value[1].value[1],
u.value[1].value[2],u.value[2].value[2]]);t[q]=u}return t};F.ConicBy3p2l={};F.ConicBy3p2l.kind="Cs";F.ConicBy3p2l.updatePosition=function(a){for(var b=F._helper.ConicBy3p2l(P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog,P.csnames[a.args[2]].homog,P.csnames[a.args[3]].homog,P.csnames[a.args[4]].homog),b=Ub(b),c=Array(4),d=0;4>d;++d){var e=b[d].value;c[d]=n.turnIntoCSList([n.turnIntoCSList([e[0],e[1],e[2]]),n.turnIntoCSList([e[1],e[3],e[4]]),n.turnIntoCSList([e[2],e[4],e[5]])])}a.results=c};
F.ConicBy3p2l.stateSize=48;F.ConicBy2p3l={};F.ConicBy2p3l.kind="Cs";F.ConicBy2p3l.updatePosition=function(a){for(var b=F._helper.ConicBy3p2l(P.csnames[a.args[2]].homog,P.csnames[a.args[3]].homog,P.csnames[a.args[4]].homog,P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog),b=Ub(b),c=Array(4),d=0;4>d;++d){var e=b[d].value,e=n.turnIntoCSList([n.turnIntoCSList([e[0],e[1],e[2]]),n.turnIntoCSList([e[1],e[3],e[4]]),n.turnIntoCSList([e[2],e[4],e[5]])]);c[d]=n.normalizeMax(n.adjoint3(e))}a.results=c};
F.ConicBy2p3l.stateSize=48;F.ConicBy1p4l={};F.ConicBy1p4l.kind="Cs";F.ConicBy1p4l.updatePosition=function(a){var b=F._helper.ConicBy4p1l(a,P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog,P.csnames[a.args[2]].homog,P.csnames[a.args[3]].homog,P.csnames[a.args[4]].homog),c=b[0],b=b[1],c=n.adjoint3(c),b=n.adjoint3(b),b=[c,b];a.results=b};F.ConicBy2Foci1P={};F.ConicBy2Foci1P.kind="Cs";F.ConicBy2Foci1P.updatePosition=function(a){var b=P.csnames[a.args[0]].homog,c=P.csnames[a.args[1]].homog,d=P.csnames[a.args[2]].homog,
e=n.ii,f=n.jj,g=n.normalizeMax(n.cross(b,d)),k=n.normalizeMax(n.cross(c,d)),l=n.normalizeMax(n.cross(d,e)),d=n.normalizeMax(n.cross(d,f)),k=F._helper.coHarmonic(l,d,g,k),g=n.normalizeMax(k[0]),k=n.normalizeMax(k[1]),e=n.turnIntoCSList([e]),l=n.turnIntoCSList([f]),d=n.turnIntoCSList([b]),m=n.turnIntoCSList([c]),f=F._helper.conicFromTwoDegenerates(e,l,d,m,g),f=n.normalizeMax(f),e=F._helper.conicFromTwoDegenerates(e,l,d,m,k),e=n.normalizeMax(e),f=n.normalizeMax(n.adjoint3(f)),e=n.normalizeMax(n.adjoint3(e));
"ellipsoid"!==F._helper.getConicType(f)&&(g=f,f=e,e=g);n.almostequals(b,c).value&&(b=p.real(3),e=n.zeromatrix(b,b));a.results=[f,e]};F._helper.coHarmonic=function(a,b,c,d){var e=n.realVector([100*Math.random(),100*Math.random(),1]),f=n.det3(e,c,a),g=n.det3(e,c,b);c=n.det3(e,d,a);d=n.det3(e,d,b);d=p.sqrt(p.mult(d,g));f=p.sqrt(p.mult(c,f));a=J.mult(a,d);f=J.mult(b,f);b=n.add(a,f);a=n.sub(a,f);return[b,a]};F.ConicBy5lines={};F.ConicBy5lines.kind="C";F.ConicBy5lines.updatePosition=function(a){var b=F._helper.ConicBy5(a,
P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog,P.csnames[a.args[2]].homog,P.csnames[a.args[3]].homog,P.csnames[a.args[4]].homog),b=n.adjoint3(b);a.matrix=b;a.matrix=n.normalizeMax(a.matrix);a.matrix=J.withUsage(a.matrix,"Conic")};F.CircleBy3={};F.CircleBy3.kind="C";F.CircleBy3.updatePosition=function(a){var b=F._helper.ConicBy5(a,P.csnames[a.args[0]].homog,P.csnames[a.args[1]].homog,n.ii,n.jj,P.csnames[a.args[2]].homog);a.matrix=n.normalizeMax(b);a.matrix=J.withUsage(a.matrix,"Circle")};F.Polar=
{};F.Polar.kind="L";F.Polar.updatePosition=function(a){a.homog=J.mult(P.csnames[a.args[0]].matrix,P.csnames[a.args[1]].homog);a.homog=n.normalizeMax(a.homog);a.homog=J.withUsage(a.homog,"Line")};F.angleBisector={};F.angleBisector.kind="Ls";F.angleBisector.updatePosition=function(a){var b=P.csnames[a.args[0]],c=P.csnames[a.args[1]],d=n.normalizeMax(n.cross(b.homog,c.homog)),e=n.normalizeMax(n.cross(n.ii,d)),f=n.normalizeMax(n.cross(n.jj,d)),g=p.sqrt(p.mult(n.det3(d,c.homog,e),n.det3(d,b.homog,e))),
k=p.sqrt(p.mult(n.det3(d,c.homog,f),n.det3(d,b.homog,f))),e=J.mult(e,k),g=J.mult(f,g),f=n.add(e,g),g=n.sub(e,g),e=n.abs(f).value.real<p.eps,k=n.abs(g).value.real<p.eps;e||k?e?g=n.normalizeMax(g):k&&(f=n.normalizeMax(f)):(f=n.normalizeMax(f),g=n.normalizeMax(g));if(n.almostequals(f,n.linfty).value&&k||n.almostequals(g,n.linfty).value&&e)n.abs(f).value.real<n.abs(g).value.real?(e=n.det3(d,c.homog,g),d=n.det3(d,b.homog,g),b=J.mult(b.homog,e),c=J.mult(c.homog,d),f=n.add(b,c)):(e=n.det3(d,c.homog,f),d=
n.det3(d,b.homog,f),b=J.mult(b.homog,e),c=J.mult(c.homog,d),g=n.add(b,c));f=n.normalizeMax(f);g=n.normalizeMax(g);a.results=Na(f,g)};F.angleBisector.stateSize=Na.stateSize;F._helper.IntersectLC=function(a,b){var c=p,d=n.crossOperator(a),e=n.transpose(d),e=J.mult(e,J.mult(b,d)),f=n.maxIndex(a,p.abs2),g,k,l,m;0===f?(f=e.value[1].value[1],g=e.value[1].value[2],k=e.value[2].value[1],l=e.value[2].value[2],m=a.value[0]):1===f?(f=e.value[0].value[0],g=e.value[0].value[2],k=e.value[2].value[0],l=e.value[2].value[2],
m=a.value[1]):(f=e.value[0].value[0],g=e.value[0].value[1],k=e.value[1].value[0],l=e.value[1].value[1],m=a.value[2]);c=c.div(c.sqrt(c.sub(c.mult(g,k),c.mult(f,l))),m);c=n.add(e,n.scalmult(c,d));f=n.maxIndex(c,n.abs2);d=c.value[f];d=n.normalizeMax(d);d=J.withUsage(d,"Point");c=n.transpose(c);f=n.maxIndex(c,n.abs2);c=c.value[f];c=n.normalizeMax(c);c=J.withUsage(c,"Point");return[d,c]};F.IntersectLC={};F.IntersectLC.kind="Ps";F.IntersectLC.updatePosition=function(a){var b=F._helper.IntersectLC(P.csnames[a.args[0]].homog,
P.csnames[a.args[1]].matrix);a.results=Na(b[0],b[1])};F.IntersectLC.stateSize=Na.stateSize;F.IntersectCirCir={};F.IntersectCirCir.kind="Ps";F.IntersectCirCir.updatePosition=function(a){var b=P.csnames[a.args[0]].matrix,c=P.csnames[a.args[1]].matrix,d=n.scalmult(c.value[0].value[0],b.value[2]),c=n.scalmult(b.value[0].value[0],c.value[2]),d=n.sub(d,c),d=n.turnIntoCSList([d.value[0],d.value[1],p.realmult(.5,d.value[2])]),d=n.normalizeMax(d),b=F._helper.IntersectLC(d,b);a.results=Na(b[0],b[1])};F.IntersectCirCir.stateSize=
Na.stateSize;F._helper.IntersectConicConic=function(a,b){var c=a.value[0],d=a.value[1],e=a.value[2],f=b.value[0],g=b.value[1],k=b.value[2],l=n.det3(c,d,e),m=p.add(p.add(n.det3(c,d,k),n.det3(c,g,e)),n.det3(f,d,e)),c=p.add(p.add(n.det3(c,g,k),n.det3(f,d,k)),n.det3(f,g,e)),f=n.det3(f,g,k),k=p.abs2(l).value.real,g=p.abs2(f).value.real;k<g&&(k=a,a=b,b=k,k=f,f=l,l=k,k=c,c=m,m=k,k=g);1E-24>k?(l=a,c=b):(m=p.solveCubic(l,m,c,f),c=p.abs2(p.sub(m[0],m[1])).value.real,f=p.abs2(p.sub(m[0],m[2])).value.real,g=
p.abs2(p.sub(m[1],m[2])).value.real,c>f?(l=m[1],m=c>g?m[0]:m[2]):(l=m[2],m=f>g?m[0]:m[1]),l=n.add(n.scalmult(l,a),b),c=n.add(n.scalmult(m,a),b));m=F._helper.splitDegenConic(l);l=m[0];m=m[1];c=F._helper.splitDegenConic(c);g=c[0];f=c[1];c=n.cross(l,g);g=n.cross(m,g);l=n.cross(l,f);m=n.cross(m,f);c=n.normalizeMax(c);g=n.normalizeMax(g);l=n.normalizeMax(l);m=n.normalizeMax(m);c=J.withUsage(c,"Point");g=J.withUsage(g,"Point");l=J.withUsage(l,"Point");m=J.withUsage(m,"Point");return[c,g,l,m]};F.IntersectConicConic=
{};F.IntersectConicConic.kind="Ps";F.IntersectConicConic.updatePosition=function(a){var b=F._helper.IntersectConicConic(P.csnames[a.args[0]].matrix,P.csnames[a.args[1]].matrix),b=Db(b[0],b[1],b[2],b[3]);a.results=b};F.IntersectConicConic.stateSize=Db.stateSize;F.SelectP={};F.SelectP.kind="P";F.SelectP.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=P.csnames[a.args[0]].results.value;a=F._helper.initializePoint(a);for(var c=n.projectiveDistMinScal(a,b[0]),d=0,e=1;e<b.length;++e){var f=
n.projectiveDistMinScal(a,b[e]);f<c&&(c=f,d=e)}return d};F.SelectP.updatePosition=function(a){a.homog=P.csnames[a.args[0]].results.value[a.param]};F.SelectL={};F.SelectL.kind="L";F.SelectL.updatePosition=function(a){a.homog=P.csnames[a.args[0]].results.value[a.index-1];a.homog=J.withUsage(a.homog,"Line")};F.TrProjection={};F.TrProjection.kind="Tr";F.TrProjection.updatePosition=function(a){function b(c){var d=P.csnames[a.args[0+c]].homog,e=P.csnames[a.args[2+c]].homog,f=P.csnames[a.args[4+c]].homog,
g=P.csnames[a.args[6+c]].homog;c=n.adjoint3(n.turnIntoCSList([d,e,f]));c=n.productVM(g,c).value;return c=n.transpose(n.turnIntoCSList([n.scalmult(c[0],d),n.scalmult(c[1],e),n.scalmult(c[2],f)]))}var c=n.productMM(b(1),n.adjoint3(b(0))),c=n.normalizeMax(c);a.matrix=c};F.TransformP={};F.TransformP.kind="P";F.TransformP.updatePosition=function(a){a.homog=n.normalizeMax(n.productMV(P.csnames[a.args[0]].matrix,P.csnames[a.args[1]].homog));a.homog=J.withUsage(a.homog,"Point")};F._helper.pointReflection=
function(a,b){var c=F._helper.CircleMP(a,b);return F._helper.conicOtherIntersection(c,b,a)};F._helper.conicOtherIntersection=function(a,b,c){var d=n.productMV(a,c);a=n.scalproduct(c,d);d=n.scalproduct(b,d);d=p.realmult(-2,d);b=n.scalmult(a,b);c=n.scalmult(d,c);c=n.add(b,c);return c=n.normalizeMax(c)};F._helper.initializePoint=function(a){var b=a.sx||0,c=a.sy||0,d=a.sz||1;a.pos&&(2===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=1),3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2]));a=n.realVector([b,c,
d]);return a=n.normalizeMax(a)};var ic={CircleMFixedr:function(a){a.pinned=!0;a.type="CircleMr";return[a]},CircleByRadius:function(a){a.type="CircleMr";return[a]},IntersectionConicLine:function(a){a.args=[a.args[1],a.args[0]];a.type="IntersectLC";return[a]},IntersectionCircleCircle:function(a){a.type="IntersectCirCir";return[a]},Calculation:function(a){console.log("Calculation stripped from construction");return[]}},Da={},Yb,hb,Zb,$b;Yb=[[],[.2],[.075,.225],[44/45,-56/15,32/9],[19372/6561,-25360/
2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];hb=[0,.2,.3,.8,8/9,1,1];Zb=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];$b=[5179/57600,0,7571/16695,.6140625,-92097/339200,187/2100,.025];var Ea,ra=[],sb=!1;Da.tick=function(){for(var a=0;a<ba.env.accuracy;a++)Da.tick1(ba.env.deltat/ba.env.accuracy),I(Ca.simulationstep)};Da.tick1=function(a){for(var b=a,c=0;0<a&&c<.999*a||0>a&&c>.999*a;)b=Da.oneRKStep(b),c+=b,b=Math.min(2*b,
a-c),b=Math.max(b,1E-16),Da.restorePosition(),Da.doCollisions(),Da.calculateForces(),Da.moveToFinalPos();return!0};Da.restorePosition=function(){Ea.forEach(function(a){a=a.behavior;ba[a.type].restorePos(a,9)})};Da.doCollisions=function(){Ea.forEach(function(a){a=a.behavior;ba[a.type].doCollisions(a)})};Da.calculateForces=function(){Ea.forEach(function(a){a=a.behavior;ba[a.type].calculateForces(a)})};Da.moveToFinalPos=function(){Ea.forEach(function(a){a=a.behavior;ba[a.type].move(a)})};Da.oneRKStep=
function(a){for(var b=function(a){Ea.forEach(function(b){b=b.behavior;ba[b.type].initRK(b,a);ba[b.type].storePosition(b)})},c=function(a){Ea.forEach(function(b){b=b.behavior;ba[b.type].setToTimestep(b,hb[a])})},d=function(a){Ea.forEach(function(b){b=b.behavior;ba[b.type].proceedMotion(b,hb[a],a,Yb[a])})},e=function(){Ea.forEach(function(a){a=a.behavior;ba[a.type].resetForces(a)})},f=function(a){Ea.forEach(function(b){b=b.behavior;ba[b.type].calculateDelta(b,a)})},g=function(b){var c=0;Ea.forEach(function(a){a=
a.behavior;ba[a.type].proceedMotion(a,hb[6],7,Zb);ba[a.type].savePos(a,8);ba[a.type].proceedMotion(a,hb[6],7,$b);ba[a.type].savePos(a,9);c+=ba[a.type].sqDist(a,8,9)});return c=Math.sqrt(c)/a},k=function(a){Ea.forEach(function(a){a=a.behavior;ba[a.type].recallPosition(a)})},l=!1;!l;){b(a);for(var n=0;7>n;n++)c(n),d(n),e(),Da.calculateForces(),f(n);g(a)>ba.env.errorbound&&a>ba.env.lowestdeltat?(a/=ba.env.slowdownfactor,k()):l=!0}return a};var ba={Mass:{init:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,
0];a.el=b;"undefined"===typeof a.mass&&(a.mass=1);"undefined"===typeof a.charge&&(a.charge=0);"undefined"===typeof a.friction&&(a.friction=0);a.lnfrict=0;"undefined"===typeof a.limitspeed&&(a.limitspeed=!1);"undefined"===typeof a.fixed&&(a.fixed=!1);"undefined"===typeof a.radius&&(a.radius=1);a.internalmove=!1;a.fx=0;a.fy=0;a.fz=0;a.vx=a.vx||0;a.vy=a.vy||0;a.vz=a.vz||0;a.mtype=0;a.env=ba.env;a.deltat=0;a.mx=0;a.my=0;a.mz=0;a.mvx=0;a.mvy=0;a.mvz=0;a.dx=[0,0,0,0,0,0,0,0,0,0];a.dy=[0,0,0,0,0,0,0,0,0,
0];a.dz=[0,0,0,0,0,0,0,0,0,0];a.dvx=[0,0,0,0,0,0,0,0,0,0];a.dvy=[0,0,0,0,0,0,0,0,0,0];a.dvz=[0,0,0,0,0,0,0,0,0,0];a.midx=0;a.midy=0;a.midz=0;a.lx=0;a.ly=0;a.lz=0},resetForces:function(a){a.fx=0;a.fy=0;a.fz=0},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){var c=R.extractPoint(a.el.homog);a.x=c.x;a.y=c.y;a.z=0;a.xo=a.x;a.yo=a.y;a.zo=a.z;a.vxo=a.vx;a.vyo=a.vy;a.vzo=a.vz;a.deltat=b;a.fx=0;a.fy=0;a.fz=0},setVelocity:function(a,b,c,d){d||(d=0);a.vx=b;a.vy=c;a.vz=d},move:function(a){a.pos=
[a.x,a.y,1];a.internalmove=!0;xa&&oa.down&&a.el===xa.mover||(a.el.homog=n.realVector(a.pos));a.el.sx=a.x;a.el.sy=a.y;a.internalmove=!1},proceedMotion:function(a,b,c,d){if(!a.fixed)for(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz,b=0;b<c;b++)a.x+=d[b]*a.dx[b]*a.deltat,a.y+=d[b]*a.dy[b]*a.deltat,a.z+=d[b]*a.dz[b]*a.deltat,a.vx+=d[b]*a.dvx[b]*a.deltat,a.vy+=d[b]*a.dvy[b]*a.deltat,a.vz+=d[b]*a.dvz[b]*a.deltat},calculateForces:function(a){var b=Math.sqrt(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz);a.lnfrict=
-Math.log((1-a.friction)*(1-a.env.friction)*(.1<b&&a.limitSpeed?.1/b:1));a.fx+=-a.vx*a.lnfrict*a.mass;a.fy+=-a.vy*a.lnfrict*a.mass;a.fz+=-a.vz*a.lnfrict*a.mass},calculateDelta:function(a,b){a.dx[b]=a.vx;a.dy[b]=a.vy;a.dz[b]=a.vz;a.dvx[b]=a.fx/a.mass;a.dvy[b]=a.fy/a.mass;a.dvz[b]=a.fz/a.mass},savePos:function(a,b){a.dx[b]=a.x;a.dy[b]=a.y;a.dz[b]=a.z;a.dvx[b]=a.vx;a.dvy[b]=a.vy;a.dvz[b]=a.vz},restorePos:function(a,b){a.fixed||(a.x=a.dx[b],a.y=a.dy[b],a.z=a.dz[b],a.vx=a.dvx[b],a.vy=a.dvy[b],a.vz=a.dvz[b])},
sqDist:function(a,b,c){var d=(a.dx[b]-a.dx[c])*(a.dx[b]-a.dx[c]),d=d+(a.dy[b]-a.dy[c])*(a.dy[b]-a.dy[c]),d=d+(a.dz[b]-a.dz[c])*(a.dz[b]-a.dz[c]),d=d+(a.dvx[b]-a.dvx[c])*(a.dvx[b]-a.dvx[c]),d=d+(a.dvy[b]-a.dvy[c])*(a.dvy[b]-a.dvy[c]);return d+=(a.dvz[b]-a.dvz[c])*(a.dvz[b]-a.dvz[c])},kineticEnergy:function(a){return.5*a.mass*(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz)},storePosition:function(a){a.mx=a.x;a.my=a.y;a.mz=a.z;a.mvx=a.vx;a.mvy=a.vy;a.mvz=a.vz},recallPosition:function(a){a.fixed||(a.x=a.mx,a.y=a.my,
a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz)},doCollisions:function(a){}},Sun:{init:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=10);"undefined"===typeof a.friction&&(a.friction=0);a.charge=0;a.x=0;a.y=0;a.z=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){var c=R.extractPoint(a.el.homog);a.x=c.x;a.y=c.y;a.z=0},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,
b){},calculateForces:function(a){for(var b=a.x,c=a.y,d=a.z,e=0;e<ra.length;e++){var f=ra[e],g=f.behavior.x,k=f.behavior.y,l=f.behavior.z,n=Math.sqrt((b-g)*(b-g)+(c-k)*(c-k)+(d-l)*(d-l)),k=(c-k)*a.mass*f.behavior.mass/(n*n*n),l=(d-l)*a.mass*f.behavior.mass/(n*n*n);f.behavior.fx+=(b-g)*a.mass*f.behavior.mass/(n*n*n)*f.behavior.mass;f.behavior.fy+=k*f.behavior.mass;f.behavior.fz+=l*f.behavior.mass}},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},
storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Gravity:{init:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.strength&&(a.strength=1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=P.csnames[a.namea];a.mb=P.csnames[a.nameb]},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){var b=
R.extractPoint(a.ma.homog),c=R.extractPoint(a.mb.homog),d=(c.x-b.x)*a.strength;a=(c.y-b.y)*a.strength;for(b=0;b<ra.length;b++)c=ra[b],c.behavior.fx+=d*c.behavior.mass,c.behavior.fy+=a*c.behavior.mass,c.behavior.fz+=0*c.behavior.mass},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Spring:{init:function(a,b){a.el=b;"undefined"===typeof a.strength&&(a.strength=
1);"undefined"===typeof a.amplitude&&(a.amplitude=0);"undefined"===typeof a.phase&&(a.phase=0);"undefined"===typeof a.speed&&(a.speed=1);"undefined"===typeof a.l0&&(a.l0=0);"undefined"===typeof a.stype&&(a.stype=1);"undefined"===typeof a.readOnInit&&(a.readOnInit=!1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=P.csnames[a.namea];a.mb=P.csnames[a.nameb];var c=R.extractPoint(a.ma.homog),d=R.extractPoint(a.mb.homog);a.l0=Math.sqrt((c.x-d.x)*(c.x-d.x)+(c.y-d.y)*(c.y-d.y));a.env=ba.env},resetForces:function(a){},
getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){var b,c,d,e;!a.ma.behavior||xa&&oa.down&&a.ma===xa.mover?(c=R.extractPoint(a.ma.homog),b=c.x,d=c.y):(b=a.ma.behavior.x,d=a.ma.behavior.y);!a.mb.behavior||xa&&oa.down&&a.mb===xa.mover?(e=R.extractPoint(a.mb.homog),c=e.x,e=e.y):(c=a.mb.behavior.x,e=a.mb.behavior.y);var f=Math.sqrt((b-c)*(b-c)+(d-e)*(d-e)),g=a.l0,k=a.stype;
1===k&&(g=0);var l=0;if(2===k||3===k)l=a.ma.behavior.mass*a.mb.behavior.mass*a.strength;2===k&&(l=-l);var n,m;if(0===f||0!==k&&1!==k)if(a.ma.behavior&&a.mb.behavior&&0!==f){if(f*=f*f,2===k||3===k)n=(b-c)*l/f,m=(d-e)*l/f}else n=m=0;else n=-(b-c)*a.strength*(f-g)/f*a.env.springstrength,m=-(d-e)*a.strength*(f-g)/f*a.env.springstrength;a.ma.behavior&&(a.ma.behavior.fx+=n,a.ma.behavior.fy+=m);a.mb.behavior&&(a.mb.behavior.fx-=n,a.mb.behavior.fy-=m)},calculateDelta:function(a,b){},savePos:function(a,b){},
restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},det:function(a,b,c,d,e,f){return c*f-e*d+e*b-a*f+a*d-c*b},Bouncer:{init:function(a,b){a.el=b;"undefined"===typeof a.xdamp&&(a.xdamp=0);"undefined"===typeof a.ydamp&&(a.ydamp=0);"undefined"===typeof a.motorchanger&&(a.motorchanger=!0);a.namea=b.args[0];a.nameb=b.args[1];a.ma=P.csnames[a.namea];a.mb=P.csnames[a.nameb];var c=R.extractPoint(a.ma.homog),
d=R.extractPoint(a.mb.homog);a.x1o=1.01*c.x-.01*d.x;a.y1o=1.01*c.y-.01*d.y;a.x2o=1.01*d.x-.01*c.x;a.y2o=1.01*d.y-.01*c.y;a.env=ba.env},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){a.deltat=b},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},
recallPosition:function(a){},doCollisions:function(a){for(var b=R.extractPoint(a.ma.homog),c=R.extractPoint(a.mb.homog),d=b.x,b=b.y,e=c.x,c=c.y,f=a.x1o,g=a.y1o,k=a.x2o,l=a.y2o,n=Math.sqrt((d-e)*(d-e)+(b-c)*(b-c)),m=(d-e)/n,n=(b-c)/n,q=0;q<ra.length;q++){var t=ra[q],u=t.behavior.xo,v=t.behavior.yo,w=t.behavior.x,x=t.behavior.y,y=p.mult(p.complex(f,g),p.complex(e,c)),z=p.mult(p.complex(k,l),p.complex(d,b)),y=p.sub(y,z),z=p.mult(p.complex(u,v),p.complex(d,b)),y=p.add(y,z),z=p.mult(p.complex(u,v),p.complex(e,
c)),y=p.sub(y,z),z=p.sub(p.complex(f,g),p.complex(k,l)),y=p.div(y,z);0>ba.det(d,b,e,c,w,x)*ba.det(d,b,e,c,y.value.real,y.value.imag)&&0>ba.det(d,b,w,x,y.value.real,y.value.imag)*ba.det(e,c,w,x,y.value.real,y.value.imag)&&(v=t.behavior.mvx+a.deltat*(-y.value.real+t.behavior.xo),w=t.behavior.mvy+a.deltat*(-y.value.imag+t.behavior.yo),u=m*v+n*w,v=n*v-m*w,t.behavior.x=y.value.real,t.behavior.y=y.value.imag,t.behavior.vx=m*u*(1-a.xdamp),t.behavior.vy=n*u*(1-a.xdamp),t.behavior.vx+=-n*v*(1-a.ydamp),t.behavior.vy+=
m*v*(1-a.ydamp))}a.x1o=d;a.y1o=b;a.x2o=e;a.y2o=c}},Environment:{init:function(a){"undefined"===typeof a.gravity&&(a.gravity=0);"undefined"===typeof a.friction&&(a.friction=0);"undefined"===typeof a.springstrength&&(a.springstrength=1);"undefined"===typeof a.accuracy&&(a.accuracy=10);"undefined"===typeof a.deltat&&(a.deltat=.3);"undefined"===typeof a.charges&&(a.charges=!1);"undefined"===typeof a.balls&&(a.balls=!1);"undefined"===typeof a.newton&&(a.newton=!1);"undefined"===typeof a.ballInteractionBoosting&&
(a.ballInteractionBoosting=1);ba.env=a;a.errorbound=.001;a.lowestdeltat=1E-7;a.slowdownfactor=2},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){var b,c,d,e,f,g,k,l,n,m;if(a.newton)for(b=0;b<ra.length-1;b++)for(c=ra[b],d=c.behavior.x,e=c.behavior.y,f=b+1;f<ra.length;f++)g=ra[f],k=g.behavior.x,l=g.behavior.y,m=Math.sqrt((d-k)*(d-k)+(e-l)*(e-l)),
k=(d-k)*c.behavior.mass*g.behavior.mass/(m*m*m),l=(e-l)*c.behavior.mass*g.behavior.mass/(m*m*m),c.behavior.fx-=k,c.behavior.fy-=l,g.behavior.fx+=k,g.behavior.fy+=l;if(a.charges)for(b=0;b<ra.length-1;b++)for(c=ra[b],d=c.behavior.x,e=c.behavior.y,f=b+1;f<ra.length;f++)g=ra[f],k=g.behavior.x,l=g.behavior.y,m=Math.sqrt((d-k)*(d-k)+(e-l)*(e-l)),k=(d-k)*c.behavior.charge*g.behavior.charge/(m*m*m),l=(e-l)*c.behavior.charge*g.behavior.charge/(m*m*m),c.behavior.fx+=k,c.behavior.fy+=l,g.behavior.fx-=k,g.behavior.fy-=
l;if(a.balls)for(b=0;b<ra.length-1;b++)if(c=ra[b],0!==c.behavior.radius)for(d=c.behavior.x,e=c.behavior.y,f=b+1;f<ra.length;f++)g=ra[f],0!==g.behavior.radius&&(k=g.behavior.x,l=g.behavior.y,n=c.behavior.radius+g.behavior.radius,m=Math.sqrt((d-k)*(d-k)+(e-l)*(e-l)),0===a.ballInteractionBoosting?(k=(d-k)/(m*m*m)*(m>n?0:(m-n)*(m-n)),l=(e-l)/(m*m*m)*(m>n?0:(m-n)*(m-n))):1===a.ballInteractionBoosting?(k=(d-k)/(m*m*m*m)*(m>n?0:(m-n)*(m-n)),l=(e-l)/(m*m*m*m)*(m>n?0:(m-n)*(m-n))):(k=(d-k)/(m*m*m*m*m)*(m>
n?0:(m-n)*(m-n)),l=(e-l)/(m*m*m*m*m)*(m>n?0:(m-n)*(m-n))),c.behavior.fx+=k,c.behavior.fy+=l,g.behavior.fx-=k,g.behavior.fy-=l);for(b=0;b<ra.length;b++)c=ra[b],c.behavior.fx+=0,c.behavior.fy+=a.gravity,c.behavior.fz+=0},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}}};return Ma};return b}(),defaultAppearance={clip:"none",
pointColor:[1,0,0],lineColor:[0,0,1],pointSize:5,lineSize:2,alpha:1,overhangLine:1.1,overhangSeg:1,dimDependent:1};"undefined"!==typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports=createCindy);
//# sourceMappingURL=Cindy.js.map

